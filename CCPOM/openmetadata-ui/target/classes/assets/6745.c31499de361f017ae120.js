"use strict";(self.webpackChunkopen_metadata=self.webpackChunkopen_metadata||[]).push([[6745],{40103:function(e,t,n){var r=n(8081),i=n.n(r),a=n(23645),l=n.n(a)()(i());l.push([e.id,'/*\n *  Copyright 2022 Collate.\n *  Licensed under the Apache License, Version 2.0 (the "License");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *  http://www.apache.org/licenses/LICENSE-2.0\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an "AS IS" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n.roles-detail .list-table .ant-table-row .ant-table-cell:first-child,\n.roles-detail .list-table .ant-table-thead .ant-table-cell:first-child {\n  padding-left: 16px;\n}\n.roles-detail .ant-space > .ant-space-item:first-child {\n  align-self: flex-end;\n}\n.link-hover:hover {\n  text-decoration: underline;\n  cursor: pointer;\n}\n',""]),t.Z=l},66745:function(e,t,n){n.r(t),n.d(t,{default:function(){return z}});var r=n(70655),i=n(25499),a=n(71577),l=n(56256),s=n(19650),c=n(50146),o=n(34901),u=n(96486),d=n(67294),m=n(68432),p=n(15137),f=n(69523),v=n(43633),h=n(83716),y=n(26387),b=n(96162),E=n(61105),C=n(64632),Z=n(80897),k=n(11484),w=n(23313),g=n(24671),N=n(96840),S=n(46321),x=n(88121),L=n(94199),A=n(25213),R=n(76),I=n(24135),O=n(62761),T=n(38212),D=function(e){var t=e.list,n=e.type,r=e.onDelete,i=e.hasAccess,l=(0,m.$)().t,s=(0,d.useMemo)((function(){return[{title:l("label.name"),dataIndex:"name",width:"200px",key:"name",render:function(e,t){var r="";switch(n){case"policy":r=(0,N.Hr)(t.fullyQualifiedName||"");break;case"team":r=(0,N.KH)(t.fullyQualifiedName||"");break;case"user":r=(0,O.ZG)(t.fullyQualifiedName||"")}return d.createElement(R.Link,{className:"link-hover","data-testid":"entity-name",to:r},(0,g.C_)(t))}},{title:l("label.description"),dataIndex:"description",key:"description",render:function(e,t){return d.createElement(I.Z,{markdown:(null==t?void 0:t.description)||""})}},{title:l("label.action-plural"),dataIndex:"actions",width:"80px",key:"actions",render:function(e,t){return d.createElement(L.Z,{title:l(i?"label.remove":"message.no-permission-for-action")},d.createElement(a.Z,{"data-testid":"remove-action-"+(0,g.C_)(t),disabled:!i,type:"text",onClick:function(){return r(t)}},d.createElement(T.ZP,{alt:"remove",icon:T.PJ.ICON_REMOVE,title:l("label.remove")})))}}]}),[]);return d.createElement(A.Z,{bordered:!0,className:"list-table",columns:s,dataSource:t,pagination:!1,rowKey:"id",size:"small"})},_=n(93379),q=n.n(_),G=n(7795),J=n.n(G),U=n(90569),M=n.n(U),Q=n(3565),K=n.n(Q),P=n(19216),F=n.n(P),H=n(44589),W=n.n(H),Y=n(40103),V={};V.styleTagTransform=W(),V.setAttributes=K(),V.insert=M().bind(null,"head"),V.domAPI=J(),V.insertStyleElement=F(),q()(Y.Z,V),Y.Z&&Y.Z.locals&&Y.Z.locals;var $=i.Z.TabPane,z=function(){var e,t,n,L=(0,p.k6)(),A=(0,m.$)().t,R=(0,p.UO)().fqn,I=(0,r.CR)((0,d.useState)({}),2),O=I[0],T=I[1],_=(0,r.CR)((0,d.useState)(!1),2),q=_[0],G=_[1],J=(0,r.CR)((0,d.useState)(!1),2),U=J[0],M=J[1],Q=(0,r.CR)((0,d.useState)(!1),2),K=Q[0],P=Q[1],F=(0,r.CR)((0,d.useState)(),2),H=F[0],W=F[1],Y=(0,r.CR)((0,d.useState)(),2),V=Y[0],z=Y[1],B=(0,N.si)(b.CZ.ACCESS,b.lx.ROLES),X=(0,d.useMemo)((function(){return(0,g.C_)(O)}),[O]),j=(0,d.useMemo)((function(){return[{name:A("label.role-plural"),url:B},{name:X,url:""}]}),[B,X]);return(0,d.useEffect)((function(){(0,r.mG)(void 0,void 0,void 0,(function(){var e,t;return(0,r.Jh)(this,(function(n){switch(n.label){case 0:G(!0),n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,(0,Z.n5)(R,"policies,teams,users")];case 2:return e=n.sent(),T(null!=e?e:{}),[3,5];case 3:return t=n.sent(),(0,S.Eo)(t),[3,5];case 4:return G(!1),[7];case 5:return[2]}}))}))}),[R]),q?d.createElement(f.Z,null):d.createElement("div",{"data-testid":"role-details-container"},d.createElement(y.Z,{titleLinks:j}),d.createElement(d.Fragment,null,(0,u.isEmpty)(O)?d.createElement(h.Z,{type:E.Wx.CUSTOM},d.createElement("div",{className:"text-center"},d.createElement("p",null,A("message.no-entity-found-for-name",{entity:A("label.role"),name:R})),d.createElement(a.Z,{ghost:!0,className:"m-t-sm",type:"primary",onClick:function(){return L.push(B)}},A("label.go-back")))):d.createElement("div",{className:"roles-detail","data-testid":"role-details"},d.createElement(l.Z.Title,{className:"m-b-0 m-t-xs","data-testid":"heading",level:5},X),d.createElement(v.Z,{hasEditAccess:!0,className:"m-b-md",description:O.description||"",entityFqn:O.fullyQualifiedName,entityName:X,entityType:C.py.ROLE,isEdit:K,onCancel:function(){return P(!1)},onDescriptionEdit:function(){return P(!0)},onDescriptionUpdate:function(e){return(0,r.mG)(void 0,void 0,void 0,(function(){var t,n,i;return(0,r.Jh)(this,(function(a){switch(a.label){case 0:t=(0,o.qu)(O,(0,r.pi)((0,r.pi)({},O),{description:e})),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,(0,Z.sZ)(t,O.id)];case 2:return n=a.sent(),T((0,r.pi)((0,r.pi)({},O),{description:n.description})),[3,5];case 3:return i=a.sent(),(0,S.Eo)(i),[3,5];case 4:return P(!1),[7];case 5:return[2]}}))}))}}),d.createElement(i.Z,{"data-testid":"tabs",defaultActiveKey:"policies"},d.createElement($,{key:"policies",tab:A("label.policy-plural")},d.createElement(s.Z,{className:"w-full",direction:"vertical"},d.createElement(a.Z,{"data-testid":"add-policy",type:"primary",onClick:function(){return z({type:C.py.POLICY,selectedData:O.policies||[]})}},A("label.add-entity",{entity:A("label.policy-v")})),d.createElement(D,{hasAccess:!0,list:null!==(e=O.policies)&&void 0!==e?e:[],type:"policy",onDelete:function(e){return W({record:e,attribute:"policies"})}}))),d.createElement($,{key:"teams",tab:A("label.team-plural")},d.createElement(D,{hasAccess:!0,list:null!==(t=O.teams)&&void 0!==t?t:[],type:"team",onDelete:function(e){return W({record:e,attribute:"teams"})}})),d.createElement($,{key:"users",tab:A("label.user-plural")},d.createElement(D,{hasAccess:!0,list:null!==(n=O.users)&&void 0!==n?n:[],type:"user",onDelete:function(e){return W({record:e,attribute:"users"})}}))))),H&&d.createElement(c.Z,{centered:!0,closable:!1,confirmLoading:U,maskClosable:!1,okText:A("label.confirm"),open:!(0,u.isUndefined)(H.record),title:A("label.remove-entity",{entity:(0,g.C_)(H.record)})+" "+A("label.from-lowercase")+" "+X,onCancel:function(){return W(void 0)},onOk:function(){return(0,r.mG)(void 0,void 0,void 0,(function(){return(0,r.Jh)(this,(function(e){switch(e.label){case 0:return[4,(t=H.record,n=H.attribute,(0,r.mG)(void 0,void 0,void 0,(function(){var e,i,a,l,s,c,u;return(0,r.Jh)(this,(function(d){switch(d.label){case 0:return M(!0),"teams"!==n?[3,1]:(function(e){(0,r.mG)(void 0,void 0,void 0,(function(){var t,n,i,a,l,s,c;return(0,r.Jh)(this,(function(u){switch(u.label){case 0:return u.trys.push([0,3,4,5]),[4,(0,k.Xv)(e.fullyQualifiedName||"","defaultRoles")];case 1:return t=u.sent(),n=(null!==(s=t.defaultRoles)&&void 0!==s?s:[]).filter((function(e){return e.id!==O.id})),i=(0,o.qu)(t,(0,r.pi)((0,r.pi)({},t),{defaultRoles:n})),[4,(0,k.Cp)(t.id,i)];case 2:return u.sent()&&(a=(null!==(c=O.teams)&&void 0!==c?c:[]).filter((function(t){return t.id!==e.id})),T((function(e){return(0,r.pi)((0,r.pi)({},e),{teams:a})}))),[3,5];case 3:return l=u.sent(),(0,S.Eo)(l),[3,5];case 4:return M(!1),[7];case 5:return[2]}}))}))}(t),[3,7]);case 1:return"users"!==n?[3,2]:(function(e){(0,r.mG)(void 0,void 0,void 0,(function(){var t,n,i,a,l,s,c;return(0,r.Jh)(this,(function(u){switch(u.label){case 0:return u.trys.push([0,3,4,5]),[4,(0,w.gs)(e.fullyQualifiedName||"","roles")];case 1:return t=u.sent(),n=(null!==(s=t.roles)&&void 0!==s?s:[]).filter((function(e){return e.id!==O.id})),i=(0,o.qu)(t,(0,r.pi)((0,r.pi)({},t),{roles:n})),[4,(0,w.f_)(t.id,i)];case 2:return u.sent()&&(a=(null!==(c=O.users)&&void 0!==c?c:[]).filter((function(t){return t.id!==e.id})),T((function(e){return(0,r.pi)((0,r.pi)({},e),{users:a})}))),[3,5];case 3:return l=u.sent(),(0,S.Eo)(l),[3,5];case 4:return M(!1),[7];case 5:return[2]}}))}))}(t),[3,7]);case 2:e=null!==(u=O[n])&&void 0!==u?u:[],i=e.filter((function(e){return e.id!==t.id})),a=(0,o.qu)(O,(0,r.pi)((0,r.pi)({},O),((c={})[n]=i,c))),d.label=3;case 3:return d.trys.push([3,5,6,7]),[4,(0,Z.sZ)(a,O.id)];case 4:return l=d.sent(),T(l),[3,7];case 5:return s=d.sent(),(0,S.Eo)(s),[3,7];case 6:return M(!1),[7];case 7:return[2]}}))})))];case 1:return e.sent(),W(void 0),[2]}var t,n}))}))}},d.createElement(l.Z.Text,null,A("message.are-you-sure-you-want-to-remove-child-from-parent",{child:(0,g.C_)(H.record),parent:X}))),V&&d.createElement(x.Z,{isModalLoading:U,isOpen:!(0,u.isUndefined)(V),selectedKeys:V.selectedData.map((function(e){return e.id})),title:A("label.add")+" "+V.type,type:V.type,onCancel:function(){return z(void 0)},onSave:function(e){return t=e,(0,r.mG)(void 0,void 0,void 0,(function(){var e,n,i,a;return(0,r.Jh)(this,(function(l){switch(l.label){case 0:if(!V)return[3,5];M(!0),e=t.map((function(e){var t=V.selectedData.find((function(t){return t.id===e}));return t||{id:e,type:V.type}})),n=(0,o.qu)(O,(0,r.pi)((0,r.pi)({},O),{policies:e})),l.label=1;case 1:return l.trys.push([1,3,4,5]),[4,(0,Z.sZ)(n,O.id)];case 2:return i=l.sent(),T(i),z(void 0),[3,5];case 3:return a=l.sent(),(0,S.Eo)(a),[3,5];case 4:return M(!1),[7];case 5:return[2]}}))}));var t}}))}}}]);