"use strict";(self.webpackChunkopen_metadata=self.webpackChunkopen_metadata||[]).push([[9295],{99295:function(e,t,a){a.r(t),a.d(t,{default:function(){return P}});var l=a(70655),n=a(67294),r=a(68432),i=a(15137),s=a(49101),c=a(49409),o=a(56256),d=a(71577),m=a(19650),u=a(50963),p=a(96486),y=a(16139),v=a(17309),f=a(24671),b=a(79690),E=a(95137),h=a(79686),w=a(26387),g=a(40773),C=a(37878),N=function(e){var t,a=e.header,i=e.allowAccess,N=void 0===i||i,T=e.isLoading,x=e.slashedBreadcrumb,Z=e.onCancel,L=e.onSave,S=(0,r.$)().t,U=(0,l.CR)((0,u.useForm)(),1)[0],k=(0,E.Eu)().currentUser,I=c.Z.useWatch("owner",U),z=null!==(t=c.Z.useWatch("reviewers",U))&&void 0!==t?t:[],A=n.createElement("div",{"data-testid":"right-panel"},n.createElement(o.Z.Title,{level:5},S("label.configure-entity",{entity:S("label.client-center")})),n.createElement(o.Z.Text,{className:"mb-5"},S("message.create-new-client-center-guide"))),P=[{name:"name",id:"root/name",label:S("label.name"),required:!0,placeholder:S("label.name"),type:v.U.TEXT,props:{"data-testid":"name"},rules:[{pattern:y.$Q,message:S("message.entity-name-validation")},{min:1,max:128,message:""+S("message.entity-maximum-size",{entity:""+S("label.name"),max:"128"})}]},{name:"displayName",id:"root/displayName",label:S("label.display-name"),required:!1,placeholder:S("label.display-name"),type:v.U.TEXT,props:{"data-testid":"display-name"}},{name:"tags",required:!1,label:S("label.tag-plural"),id:"root/tags",type:v.U.TAG_SUGGESTION,props:{"data-testid":"tags-container"}},{name:"mutuallyExclusive",label:S("label.mutually-exclusive"),type:v.U.SWITCH,required:!1,props:{"data-testid":"mutually-exclusive-button"},id:"root/mutuallyExclusive",formItemLayout:v.E.HORIZONATAL}],R={name:"owner",id:"root/owner",required:!1,label:S("label.owner"),type:v.U.USER_TEAM_SELECT,props:{hasPermission:!0,children:n.createElement(d.Z,{"data-testid":"add-owner",icon:n.createElement(s.Z,{style:{color:"white",fontSize:"12px"}}),size:"small",type:"primary"})},formItemLayout:v.E.HORIZONATAL,formItemProps:{valuePropName:"owner",trigger:"onUpdate"}},_={name:"reviewers",id:"root/reviewers",required:!1,label:S("label.reviewer-plural"),type:v.U.USER_MULTI_SELECT,props:{hasPermission:!0,popoverProps:{placement:"topLeft"},children:n.createElement(d.Z,{"data-testid":"add-reviewers",icon:n.createElement(s.Z,{style:{color:"white",fontSize:"12px"}}),size:"small",type:"primary"})},formItemLayout:v.E.HORIZONATAL,formItemProps:{valuePropName:"selectedUsers",trigger:"onUpdate",initialValue:[]}};return n.createElement(h.Z,{firstPanel:{children:n.createElement("div",{className:"max-width-md w-9/10 service-form-container"},n.createElement(w.Z,{titleLinks:x}),n.createElement(o.Z.Title,{className:"m-t-md","data-testid":"form-heading",level:5},a),n.createElement("div",{className:"add-clientCenter","data-testid":"add-clientCenter"},n.createElement(c.Z,{form:U,layout:"vertical",onFinish:function(e){var t=e.name,a=e.displayName,l=e.description,n=void 0===l?"":l,r=e.tags,i=e.mutuallyExclusive,s=e.reviewers,c=void 0===s?[]:s,o=e.owner,d=null!=o?o:{id:null==k?void 0:k.id,type:"user"},m={name:t.trim(),displayName:null==a?void 0:a.trim(),description:n,reviewers:c.map((function(e){return(0,p.toString)(e.fullyQualifiedName)})).filter(Boolean),owner:d,tags:r||[],mutuallyExclusive:Boolean(i)};L(m)}},(0,b.GL)(P),n.createElement("div",{className:"m-t-xss"},(0,b.rz)(R),I&&n.createElement("div",{className:"m-y-xs","data-testid":"owner-container"},n.createElement(g.w,{id:I.id,name:(0,f.C_)(I),size:C.e.small}))),n.createElement("div",{className:"m-t-xss"},(0,b.rz)(_),Boolean(z.length)&&n.createElement(m.Z,{wrap:!0,className:"m-y-xs","data-testid":"reviewers-container",size:[8,8]},z.map((function(e,t){return n.createElement(g.w,{id:e.id,key:t,name:(0,f.C_)(e),size:C.e.small})})))),n.createElement(m.Z,{className:"w-full justify-end","data-testid":"cta-buttons",size:16},n.createElement(d.Z,{"data-testid":"cancel-clientCenter",type:"link",onClick:Z},S("label.cancel")),n.createElement(d.Z,{"data-testid":"save-clientCenter",disabled:!N,htmlType:"submit",loading:T,type:"primary"},S("label.save")))))),minWidth:700,flex:.7},pageTitle:S("label.add-entity",{entity:S("label.client-center")}),secondPanel:{children:A,className:"p-md service-doc-panel",minWidth:60,overlay:{displayThreshold:200,header:S("label.setup-guide"),rotation:"counter-clockwise"}}})},T=a(8752),x=a(79839),Z=a(62761),L=a(72819),S=a(90108),U=a(93895),k=a(39570),I=a(96840),z=a(73553),A=a(46321),P=function(){var e=(0,i.k6)(),t=(0,T.BL)().permissions,a=(0,l.CR)((0,n.useState)([]),2),s=a[0],c=a[1],o=(0,l.CR)((0,n.useState)(!1),2),d=o[0],m=o[1],u=(0,l.CR)((0,n.useState)(!1),2),p=u[0],y=u[1],v=(0,l.CR)((0,n.useState)([]),2),f=v[0],b=v[1],E=(0,r.$)().t,h=(0,n.useMemo)((function(){return(0,k.P_)(L.OX.Create,x.A.CLIENT_CENTER,t)}),[t]),w=function(t){void 0===t&&(t=""),e.push((0,I.CM)(t))},g=(0,n.useCallback)((function(){w()}),[]),C=(0,n.useCallback)((function(e){return(0,l.mG)(void 0,void 0,void 0,(function(){var t,a,n;return(0,l.Jh)(this,(function(l){switch(l.label){case 0:y(!0),l.label=1;case 1:return l.trys.push([1,3,4,5]),[4,(0,S.b2)(e)];case 2:return t=l.sent(),w(null!==(n=t.fullyQualifiedName)&&void 0!==n?n:""),[3,5];case 3:return a=l.sent(),r=(0,U.B)(a,Z.c9.alreadyExist)?E("server.entity-already-exist",{entity:E("label.client-center"),entityPlural:E("label.client-center-lowercase-plural"),name:e.name}):a,i=E("server.add-entity-error",{entity:E("label.client-center-lowercase")}),(0,A.Eo)(r,i),[3,5];case 4:return y(!1),[7];case 5:return[2]}var r,i}))}))}),[]);return(0,n.useEffect)((function(){b([{name:E("label.client-center"),url:(0,I.CM)()},{name:E("label.add-entity",{entity:E("label.client-center")}),url:"",activeTitle:!0}])}),[]),n.createElement("div",{className:"self-center"},n.createElement(N,{allowAccess:h,fetchTags:function(){m(!0),(0,z.bn)().then((function(e){return(0,l.mG)(void 0,void 0,void 0,(function(){var t;return(0,l.Jh)(this,(function(a){switch(a.label){case 0:return e.data?[4,(0,z.bM)(e.data)]:[3,2];case 1:return t=a.sent(),c(t),[3,3];case 2:(0,A.Eo)(E("server.entity-fetch-error",{entity:E("label.tag-plural")})),a.label=3;case 3:return[2]}}))}))})).catch((function(e){(0,A.Eo)(e,E("server.entity-fetch-error",{entity:E("label.tag-plural")}))})).finally((function(){m(!1)}))},header:E("label.add-entity",{entity:E("label.client-center")}),isLoading:p,isTagLoading:d,slashedBreadcrumb:f,tagList:s,onCancel:g,onSave:C}))}}}]);