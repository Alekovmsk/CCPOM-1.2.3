"use strict";(self.webpackChunkopen_metadata=self.webpackChunkopen_metadata||[]).push([[4982],{49285:function(e,t,n){n.d(t,{m:function(){return c}});var r=n(94199),a=n(71577),i=n(67294),o=n(68432),s=n(51297),l=n(97010),c=function(e){var t=e.copyText,n=e.copyTimer,c=void 0===n?1500:n,u=e.position,d=void 0===u?"left":u,m=e.onCopy,f=(0,o.$)().t,p=(0,l.V)(t,c,m),v=p.hasCopied,h=p.onCopyToClipBoard;return i.createElement(r.Z,{destroyTooltipOnHide:!0,open:v,placement:d,title:i.createElement("span",{className:"text-xs font-medium","data-testid":"copy-success"},f("message.copied-to-clipboard")),trigger:"click"},i.createElement(a.Z,{className:"h-8 m-l-md relative","data-testid":"copy-secret",icon:i.createElement(s.ReactComponent,{"data-testid":"copy-icon",width:"16"}),type:"text",onClick:h}))};t.Z=c},63764:function(e,t,n){var r,a,i;n.d(t,{Gr:function(){return r},T_:function(){return a}}),function(e){e.Basic="BASIC",e.Jwt="JWT",e.Sso="SSO"}(r||(r={})),function(e){e.OneHour="OneHour",e.The1="1",e.The30="30",e.The60="60",e.The7="7",e.The90="90",e.Unlimited="Unlimited"}(a||(a={})),function(e){e.Auth0="auth0",e.Azure="azure",e.CustomOidc="custom-oidc",e.Google="google",e.Okta="okta"}(i||(i={}))},97010:function(e,t,n){n.d(t,{V:function(){return o}});var r=n(70655),a=n(96486),i=n(67294),o=function(e,t,n){void 0===t&&(t=1500);var o=(0,r.CR)((0,i.useState)(!1),2),s=o[0],l=o[1],c=(0,r.CR)((0,i.useState)(e),2),u=c[0],d=c[1],m=(0,i.useCallback)((function(){return(0,r.mG)(void 0,void 0,void 0,(function(){return(0,r.Jh)(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,navigator.clipboard.writeText(u)];case 1:return e.sent(),l(!0),n&&n(),[3,3];case 2:return e.sent(),l(!1),[3,3];case 3:return[2]}}))}))}),[u]);return(0,i.useEffect)((function(){return d(e)}),[e]),(0,i.useEffect)((function(){var e=null;return s&&(e=(0,a.toNumber)(setTimeout((function(){l(!1)}),t))),function(){e&&clearTimeout(e)}}),[t,s]),{onCopyToClipBoard:m,hasCopied:s}}},14982:function(e,t,n){n.r(t),n.d(t,{default:function(){return V}});var r,a,i,o,s=n(70655),l=n(96486),c=n.n(l),u=n(67674),d=n(67294),m=n(68432),f=n(15137),p=n(34041),v=n(49409),h=n(4107),b=n(55742),y=n(19650),E=n(12028),w=n(71577),Z=n(62761),g=n(16139),C=n(55546);!function(e){e.Basic="BASIC",e.Jwt="JWT",e.Sso="SSO"}(r||(r={})),function(e){e.OneHour="OneHour",e.The1="1",e.The30="30",e.The60="60",e.The7="7",e.The90="90",e.Unlimited="Unlimited"}(a||(a={})),function(e){e.Auth0="auth0",e.Azure="azure",e.CustomOidc="custom-oidc",e.Google="google",e.Okta="okta"}(i||(i={})),function(e){e.AdminCreate="ADMIN_CREATE",e.UserCreate="USER_CREATE"}(o||(o={}));var T=n(53026),G=n(32957),k=n(87738),N=n(93895),J=n(24671),x=n(38212),P=n(46321),S=n(95137),A=n(18927),O=n(49285),B=n(69523),I=n(85506),R=p.Z.Option,W=function(e){var t=e.roles,n=e.isLoading,a=e.onCancel,i=e.onSave,c=e.forceBot,u=(0,m.$)().t,f=(0,s.CR)(v.Z.useForm(),1)[0],W=(0,S.Eu)().authConfig,_=(0,s.CR)((0,d.useState)(!1),2),j=_[0],F=_[1],H=(0,s.CR)((0,d.useState)(c),2),U=H[0],D=H[1],M=(0,s.CR)((0,d.useState)([]),2),V=M[0],z=M[1],L=(0,s.CR)((0,d.useState)(!1),2),q=L[0],$=L[1],K=(0,d.useMemo)((function(){return(null==W?void 0:W.provider)===T.Ho.Basic||(null==W?void 0:W.provider)===T.Ho.LDAP}),[W]),Q=v.Z.useWatch("roles",f),Y=(0,d.useMemo)((function(){return(0,l.map)(t,(function(e){return{label:(0,J.C_)(e),value:e.id}}))}),[t]),X=v.Z.useWatch("generatedPassword",f),ee=v.Z.useWatch("passwordGenerator",f),te=v.Z.useWatch("password",f),ne=function(){return(0,s.mG)(void 0,void 0,void 0,(function(){var e,t;return(0,s.Jh)(this,(function(n){switch(n.label){case 0:$(!0),n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,(0,G.M8)()];case 2:return e=n.sent(),setTimeout((function(){f.setFieldsValue({generatedPassword:e})}),500),[3,5];case 3:return t=n.sent(),(0,P.Eo)(t),[3,5];case 4:return $(!1),[7];case 5:return[2]}}))}))};return(0,d.useEffect)((function(){ne()}),[]),d.createElement(v.Z,{form:f,id:"create-user-bot-form",initialValues:{passwordGenerator:C.Wm.AutomaticGenerate},layout:"vertical",validateMessages:Z.NG,onFinish:function(e){var t=ee===C.Wm.AutomaticGenerate,n=(0,l.compact)(V).map((function(e){return e.id})),a=e.email,u=e.displayName,d=e.tokenExpiry,m=e.confirmPassword,f=e.description,p=(0,s.pi)({description:f,name:a.split("@")[0],displayName:(0,l.trim)(u),roles:Q,teams:n.length?n:void 0,email:a,isAdmin:j,isBot:U},c?{authenticationMechanism:{authType:r.Jwt,config:{JWTTokenExpiry:d}}}:{password:t?X:te,confirmPassword:t?X:m,createPasswordType:o.AdminCreate});i(p)}},d.createElement(v.Z.Item,{label:u("label.email"),name:"email",rules:[{pattern:g.Ln,required:!0,type:"email",message:u("message.field-text-is-invalid",{fieldText:u("label.email")})},{type:"email",required:!0,validator:function(e,t){return(0,s.mG)(void 0,void 0,void 0,(function(){return(0,s.Jh)(this,(function(e){switch(e.label){case 0:return!g.Ln.test(t)||c?[3,2]:[4,(0,G.eg)(t)];case 1:return e.sent()?[2,Promise.reject(u("message.entity-already-exists",{entity:t}))]:[2,Promise.resolve()];case 2:return[2]}}))}))}}]},d.createElement(h.Z,{"data-testid":"email",name:"email",placeholder:u("label.email")})),d.createElement(v.Z.Item,{label:u("label.display-name"),name:"displayName"},d.createElement(h.Z,{"data-testid":"displayName",name:"displayName",placeholder:u("label.display-name")})),c&&d.createElement(v.Z.Item,{label:u("label.token-expiration"),name:"tokenExpiry",rules:[{required:!0}]},d.createElement(p.Z,{className:"w-full","data-testid":"token-expiry",placeholder:u("message.select-token-expiration")},(0,k.D1)().map((function(e){return d.createElement(R,{key:e.value},e.label)})))),d.createElement(v.Z.Item,{label:u("label.description"),name:"description",trigger:"onTextChange",valuePropName:"initialValue"},d.createElement(A.Z,null)),!c&&d.createElement(d.Fragment,null,K&&d.createElement(d.Fragment,null,d.createElement(v.Z.Item,{name:"passwordGenerator"},d.createElement(b.ZP.Group,null,d.createElement(b.ZP,{value:C.Wm.AutomaticGenerate},u("label.automatically-generate")),d.createElement(b.ZP,{value:C.Wm.CreatePassword},u("label.password-type",{type:u("label.create")})))),ee===C.Wm.CreatePassword?d.createElement("div",{className:"m-t-sm"},d.createElement(v.Z.Item,{label:u("label.password"),name:"password",rules:[{required:!0},{pattern:g.BV,message:u("message.password-error-message")}]},d.createElement(h.Z.Password,{autoComplete:"off",name:"password",placeholder:u("label.password-type",{type:u("label.enter")})})),d.createElement(v.Z.Item,{label:u("label.password-type",{type:u("label.confirm")}),name:"confirmPassword",rules:[{validator:function(e,t){return t!==te?Promise.reject(u("label.password-not-match")):Promise.resolve()}}]},d.createElement(h.Z.Password,{autoComplete:"off",name:"confirmPassword",placeholder:u("label.password-type",{type:u("label.confirm")})}))):d.createElement("div",{className:"m-t-sm"},d.createElement(v.Z.Item,{label:u("label.password-type",{type:u("label.generate")}),name:"generatedPassword",rules:[{required:!0}]},d.createElement(h.Z.Password,{readOnly:!0,addonAfter:d.createElement("div",{className:"flex-center w-16"},d.createElement("div",{className:"w-8 h-7 flex-center cursor-pointer","data-testid":"password-generator",onClick:ne},q?d.createElement(B.Z,{size:"small",type:"default"}):d.createElement(x.ZP,{alt:u("label.generate"),icon:x.PJ.SYNC,width:"16"})),d.createElement("div",{className:"w-8 h-7 flex-center"},d.createElement(O.Z,{copyText:X}))),autoComplete:"off",name:"generatedPassword",value:X})))),d.createElement(v.Z.Item,{label:u("label.team-plural"),name:"teams"},d.createElement(I.Z,{onSelectionChange:z})),d.createElement(v.Z.Item,{label:u("label.role-plural"),name:"roles"},d.createElement(p.Z,{"data-testid":"roles-dropdown",disabled:(0,l.isEmpty)(t),filterOption:N.r8,mode:"multiple",options:Y,placeholder:u("label.please-select-entity",{entity:u("label.role-plural")})})),d.createElement(v.Z.Item,null,d.createElement(y.Z,null,d.createElement("span",null," ",u("label.admin")),d.createElement(E.Z,{checked:j,"data-testid":"admin",onChange:function(){F((function(e){return!e})),D(!1)}})))),d.createElement(y.Z,{className:"w-full justify-end",size:4},d.createElement(w.Z,{"data-testid":"cancel-user",type:"link",onClick:a},u("label.cancel")),d.createElement(w.Z,{"data-testid":"save-user",form:"create-user-bot-form",htmlType:"submit",loading:n,type:"primary"},u("label.create"))))},_=n(80646),j=n(26387),F=n(96162),H=n(31928),U=n(80897),D=n(23313),M=n(96840),V=(0,u.Pi)((function(){var e=(0,f.k6)(),t=(0,m.$)().t,n=(0,s.CR)((0,d.useState)([]),2),r=n[0],a=n[1],i=(0,s.CR)((0,d.useState)(!1),2),o=i[0],l=i[1],u=(0,f.UO)().bot,p=function(){u?e.push((0,M.si)(F.CZ.INTEGRATIONS,F.lx.BOTS)):e.goBack()},v=function(e,t){(0,P.Eo)(e,t)};(0,d.useEffect)((function(){(0,s.mG)(void 0,void 0,void 0,(function(){var e,n;return(0,s.Jh)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,(0,U.F3)("",void 0,void 0,!1,Z.SF)];case 1:return e=r.sent(),a(e.data),[3,3];case 2:return n=r.sent(),a([]),(0,P.Eo)(n,t("server.entity-fetch-error",{entity:t("label.role-plural")})),[3,3];case 3:return[2]}}))}))}),[]);var h=(0,d.useMemo)((function(){return[{name:t(u?"label.bot-plural":"label.user-plural"),url:u?(0,Z.tc)():(0,Z.Yd)()},{name:t("label.create")+" "+t(u?"label.bot":"label.user"),url:"",activeTitle:!0}]}),[u]);return d.createElement(_.Z,{pageTitle:t("label.create-entity",{entity:t("label.user-r")})},d.createElement("div",{className:"max-width-md w-9/10 service-form-container"},d.createElement(j.Z,{titleLinks:h}),d.createElement("div",{className:"m-t-md"},d.createElement(W,{forceBot:Boolean(u),isLoading:o,roles:r,onCancel:function(){p()},onSave:function(e){return(0,s.mG)(void 0,void 0,void 0,(function(){var n,r,a;return(0,s.Jh)(this,(function(i){switch(i.label){case 0:return l(!0),u?[4,(o=e.name,(0,s.mG)(void 0,void 0,void 0,(function(){var e;return(0,s.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(0,D.RR)(o)];case 1:return e=t.sent(),[2,Boolean(e)];case 2:return t.sent(),[2,!1];case 3:return[2]}}))})))]:[3,7];case 1:return i.sent()?((0,P.Eo)(t("server.email-already-exist",{entity:t("label.bot-lowercase"),name:e.name})),[3,6]):[3,2];case 2:return i.trys.push([2,5,,6]),[4,(0,D.BK)((0,s.pi)((0,s.pi)({},e),{botName:e.name}))];case 3:return n=i.sent(),[4,(0,H.Kp)({botUser:c().toString(n.fullyQualifiedName),name:n.name,displayName:n.displayName,description:n.description})];case 4:return i.sent(),(0,P.XA)(t("server.create-entity-success",{entity:t("label.bot")})),p(),[3,6];case 5:return r=i.sent(),v(r,t("server.create-entity-error",{entity:t("label.bot")})),[3,6];case 6:return[3,10];case 7:return i.trys.push([7,9,,10]),[4,(0,D.r4)(e)];case 8:return i.sent(),p(),[3,10];case 9:return a=i.sent(),v((0,N.B)(a,Z.c9.alreadyExist)?t("server.email-already-exist",{entity:t("label.user-lowercase"),name:e.name}):a,t("server.create-entity-error",{entity:t("label.user")})),[3,10];case 10:return l(!1),[2]}var o}))}))}}))))}))},31928:function(e,t,n){n.d(t,{Kp:function(){return s},Ww:function(){return o}});var r=n(70655),a=n(2598),i="/bots",o=function(e){return(0,r.mG)(void 0,void 0,void 0,(function(){return(0,r.Jh)(this,(function(t){switch(t.label){case 0:return[4,a.Z.get(i,{params:e})];case 1:return[2,t.sent().data]}}))}))},s=function(e){return(0,r.mG)(void 0,void 0,void 0,(function(){return(0,r.Jh)(this,(function(t){switch(t.label){case 0:return[4,a.Z.put(i,e)];case 1:return[2,t.sent().data]}}))}))}},80897:function(e,t,n){n.d(t,{$j:function(){return f},F3:function(){return o},Ko:function(){return s},QW:function(){return v},_d:function(){return u},cN:function(){return p},dV:function(){return h},n5:function(){return l},sZ:function(){return m},u$:function(){return d},u7:function(){return c}});var r=n(70655),a=n(2598),i={headers:{"Content-type":"application/json-patch+json"}},o=function(e,t,n,i,o){return void 0===i&&(i=!1),void 0===o&&(o=10),(0,r.mG)(void 0,void 0,void 0,(function(){var s;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return s={default:i,limit:o,fields:e,after:t,before:n},[4,a.Z.get("/roles",{params:s})];case 1:return[2,r.sent().data]}}))}))},s=function(e,t,n,i){return void 0===i&&(i=10),(0,r.mG)(void 0,void 0,void 0,(function(){var o;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return o={limit:i,fields:e,after:t,before:n},[4,a.Z.get("/policies",{params:o})];case 1:return[2,r.sent().data]}}))}))},l=function(e,t){return(0,r.mG)(void 0,void 0,void 0,(function(){return(0,r.Jh)(this,(function(n){switch(n.label){case 0:return[4,a.Z.get("/roles/name/"+e,{params:{fields:t}})];case 1:return[2,n.sent().data]}}))}))},c=function(e,t){return(0,r.mG)(void 0,void 0,void 0,(function(){return(0,r.Jh)(this,(function(n){switch(n.label){case 0:return[4,a.Z.get("/policies/name/"+e,{params:{fields:t}})];case 1:return[2,n.sent().data]}}))}))},u=function(e){return(0,r.mG)(void 0,void 0,void 0,(function(){return(0,r.Jh)(this,(function(t){switch(t.label){case 0:return[4,a.Z.post("/roles",e)];case 1:return[2,t.sent().data]}}))}))},d=function(e){return(0,r.mG)(void 0,void 0,void 0,(function(){return(0,r.Jh)(this,(function(t){switch(t.label){case 0:return[4,a.Z.post("/policies",e)];case 1:return[2,t.sent().data]}}))}))},m=function(e,t){return(0,r.mG)(void 0,void 0,void 0,(function(){return(0,r.Jh)(this,(function(n){switch(n.label){case 0:return[4,a.Z.patch("/roles/"+t,e,i)];case 1:return[2,n.sent().data]}}))}))},f=function(e,t){return(0,r.mG)(void 0,void 0,void 0,(function(){return(0,r.Jh)(this,(function(n){switch(n.label){case 0:return[4,a.Z.patch("/policies/"+t,e,i)];case 1:return[2,n.sent().data]}}))}))},p=function(){return(0,r.mG)(void 0,void 0,void 0,(function(){return(0,r.Jh)(this,(function(e){switch(e.label){case 0:return[4,a.Z.get("/policies/resources")];case 1:return[2,e.sent().data]}}))}))},v=function(){return(0,r.mG)(void 0,void 0,void 0,(function(){return(0,r.Jh)(this,(function(e){switch(e.label){case 0:return[4,a.Z.get("/policies/functions")];case 1:return[2,e.sent().data]}}))}))},h=function(e){return(0,r.mG)(void 0,void 0,void 0,(function(){return(0,r.Jh)(this,(function(t){switch(t.label){case 0:return[4,a.Z.get("/policies/validation/condition/"+e)];case 1:return[2,t.sent()]}}))}))}},87738:function(e,t,n){n.d(t,{D1:function(){return o},I9:function(){return l},Tm:function(){return s}});var r=n(23031),a=n(63764),i=n(53429),o=function(){return Object.keys(a.T_).map((function(e){var t=a.T_[e];return{label:t===a.T_.OneHour?"1 hr":t+" days",value:t}}))},s=function(){return{label:(0,r.t)("label.open-metadata")+" "+(0,r.t)("label.jwt-uppercase"),value:a.Gr.Jwt}},l=function(e){var t=Date.now()>=e;return{tokenExpiryDate:(0,i.gD)(e),isTokenExpired:t}}}}]);