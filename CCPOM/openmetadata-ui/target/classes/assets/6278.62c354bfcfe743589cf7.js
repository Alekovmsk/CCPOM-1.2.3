"use strict";(self.webpackChunkopen_metadata=self.webpackChunkopen_metadata||[]).push([[6278],{71068:function(e,t,n){var a=n(8081),i=n.n(a),l=n(23645),s=n.n(l)()(i());s.push([e.id,'/*\n *  Copyright 2022 Collate.\n *  Licensed under the Apache License, Version 2.0 (the "License");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *  http://www.apache.org/licenses/LICENSE-2.0\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an "AS IS" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n.assignee-tag {\n  display: flex;\n  align-items: center;\n  padding: 2px 3px;\n  margin: 1px 2px;\n}\n.assignee-item .profile-image {\n  vertical-align: middle;\n}\n',""]),t.Z=s},41953:function(e,t,n){var a=n(8081),i=n.n(a),l=n(23645),s=n.n(l)()(i());s.push([e.id,'/*\n *  Copyright 2023 Collate.\n *  Licensed under the Apache License, Version 2.0 (the "License");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *  http://www.apache.org/licenses/LICENSE-2.0\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an "AS IS" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n.request-tags .ant-select-custom,\n.request-description .ant-select-custom {\n  margin: 0;\n}\n.request-description .ant-tabs-description {\n  margin-top: 0;\n}\n.task-data {\n  width: unset;\n}\n',""]),t.Z=s},42105:function(e,t,n){var a=n(93379),i=n.n(a),l=n(7795),s=n.n(l),r=n(90569),u=n.n(r),c=n(3565),d=n.n(c),o=n(19216),m=n.n(o),p=n(44589),f=n.n(p),g=n(41953),h={};h.styleTagTransform=f(),h.setAttributes=d(),h.insert=u().bind(null,"head"),h.domAPI=s(),h.insertStyleElement=m(),i()(g.Z,h),g.Z&&g.Z.locals&&g.Z.locals},96278:function(e,t,n){n.r(t);var a=n(70655),i=n(56256),l=n(49409),s=n(4107),r=n(19650),u=n(71577),c=n(50963),d=n(96486),o=n(67674),m=n(67294),p=n(68432),f=n(15137),g=n(52046),h=n(98542),y=n(79686),b=n(26387),v=n(95969),E=n(69523),S=n(73213),Z=n(58369),C=n(64632),N=n(59583),T=n(31615),w=n(76373),x=n(93895),I=n(24671),k=n(40734),A=n(86385),L=n(46321),R=n(25131),q=n(40501);n(42105),t.default=(0,o.Pi)((function(){var e,t=(0,p.$)().t,n=(0,f.TH)(),o=(0,f.k6)(),U=(0,a.CR)((0,c.useForm)(),1)[0],O=(0,f.UO)(),F=O.entityType,D=O.fqn,P=new URLSearchParams(n.search),M=P.get("field"),W=P.get("value"),B=(0,a.CR)((0,m.useState)({}),2),V=B[0],_=B[1],G=(0,a.CR)((0,m.useState)([]),2),Y=G[0],K=G[1],Q=(0,a.CR)((0,m.useState)([]),2),X=Q[0],j=Q[1],z=(0,a.CR)((0,m.useState)([]),2),H=z[0],J=z[1],$=(0,a.CR)((0,m.useState)([]),2),ee=$[0],te=$[1],ne=(0,a.CR)((0,m.useState)([]),2),ae=ne[0],ie=ne[1],le=(null==W?void 0:W.replaceAll(/^"|"$/g,""))||"",se="Update tags for "+(le||F)+" "+(M!==Z.Sn.COLUMNS?(0,I.C_)(V):""),re=(0,m.useMemo)((function(){return(0,k.p2)(D)}),[D]),ue=(0,m.useMemo)((function(){return g.Z.getCurrentUserDetails()}),[g.Z.userDetails,g.Z.nonSecureUserDetails]),ce=(0,m.useMemo)((function(){var e=le.split(S.o).slice(-1);return(0,A.dY)(e[0],(0,A.eB)(F,V),F,Y)}),[M,V,Y,F]),de=function(){var e,t;return(0,d.isEmpty)(ce)||(0,d.isUndefined)(ce)?null!==(t=V.tags)&&void 0!==t?t:[]:null!==(e=ce.tags)&&void 0!==e?e:[]},oe=function(){return M&&W?""+M+I.LV+W+I.LV+"tags":Z.Sn.TAGS};return(0,m.useEffect)((function(){(0,A.Dy)(F,D,_,K)}),[D,F]),(0,m.useEffect)((function(){var e=V.owner,t=[];e&&(t=[{label:(0,I.C_)(e),value:e.id||"",type:e.type}],J(t),j(t)),U.setFieldsValue({title:se.trimEnd(),updatedTags:de(),assignees:t})}),[V,ce]),(0,m.useEffect)((function(){te(de()),ie(de())}),[V,ce]),(0,d.isEmpty)(V)?m.createElement(E.Z,null):m.createElement(y.Z,{firstPanel:{minWidth:700,flex:.6,children:m.createElement("div",{className:"max-width-md w-9/10 m-x-auto m-y-md d-grid gap-4"},m.createElement(b.Z,{titleLinks:(0,a.ev)((0,a.ev)([],(0,a.CR)((0,A.rM)(V,F))),[{name:t("label.create-entity",{entity:t("label.task")}),activeTitle:!0,url:""}])}),m.createElement("div",{className:"m-t-0 request-tags",key:"update-tags"},m.createElement(i.Z.Paragraph,{className:"text-base","data-testid":"form-title"},t("label.create-entity",{entity:t("label.task")})),m.createElement(l.Z,{form:U,layout:"vertical",onFinish:function(e){var n={from:null==ue?void 0:ue.name,message:e.title||se,about:(0,I.ec)(F,re,oe()),taskDetails:{assignees:H.map((function(e){return{id:e.value,type:e.type}})),suggestion:JSON.stringify(ae),type:N.U.UpdateTag,oldValue:JSON.stringify(ee)},type:T.Th.Task};(0,w.Kl)(n).then((function(){(0,L.XA)(t("server.create-entity-success",{entity:t("label.task")})),o.push((0,x.X3)(F,re,C.M8.ACTIVITY_FEED,h.o.TASKS))})).catch((function(e){return(0,L.Eo)(e)}))}},m.createElement(l.Z.Item,{"data-testid":"title",label:t("label.title")+":",name:"title"},m.createElement(s.Z,{disabled:!0,placeholder:t("label.task-entity",{entity:t("label.title")})})),m.createElement(l.Z.Item,{"data-testid":"assignees",label:t("label.assignee-plural")+":",name:"assignees",rules:[{required:!0,message:t("message.field-text-is-required",{fieldText:t("label.assignee-plural")})}]},m.createElement(R.Z,{options:X,value:H,onChange:J,onSearch:function(e){(0,A.Od)(e,j)}})),ee.length?m.createElement(l.Z.Item,{"data-testid":"tags-label",label:t("label.update-entity",{entity:t("label.tag-plural")}),name:"updatedTags",rules:[{required:!0,message:t("message.field-text-is-required",{fieldText:t("label.tag-plural")})}]},m.createElement(q.X,{tags:ee,value:ae,onChange:ie})):null,m.createElement(l.Z.Item,null,m.createElement(r.Z,{className:"w-full justify-end","data-testid":"cta-buttons",size:16},m.createElement(u.Z,{type:"link",onClick:function(){return o.goBack()}},t("label.back")),m.createElement(u.Z,{"data-testid":"submit-test",htmlType:"submit",type:"primary"},t("label.submit")))))))},pageTitle:t("label.task"),secondPanel:{minWidth:60,flex:.4,children:m.createElement(v.Z,{hideBreadcrumbs:!0,showTags:!0,id:null!==(e=V.id)&&void 0!==e?e:"",source:(0,a.pi)((0,a.pi)({},V),{entityType:F})})}})}))},25131:function(e,t,n){n.d(t,{Z:function(){return I}});var a=n(70655),i=n(19650),l=n(56256),s=n(34041),r=n(23031),u=n(96486),c=n(67294),d=n(43443),o=n(40773),m=n(37878),p=n(55546),f=n(93379),g=n.n(f),h=n(7795),y=n.n(h),b=n(90569),v=n.n(b),E=n(3565),S=n.n(E),Z=n(19216),C=n.n(Z),N=n(44589),T=n.n(N),w=n(71068),x={};x.styleTagTransform=T(),x.setAttributes=S(),x.insert=v().bind(null,"head"),x.domAPI=y(),x.insertStyleElement=C(),g()(w.Z,x),w.Z&&w.Z.locals&&w.Z.locals;var I=function(e){var t=e.value,n=void 0===t?[]:t,f=e.onSearch,g=e.onChange,h=e.options,y=(0,c.useMemo)((function(){var e=(0,u.groupBy)(h,(function(e){return e.type})),t=[];return(0,u.isUndefined)(e.team)||t.push({type:"group",label:"Teams",value:p.jc.TEAM,options:e.team.map((function(e){return(0,a.pi)((0,a.pi)({},e),{label:c.createElement(i.Z,{"data-testid":"assignee-option",key:e.value},c.createElement(d.ReactComponent,{height:16,width:16}),c.createElement(l.Z.Text,null,e.label))})}))}),(0,u.isUndefined)(e.user)||t.push({type:"group",label:"Users",value:p.jc.USER,options:e.user.map((function(e){return(0,a.pi)((0,a.pi)({},e),{label:c.createElement("div",{"data-testid":"assignee-option-"+e.label},c.createElement(o.w,{className:"assignee-item",id:e.value,name:e.label,size:m.e.small}))})}))}),t}),[h]);return c.createElement(s.Z,{showSearch:!0,className:"ant-select-custom select-assignee","data-testid":"select-assignee",defaultActiveFirstOption:!1,filterOption:!1,mode:"multiple",notFoundContent:null,options:y,placeholder:(0,r.t)("label.select-to-search"),showArrow:!1,value:n.length?n:void 0,onChange:function(e,t){var n=t.map((function(e){return{label:e["data-label"],value:e.value,type:e.type}}));g(n)},onSearch:f})}},39379:function(e,t,n){n.d(t,{_:function(){return c}});var a=n(60331),i=n(94184),l=n.n(i),s=n(23031),r=n(96486),u=n(67294),c=function(e){var t=e.diffArr,n=e.className,i=t.map((function(e){return e.added?u.createElement("div",{className:"d-flex flex-wrap m-y-xs","data-testid":"diff-added",key:(0,r.uniqueId)()},e.value.map((function(e){return u.createElement(a.Z,{key:(0,r.uniqueId)(),style:{background:"rgba(0, 131, 118, 0.2)",color:"#008376"}},e.tagFQN)}))):e.removed?u.createElement("div",{className:"d-flex flex-wrap m-y-xs","data-testid":"diff-removed",key:(0,r.uniqueId)()},e.value.map((function(e){return u.createElement(a.Z,{key:(0,r.uniqueId)(),style:{color:"grey",textDecoration:"line-through"}},e.tagFQN)}))):u.createElement("div",{className:"d-flex flex-wrap m-y-xs","data-testid":"diff-normal",key:(0,r.uniqueId)()},e.value.length?e.value.map((function(e){return u.createElement(a.Z,{key:(0,r.uniqueId)()},e.tagFQN)})):u.createElement("div",{className:"text-grey-muted text-center","data-testid":"noDiff-placeholder"},(0,s.t)("label.no-diff-available")))}));return u.createElement("div",{className:l()("w-full",n),"data-testid":"diff-container"},i)}},40501:function(e,t,n){n.d(t,{X:function(){return m}});var a=n(70655),i=n(25499),l=n(60331),s=n(59295),r=n(96486),u=n(67294),c=n(59923),d=n(39379),o=n(58666),m=function(e){var t=e.tags,n=e.value,m=void 0===n?[]:n,p=e.onChange,f=(0,a.CR)((0,u.useState)([]),2),g=f[0],h=f[1],y=(0,a.CR)((0,u.useState)(c.G.NEW),2),b=y[0],v=y[1];return u.createElement(i.Z,{activeKey:b,size:"small",type:"card",onChange:function(e){v(e),e===c.G.DIFF?h((0,s.Bm)(t,m)):h([])}},u.createElement(i.Z.TabPane,{"data-testid":"current-tab",key:c.G.CURRENT,tab:"Current"},u.createElement("div",{className:"d-flex flex-wrap m-y-xs","data-testid":"tags"},t.map((function(e){return u.createElement(l.Z,{key:(0,r.uniqueId)()},e.tagFQN)})))),u.createElement(i.Z.TabPane,{"data-testid":"diff-tab",key:c.G.DIFF,tab:"Diff"},u.createElement(d._,{diffArr:g})),u.createElement(i.Z.TabPane,{"data-testid":"new-tab",key:c.G.NEW,tab:"New"},u.createElement("div",{className:"m-t-xs"},u.createElement(o.Z,{value:m,onChange:p}))))}}}]);