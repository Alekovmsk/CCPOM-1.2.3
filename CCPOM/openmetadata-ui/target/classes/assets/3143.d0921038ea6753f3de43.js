"use strict";(self.webpackChunkopen_metadata=self.webpackChunkopen_metadata||[]).push([[3143],{52011:function(e,t,n){var r;n.d(t,{i:function(){return r}}),function(e){e.ON_DEMAND="on_demand",e.LIVE="live",e.SCHEDULE="schedule"}(r||(r={}))},73143:function(e,t,n){n.r(t);var r=n(70655),a=n(96486),i=n(67294),l=n(68432),o=n(15137),s=n(7067),c=n(83716),u=n(79686),f=n(86879),d=n(26387),p=n(69523),g=n(62761),m=n(78666),h=n(31968),E=n(28517),v=n(5302),w=n(19894),y=n(97354),b=n(99166),D=n(93895),C=n(50156),H=n(75838),S=n(46321);t.default=function(){var e,t=(0,w.w)().fetchAirflowStatus,n=(0,o.UO)(),k=n.ingestionType,z=n.fqn,R=n.serviceCategory,x=(0,l.$)().t,T=(0,o.k6)(),P=(0,r.CR)((0,i.useState)(),2),A=P[0],I=P[1],N=(0,r.CR)((0,i.useState)(1),2),Z=N[0],L=N[1],M=(0,r.CR)((0,i.useState)(!0),2),_=M[0],O=M[1],U=(0,r.CR)((0,i.useState)(!1),2),K=U[0],B=U[1],W=(0,r.CR)((0,i.useState)(0),2),F=W[0],G=W[1],Y=(0,r.CR)((0,i.useState)(!1),2),V=Y[0],Q=Y[1],$=(0,r.CR)((0,i.useState)(!1),2),q=$[0],J=$[1],X=(0,r.CR)((0,i.useState)(E.g.CREATING),2),j=X[0],ee=X[1],te=(0,r.CR)((0,i.useState)(""),2),ne=te[0],re=te[1],ae=(0,r.CR)((0,i.useState)(!1),2),ie=ae[0],le=ae[1],oe=(0,r.CR)((0,i.useState)([]),2),se=oe[0],ce=oe[1],ue=(0,r.CR)((0,i.useState)(""),2),fe=ue[0],de=ue[1],pe=(0,i.useMemo)((function(){return k===v.Hz.DataInsight||k===v.Hz.ElasticSearchReindex}),[k]),ge=function(e){return new Promise((function(t){Q(!0),G(g.lB),ee(E.g.DEPLOYING),(0,y.aw)(null!=e?e:ne).then((function(){J(!0),le(!1),G(g.$M),ee(E.g.DEPLOYED)})).catch((function(e){le(!0),ee(E.g.DEPLOYING_ERROR),(0,S.Eo)(e,x("server.deploy-entity-error",{entity:x("label.ingestion-workflow-lowercase")}))})).finally((function(){return t()}))}))},me=pe?function(){T.push((0,C.mK)(k))}:function(){T.push((0,g.LE)(z,R,"ingestions"))};(0,i.useEffect)((function(){var e=(0,C.rh)(pe,k,R,z,m.Rw.ADD,A);ce(e)}),[R,k,A,pe]);var he=i.createElement("div",{className:"max-width-md w-9/10 service-form-container"},i.createElement(d.Z,{titleLinks:se}),i.createElement("div",{className:"m-t-md"},i.createElement(s.Z,{activeIngestionStep:Z,handleCancelClick:me,handleViewServiceClick:me,heading:(0,C.QB)(k,m.Rw.ADD),ingestionAction:j,ingestionProgress:F,isIngestionCreated:V,isIngestionDeployed:q,pipelineType:k,serviceCategory:R,serviceData:A,setActiveIngestionStep:function(e){return L(e)},showDeployButton:ie,status:h.Y.ADD,onAddIngestionSave:function(e){return G(g.aN),new Promise((function(t,n){return(0,y.XZ)(e).then((function(e){var r;e?(re(null!==(r=e.id)&&void 0!==r?r:""),ge(e.id).finally((function(){return t()}))):((0,S.Eo)(x("server.create-entity-error",{entity:x("label.ingestion-workflow")})),n())})).catch((function(r){var a;409===(null===(a=r.response)||void 0===a?void 0:a.status)?((0,S.Eo)(r,x("message.entity-already-exists",{entity:x("label.data-asset")})),n()):(0,y.ne)((null==A?void 0:A.name)+"."+e.name).then((function(e){if(!e)throw x("server.unexpected-response");t(),(0,S.Eo)(r,x("server.deploy-entity-error",{entity:x("label.ingestion-workflow")}))})).catch((function(){(0,S.Eo)(r,x("server.create-entity-error",{entity:x("label.ingestion-workflow")})),n()}))}))}))},onFocus:function(e){(0,a.isEmpty)(e)||setTimeout((function(){de(e)}),50)},onIngestionDeploy:ge}))),Ee=i.createElement(f.Z,{isWorkflow:!0,activeField:fe,serviceName:null!==(e=null==A?void 0:A.serviceType)&&void 0!==e?e:"",serviceType:(0,H.rP)(R),workflowType:k});return(0,i.useEffect)((function(){t().finally((function(){(0,b.dO)(R,z).then((function(e){e?I(e):(0,S.Eo)(x("server.entity-fetch-error",{entity:x("label.service-detail-lowercase-plural")}))})).catch((function(e){var t;404===(null===(t=e.response)||void 0===t?void 0:t.status)?B(!0):(0,S.Eo)(e,x("server.entity-fetch-error",{entity:x("label.service-detail-lowercase-plural")}))})).finally((function(){return O(!1)}))}))}),[R,z]),_?i.createElement(p.Z,null):K?i.createElement(c.Z,null,(0,D.mW)(R,z)):i.createElement(u.Z,{firstPanel:{children:he,minWidth:700,flex:.7},pageTitle:x("label.add-entity",{entity:x("label.ingestion")}),secondPanel:{children:Ee,className:"service-doc-panel",minWidth:60,overlay:{displayThreshold:200,header:x("label.setup-guide"),rotation:"counter-clockwise"}}})}},50156:function(e,t,n){n.d(t,{Hl:function(){return z},Kz:function(){return C},QB:function(){return y},mK:function(){return b},nH:function(){return H},rh:function(){return D},vf:function(){return k},z4:function(){return S}});var r=n(70655),a=n(56256),i=n(23031),l=n(96486),o=n(67294),s=n(83716),c=n(62761),u=n(92693),f=n(96162),d=n(78666),p=n(61105),g=n(52011),m=n(55726),h=n(93895),E=n(96840),v=n(87078),w=n(75838),y=function(e,t){var n=(0,i.t)("label."+d.Pm[e]);return t===d.Rw.ADD?(0,i.t)("label.add-workflow-ingestion",{workflow:n}):(0,i.t)("label.edit-workflow-ingestion",{workflow:n})},b=function(e){switch(e){case m.Hz.DataInsight:return(0,E.si)(f.CZ.OPEN_METADATA,f.lx.DATA_INSIGHT);case m.Hz.ElasticSearchReindex:default:return(0,E.Ec)(f.CZ.OPEN_METADATA,f.lx.SEARCH,g.i.SCHEDULE)}},D=function(e,t,n,r,a,i){var o=[];return e?o.push({name:(0,l.startCase)(t),url:b(t),activeTitle:!0}):o.push.apply(o,[{name:(0,l.startCase)(n),url:(0,E.si)(f.CZ.SERVICES,(0,w.tJ)(n))},{name:(null==i?void 0:i.name)||"",url:(0,c.LE)(r,n,"ingestions"),imgSrc:v.Z.getServiceTypeLogo((null==i?void 0:i.serviceType)||""),activeTitle:!0}]),o.push({name:y(t,a),url:"",activeTitle:!0}),o},C=function(e){var t,n=[],r=null===(t=null==e?void 0:e.connection)||void 0===t?void 0:t.config;return r?(r.supportsMetadataExtraction&&n.push(m.Hz.Metadata),r.supportsUsageExtraction&&n.push(m.Hz.Usage),r.supportsLineageExtraction&&n.push(m.Hz.Lineage),r.supportsProfiler&&n.push(m.Hz.Profiler),r.supportsDBTExtraction&&n.push(m.Hz.Dbt),r.supportsDataInsightExtraction&&n.push(m.Hz.DataInsight),r.supportsElasticSearchReindexingExtraction&&n.push(m.Hz.ElasticSearchReindex)):n=[m.Hz.Metadata,m.Hz.Usage,m.Hz.Lineage,m.Hz.Profiler,m.Hz.Dbt],n},H=function(e,t,n,a){var i=(0,l.isUndefined)(a)?e:[a];return t||n.length>0?i.reduce((function(e,t){return t===m.Hz.Usage&&n.find((function(e){return e.pipelineType===t}))?e:(0,r.ev)((0,r.ev)([],(0,r.CR)(e)),[t])}),[]):[m.Hz.Metadata,m.Hz.Usage,m.Hz.Lineage,m.Hz.Profiler,m.Hz.Dbt]},S=function(e,t,n){return e&&0===t?o.createElement(s.Z,{className:"p-y-lg",type:p.Wx.CUSTOM},function(e){switch(e){case m.Hz.DataInsight:return o.createElement(o.Fragment,null,o.createElement(a.Z.Paragraph,{className:"w-max-500"},o.createElement(h.u1,{i18nKey:"message.data-insight-pipeline-description",renderElement:o.createElement("a",{href:u.RK,rel:"noreferrer",style:{color:"#1890ff"},target:"_blank"}),values:{link:(0,i.t)("label.data-insight-ingestion")}})));case m.Hz.ElasticSearchReindex:return o.createElement(o.Fragment,null,o.createElement(a.Z.Paragraph,{className:"w-max-500"},o.createElement(h.u1,{i18nKey:"message.elastic-search-re-index-pipeline-description",renderElement:o.createElement("a",{href:u.Db,rel:"noreferrer",style:{color:"#1890ff"},target:"_blank"}),values:{link:(0,i.t)("label.search-index-ingestion")}})));default:return o.createElement(a.Z.Paragraph,{className:"w-max-500"},o.createElement(h.u1,{i18nKey:"message.no-ingestion-description",renderElement:o.createElement("a",{href:u.tf,rel:"noreferrer",style:{color:"#1890ff"},target:"_blank"}),values:{link:(0,i.t)("label.metadata-ingestion")}}))}}(n)):null},k=function(e,t){return e.map((function(e){var n;return(n={label:(0,i.t)("label.add-workflow-ingestion",{workflow:(0,i.t)("label."+d.Pm[e])}),key:e,disabled:e===m.Hz.DataInsight&&t})["data-testid"]="list-item",n}))},z=function(e,t){return e?(0,i.t)("label.add-entity",{entity:(0,i.t)("label.ingestion-lowercase")}):t===m.Hz.ElasticSearchReindex?(0,i.t)("label.deploy"):(0,i.t)("label.add-workflow-ingestion",{workflow:(0,l.startCase)(t||(0,i.t)("label."+m.Hz.Metadata))})}}}]);