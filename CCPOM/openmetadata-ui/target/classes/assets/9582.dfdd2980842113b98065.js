"use strict";(self.webpackChunkopen_metadata=self.webpackChunkopen_metadata||[]).push([[9582],{9582:function(e,t,n){n.r(t),n.d(t,{default:function(){return U}});var r=n(70655),a=n(67294),l=n(80646),u=n(62761),s=n(18460),c=n(46321),i=n(71230),o=n(15746),d=n(56256),m=n(71577),f=n(34041),E=n(68432),v=n(15137),p=n(9700),h=n(57599),C=n(88816),g=n(8752),N=n(79839),y=n(19586),w=n(96486),b=n(97638),k=n(72972),Z=function(e){var t=e.loading,n=e.children;return t?a.createElement("div",{className:"m-b-md p-md"},a.createElement(y.Z,{active:!0,paragraph:{rows:0}}),a.createElement(i.Z,{gutter:32,justify:"space-between"},a.createElement(o.Z,{span:24},a.createElement(k.Z,null)),a.createElement(o.Z,{className:"m-t-md",span:24},a.createElement(k.Z,null)),a.createElement(o.Z,{className:"m-t-md",span:24},(0,b.kK)().map((function(){return a.createElement(k.Z,{className:"p-xs",key:(0,w.uniqueId)()})}))))):n},D=n(72819),R=n(24671),_=n(59291),A=n(39570),K=n(96840),I=function(e){var t=e.knowledgeCenters,n=(0,E.$)().t,l=(0,g.BL)().permissions,s=(0,v.UO)().fqn,c=s?decodeURIComponent(s):null,y=(0,v.k6)(),w=(0,a.useMemo)((function(){return(0,A.P_)(D.OX.Create,N.A.KNOWLEDGE_CENTER,l)}),[l]),b=(0,a.useMemo)((function(){return c?_.Z.split(c)[0]:t[0].fullyQualifiedName}),[c]),k=(0,a.useMemo)((function(){return t.reduce((function(e,t){var n;return(0,r.ev)((0,r.ev)([],(0,r.CR)(e)),[{key:null!==(n=t.fullyQualifiedName)&&void 0!==n?n:"",label:(0,R.C_)(t),icon:a.createElement(p.ReactComponent,{height:16,width:16})}])}),[])}),[t]),I=(0,a.useMemo)((function(){return t.reduce((function(e,t){var n;return(0,r.ev)((0,r.ev)([],(0,r.CR)(e)),[{value:null!==(n=t.fullyQualifiedName)&&void 0!==n?n:"",label:(0,R.C_)(t)}])}),[])}),[t]);return a.createElement(C.Z,{id:"knowledgeCenter"},a.createElement(Z,{loading:0===t.length},a.createElement(i.Z,{className:"p-y-xs",gutter:[0,16]},a.createElement(o.Z,{className:"p-x-sm",span:24},a.createElement(d.Z.Text,{strong:!0,className:"m-b-0"},n("label.knowledge-center"))),w&&a.createElement(o.Z,{className:"p-x-sm",span:24},a.createElement(m.Z,{block:!0,className:"text-primary","data-testid":"add-knowledgeCenter",onClick:function(){y.push(u.dt.ADD_KNOWLEDGE_CENTER)}},a.createElement("div",{className:"flex-center"},a.createElement(h.ReactComponent,{className:"anticon m-r-xss"}),n("label.add")))),a.createElement(o.Z,{span:24},k.length?a.createElement(a.Fragment,null,a.createElement(f.Z,{showSearch:!0,options:I,style:{width:"100%",padding:5},onChange:function(e){console.log(e),y.push((0,K.Ky)(e))},defaultValue:b})):a.createElement("p",{className:"text-grey-muted text-center"},a.createElement("span",null,n("label.no-knowledge-center-found")))))))},O=n(34901),S=n(83716),T=n(49657),G=n(69523),V=n(73213),W=n(92693),L=n(61105),x=function(e){var t=e.isDoc,n=e.headerVisible,l=void 0===n||n,i=(0,E.$)().t,o=(0,g.BL)().permissions,d=(0,v.UO)().fqn,m=t&&decodeURIComponent(d)?decodeURIComponent(d):_.Z.split(decodeURIComponent(d))[0],f=(0,v.k6)(),p=(0,r.CR)((0,a.useState)([]),2),h=p[0],C=p[1],y=(0,r.CR)((0,a.useState)(!0),2),w=y[0],b=y[1],k=(0,r.CR)((0,a.useState)(L.Vu.INITIAL),2),Z=k[0],R=k[1],I=(0,r.CR)((0,a.useState)(),2),x=I[0],M=I[1],U=(0,r.CR)((0,a.useState)(!0),2),Q=U[0],P=U[1],B=(0,r.CR)((0,a.useState)(),2),J=B[0],X=B[1],q=(0,a.useMemo)((function(){return P(!0),M(void 0),!m||1===_.Z.split(m).length}),[m]),F=(0,a.useMemo)((function(){return(0,A.P_)(D.OX.Create,q?N.A.KNOWLEDGE_CENTER:N.A.KNOWLEDGE_CENTER_DOCUMENT,o)}),[o,q]),j=(0,a.useMemo)((function(){return(0,A.P_)(D.OX.ViewBasic,q?N.A.KNOWLEDGE_CENTER:N.A.KNOWLEDGE_CENTER_DOCUMENT,o)}),[o,q]),$=(0,a.useMemo)((function(){return(0,A.P_)(D.OX.ViewAll,q?N.A.KNOWLEDGE_CENTER:N.A.KNOWLEDGE_CENTER_DOCUMENT,o)}),[o,q]),z=function(){return(0,r.mG)(void 0,void 0,void 0,(function(){var e,t;return(0,r.Jh)(this,(function(n){switch(n.label){case 0:P(!0),b(!0),n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,(0,s.Bu)({fields:"owner,tags,reviewers,votes,domain",limit:u.SF})];case 2:return e=n.sent().data,C(e),[3,5];case 3:return t=n.sent(),(0,c.Eo)(t),[3,5];case 4:return b(!1),P(!1),[7];case 5:return[2]}}))}))};(0,a.useEffect)((function(){z()}),[]);var H=function(){return(0,r.mG)(void 0,void 0,void 0,(function(){var e,t;return(0,r.Jh)(this,(function(n){switch(n.label){case 0:P(!0),n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,(0,s._r)(m,"relatedDocuments,reviewers,tags,owner,children,votes,domain")];case 2:return e=n.sent(),M(e),[3,5];case 3:return t=n.sent(),(0,c.Eo)(t),[3,5];case 4:return P(!1),[7];case 5:return[2]}}))}))};(0,a.useEffect)((function(){P(!0),h.length&&(q?(M(h.find((function(e){return e.fullyQualifiedName===m}))||h[0]),!m&&h[0].fullyQualifiedName&&f.replace((0,K.Ky)(h[0].fullyQualifiedName)),P(!1)):H())}),[q,m,h]);var Y=(0,a.useCallback)((function(e){X(e)}),[]);return w?a.createElement(G.Z,null):j||$?0!==h.length||w?a.createElement(a.Fragment,null,Q?a.createElement(G.Z,null):a.createElement(T.Z,{deleteStatus:Z,isKnowledgeCenterActive:q,isSummaryPanelOpen:Boolean(J),isVersionsView:!1,refreshActiveKnowledgeCenterDocument:H,selectedData:x,updateKnowledgeCenter:function(e){return(0,r.mG)(void 0,void 0,void 0,(function(){var t,n,a;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:t=(0,O.qu)(x,e),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,(0,s.QD)(null==x?void 0:x.id,t)];case 2:return n=r.sent(),C((function(e){return e.map((function(e){return e.name===n.name?n:e}))})),(null==x?void 0:x.name)!==e.name&&(f.push((0,K.Ky)(n.fullyQualifiedName)),z()),[3,4];case 3:return a=r.sent(),(0,c.Eo)(a),[3,4];case 4:return[2]}}))}))},updateVote:function(e){return(0,r.mG)(void 0,void 0,void 0,(function(){var t,n,a;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),_.Z.split(null==x?void 0:x.fullyQualifiedName).length<=1?[4,(0,s.mu)(null!==(n=null==x?void 0:x.id)&&void 0!==n?n:"",e)]:[3,2];case 1:return r.sent(),z(),[3,4];case 2:return[4,(0,s.cl)(null!==(a=null==x?void 0:x.id)&&void 0!==a?a:"",e)];case 3:r.sent(),H(),r.label=4;case 4:return[3,6];case 5:return t=r.sent(),(0,c.Eo)(t),[3,6];case 6:return[2]}}))}))},onAssetClick:Y,onKnowledgeCenterDelete:function(e){R(L.Vu.WAITING),(0,s.k$)(e).then((function(){R(L.Vu.SUCCESS),(0,c.XA)(i("server.entity-deleted-successfully",{entity:i("label.knowledge-center")})),b(!0);var t=h.filter((function(t){return t.id!==e})),n=t.length>0?(0,K.Ky)(t[0].fullyQualifiedName):(0,K.Ky)();f.push(n),z()})).catch((function(e){(0,c.Eo)(e,i("server.delete-entity-error",{entity:i("label.knowledge-center")}))})).finally((function(){return R(L.Vu.INITIAL)}))},onKnowledgeCenterDocumentDelete:function(e){R(L.Vu.WAITING),(0,s.GV)(e).then((function(){var e;if(R(L.Vu.SUCCESS),(0,c.XA)(i("server.entity-deleted-successfully",{entity:i("label.knowledge-center-document")})),m){var t=_.Z.split(m);t.pop(),e=t.join(V.o)}b(!0),f.push((0,K.Ky)(e)),z()})).catch((function(e){(0,c.Eo)(e,i("server.delete-entity-error",{entity:i("label.knowledge-center-document")}))})).finally((function(){return R(L.Vu.INITIAL)}))},onKnowledgeCenterDocumentUpdate:function(e){return(0,r.mG)(void 0,void 0,void 0,(function(){var t,n,a;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:t=(0,O.qu)(x,e),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,(0,s.W9)(null==x?void 0:x.id,t)];case 2:if(!(n=r.sent()))throw i("server.entity-updating-error",{entity:i("label.knowledge-center-document")});return M(n),(null==x?void 0:x.name)!==e.name&&(f.push((0,K.Ky)(n.fullyQualifiedName)),z()),[3,4];case 3:return a=r.sent(),(0,c.Eo)(a),[3,4];case 4:return[2]}}))}))},headerVisible:l})):a.createElement(S.Z,{buttonId:"add-knowledgeCenter",className:"mt-0-important",doc:W.lj,heading:i("label.knowledge-center"),permission:F,type:F?L.Wx.CREATE:L.Wx.NO_DATA,onClick:function(){f.push(u.dt.ADD_KNOWLEDGE_CENTER)}}):a.createElement(S.Z,{type:L.Wx.PERMISSION})},M=n(23031),U=function(){var e=(0,r.CR)((0,a.useState)([]),2),t=e[0],n=e[1],d=(0,r.CR)((0,a.useState)(!1),2),m=d[0],f=d[1];return(0,a.useEffect)((function(){(0,r.mG)(void 0,void 0,void 0,(function(){var e,t,a;return(0,r.Jh)(this,(function(r){switch(r.label){case 0:e=!1,r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,(0,s.Bu)({fields:"owner,tags,reviewers,votes,domain",limit:u.SF})];case 2:return t=r.sent().data,n(t),e=t.length>0,[3,5];case 3:return a=r.sent(),(0,c.Eo)(a),[3,5];case 4:return e&&f(!0),[7];case 5:return[2]}}))}))}),[]),a.createElement(l.Z,{className:"knowledge-center-page-layout",pageTitle:(0,M.t)("label.knowledge-center"),leftPanelWidth:400,leftPanel:m&&a.createElement(a.Fragment,null,a.createElement(I,{knowledgeCenters:t}),a.createElement(o.Z,{span:24},a.createElement(x,{isDoc:!1,headerVisible:!1}))),rightPanelWidth:400},a.createElement(i.Z,{gutter:[0,8]},a.createElement(o.Z,{span:24},a.createElement(x,{isDoc:!0}))))}}}]);