"use strict";(self.webpackChunkopen_metadata=self.webpackChunkopen_metadata||[]).push([[1486],{80269:function(e,t,n){var i=n(8081),r=n.n(i),a=n(23645),o=n.n(a)()(r());o.push([e.id,'/*\n *  Copyright 2022 Collate.\n *  Licensed under the Apache License, Version 2.0 (the "License");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *  http://www.apache.org/licenses/LICENSE-2.0\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an "AS IS" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n.policies-list-container .ant-btn {\n  border-radius: 4px;\n}\n.policies-list-table .ant-table-row .ant-table-cell:first-child,\n.policies-list-table .ant-table-thead .ant-table-cell:first-child {\n  padding-left: 16px;\n}\n',""]),t.Z=o},81486:function(e,t,n){n.r(t),n.d(t,{default:function(){return B}});var i=n(70655),r=n(19650),a=n(94199),o=n(55241),l=n(60331),s=n(71577),c=n(71230),u=n(15746),d=n(96486),f=n(67294),m=n(68432),p=n(15137),h=n(76),v=n(8645),g=n(84065),y=n(8752),b=n(79839),E=n(78410),C=n(83716),w=n(34115),Z=n(24135),I=n(37565),k=n(52114),N=n(43104),S=n(62761),L=n(61105),x=n(64632),P=n(72819),_=n(802),A=n(80897),O=n(24671),D=n(39570),G=n(96840),J=n(46321),R=n(93379),T=n.n(R),Y=n(7795),z=n.n(Y),U=n(90569),j=n.n(U),q=n(3565),M=n.n(q),Q=n(19216),H=n.n(Q),K=n(44589),W=n.n(K),V=n(80269),$={};$.styleTagTransform=W(),$.setAttributes=M(),$.insert=j().bind(null,"head"),$.domAPI=z(),$.insertStyleElement=H(),T()(V.Z,$),V.Z&&V.Z.locals&&V.Z.locals;var B=function(){var e=(0,m.$)().t,t=(0,p.k6)(),n=(0,i.CR)((0,f.useState)(),2),R=n[0],T=n[1],Y=(0,i.CR)((0,f.useState)([]),2),z=Y[0],U=Y[1],j=(0,i.CR)((0,f.useState)(!0),2),q=j[0],M=j[1],Q=(0,_.C)(S.Ou),H=Q.currentPage,K=Q.handlePageChange,W=Q.paging,V=Q.handlePagingChange,$=Q.pageSize,B=Q.handlePageSizeChange,F=Q.showPagination,X=(0,y.BL)().permissions,ee=(0,f.useMemo)((function(){return!(0,d.isEmpty)(X)&&(0,D.P_)(P.OX.Create,b.A.POLICY,X)}),[X]),te=(0,f.useMemo)((function(){return!(0,d.isEmpty)(X)&&(0,D.P_)(P.OX.Delete,b.A.POLICY,X)}),[X]),ne=(0,f.useMemo)((function(){return!(0,d.isEmpty)(X)&&(null===D.NE||void 0===D.NE?void 0:D.NE.hasViewPermissions(b.A.ROLE,X))}),[X]),ie=(0,f.useMemo)((function(){return[{title:e("label.name"),dataIndex:"name",width:"200px",key:"name",render:function(e,t){return f.createElement(h.Link,{className:"link-hover","data-testid":"policy-name",to:t.fullyQualifiedName?(0,G.Hr)(encodeURIComponent(t.fullyQualifiedName)):""},(0,O.C_)(t))}},{title:e("label.description"),dataIndex:"description",key:"description",render:function(e,t){var n;return f.createElement(Z.Z,{markdown:null!==(n=null==t?void 0:t.description)&&void 0!==n?n:""})}},{title:e("label.role-plural"),dataIndex:"roles",width:"250px",key:"roles",render:function(e,t){var n,i,s,c=null!==(i=null===(n=t.roles)||void 0===n?void 0:n.length)&&void 0!==i?i:0,u=c>D.YD;return(null===(s=t.roles)||void 0===s?void 0:s.length)?f.createElement(r.Z,{wrap:!0,"data-testid":"role-link",size:4},t.roles.slice(0,D.YD).map((function(e){var t;return ne?f.createElement(h.Link,{key:(0,d.uniqueId)(),to:(0,G.Uy)(null!==(t=e.fullyQualifiedName)&&void 0!==t?t:"")},(0,O.C_)(e)):f.createElement(a.Z,{key:(0,d.uniqueId)(),title:k._D},(0,O.C_)(e))})),u&&f.createElement(o.Z,{className:"cursor-pointer",content:f.createElement(r.Z,{wrap:!0,size:4},t.roles.slice(D.YD).map((function(e){return ne?f.createElement(h.Link,{key:(0,d.uniqueId)(),to:(0,G.Uy)(e.fullyQualifiedName||"")},(0,O.C_)(e)):f.createElement(a.Z,{key:(0,d.uniqueId)(),title:k._D},(0,O.C_)(e))}))),overlayClassName:"w-40 text-center",trigger:"click"},f.createElement(l.Z,{className:"m-l-xss","data-testid":"plus-more-count"},"+"+(c-D.YD)+" more"))):"-- "}},{title:e("label.action-plural"),dataIndex:"actions",width:"80px",align:"center",key:"actions",render:function(t,n){return f.createElement(a.Z,{placement:"left",title:!te&&k.oH},f.createElement(s.Z,{"data-testid":"delete-action-"+(0,O.C_)(n),disabled:!te,icon:f.createElement(v.ReactComponent,{name:e("label.delete"),width:"16px"}),type:"text",onClick:function(){return T(n)}}))}}]}),[]),re=function(e){return(0,i.mG)(void 0,void 0,void 0,(function(){var t,n;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:M(!0),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,(0,A.Ko)("roles",null==e?void 0:e.after,null==e?void 0:e.before,$)];case 2:return t=i.sent(),U(t.data||[]),V(t.paging),[3,5];case 3:return n=i.sent(),(0,J.Eo)(n),[3,5];case 4:return M(!1),[7];case 5:return[2]}}))}))},ae=(0,f.useCallback)((function(){re()}),[re]),oe=function(){t.push(S.dt.ADD_POLICY)};return(0,f.useEffect)((function(){re()}),[$]),f.createElement(c.Z,{className:"policies-list-container","data-testid":"policies-list-container",gutter:[16,16]},f.createElement(u.Z,{span:24},f.createElement(r.Z,{className:"w-full justify-between"},f.createElement(g.Z,{data:N.j.POLICIES}),ee&&f.createElement(s.Z,{"data-testid":"add-policy",type:"primary",onClick:oe},e("label.add-entity",{entity:e("label.policy-v")})))),f.createElement(u.Z,{span:24},f.createElement(I.Z,{bordered:!0,className:"policies-list-table",columns:ie,"data-testid":"policies-list-table",dataSource:z,loading:q,locale:{emptyText:f.createElement(C.Z,{heading:e("label.policy"),permission:ee,type:L.Wx.CREATE,onClick:oe})},pagination:!1,rowKey:"id",size:"small"}),R&&te&&f.createElement(E.Z,{afterDeleteAction:ae,allowSoftDelete:!1,deleteMessage:e("message.are-you-sure-delete-entity",{entity:(0,O.C_)(R)}),entityId:R.id,entityName:(0,O.C_)(R),entityType:x.py.POLICY,visible:!(0,d.isUndefined)(R),onCancel:function(){return T(void 0)}})),f.createElement(u.Z,{span:24},F&&f.createElement(w.Z,{currentPage:H,pageSize:$,paging:W,pagingHandler:function(e){var t,n=e.currentPage,i=e.cursorType;K(n),i&&W&&re(((t={})[i]=W[i],t.total=null==W?void 0:W.total,t))},onShowSizeChange:B})))}},80897:function(e,t,n){n.d(t,{$j:function(){return m},F3:function(){return o},Ko:function(){return l},QW:function(){return h},_d:function(){return u},cN:function(){return p},dV:function(){return v},n5:function(){return s},sZ:function(){return f},u$:function(){return d},u7:function(){return c}});var i=n(70655),r=n(2598),a={headers:{"Content-type":"application/json-patch+json"}},o=function(e,t,n,a,o){return void 0===a&&(a=!1),void 0===o&&(o=10),(0,i.mG)(void 0,void 0,void 0,(function(){var l;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return l={default:a,limit:o,fields:e,after:t,before:n},[4,r.Z.get("/roles",{params:l})];case 1:return[2,i.sent().data]}}))}))},l=function(e,t,n,a){return void 0===a&&(a=10),(0,i.mG)(void 0,void 0,void 0,(function(){var o;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return o={limit:a,fields:e,after:t,before:n},[4,r.Z.get("/policies",{params:o})];case 1:return[2,i.sent().data]}}))}))},s=function(e,t){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return[4,r.Z.get("/roles/name/"+e,{params:{fields:t}})];case 1:return[2,n.sent().data]}}))}))},c=function(e,t){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return[4,r.Z.get("/policies/name/"+e,{params:{fields:t}})];case 1:return[2,n.sent().data]}}))}))},u=function(e){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,r.Z.post("/roles",e)];case 1:return[2,t.sent().data]}}))}))},d=function(e){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,r.Z.post("/policies",e)];case 1:return[2,t.sent().data]}}))}))},f=function(e,t){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return[4,r.Z.patch("/roles/"+t,e,a)];case 1:return[2,n.sent().data]}}))}))},m=function(e,t){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return[4,r.Z.patch("/policies/"+t,e,a)];case 1:return[2,n.sent().data]}}))}))},p=function(){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(e){switch(e.label){case 0:return[4,r.Z.get("/policies/resources")];case 1:return[2,e.sent().data]}}))}))},h=function(){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(e){switch(e.label){case 0:return[4,r.Z.get("/policies/functions")];case 1:return[2,e.sent().data]}}))}))},v=function(e){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,r.Z.get("/policies/validation/condition/"+e)];case 1:return[2,t.sent()]}}))}))}}}]);