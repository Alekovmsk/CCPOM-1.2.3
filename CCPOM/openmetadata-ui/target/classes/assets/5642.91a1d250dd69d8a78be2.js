"use strict";(self.webpackChunkopen_metadata=self.webpackChunkopen_metadata||[]).push([[5642,2723],{92723:function(e,t,n){n.r(t),n.d(t,{ReactComponent:function(){return s}});var a,i=n(67294);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},l.apply(this,arguments)}var s=function(e){return i.createElement("svg",l({viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",role:"img"},e),a||(a=i.createElement("path",{d:"m2 8.23 3.712 4.244L14 3",stroke:"#292929",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})))};t.default="data:image/svg+xml;base64,PHN2ZyAgdmlld0JveD0iMCAwIDE2IDE2IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMiA4LjIzMDZMNS43MTIxNSAxMi40NzM3TDE0IDMiIHN0cm9rZT0iIzI5MjkyOSIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4KPC9zdmc+"},47020:function(e,t,n){var a=n(8081),i=n.n(a),l=n(23645),s=n.n(l)()(i());s.push([e.id,'/*\n *  Copyright 2023 Collate.\n *  Licensed under the Apache License, Version 2.0 (the "License");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *  http://www.apache.org/licenses/LICENSE-2.0\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an "AS IS" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n/*\n *  Copyright 2022 Collate.\n *  Licensed under the Apache License, Version 2.0 (the "License");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *  http://www.apache.org/licenses/LICENSE-2.0\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an "AS IS" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n/* navbar+tab_height+padding = 64+46+12  */\n.feed-explore-heading {\n  background-color: #f8f8f8;\n}\n.activity-feed-tab {\n  display: flex;\n}\n.activity-feed-tab .custom-menu.ant-menu-root.ant-menu-inline .ant-menu-item {\n  height: 40px;\n}\n.activity-feed-tab .center-container {\n  flex: 0 0 calc(50% - 230px / 2);\n  height: calc(100vh - 236px);\n  overflow-y: scroll;\n}\n.activity-feed-tab .right-container {\n  flex: 0 0 calc(50% - 230px / 2);\n  border-left: 1px solid #0000001a;\n  height: calc(100vh - 236px);\n  overflow-y: scroll;\n}\n.activity-feed-tab .left-container {\n  flex: 0 0 230px;\n  border-right: 1px solid #0000001a !important;\n}\n.activity-feed-task {\n  background-color: #f8f8f8;\n}\n',""]),t.Z=s},88239:function(e,t,n){var a=n(8081),i=n.n(a),l=n(23645),s=n.n(l)()(i());s.push([e.id,'/*\n *  Copyright 2023 Collate.\n *  Licensed under the Apache License, Version 2.0 (the "License");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *  http://www.apache.org/licenses/LICENSE-2.0\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an "AS IS" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n.assignees-edit-input .ant-space-item:first-child {\n  width: 100%;\n}\n',""]),t.Z=s},71068:function(e,t,n){var a=n(8081),i=n.n(a),l=n(23645),s=n.n(l)()(i());s.push([e.id,'/*\n *  Copyright 2022 Collate.\n *  Licensed under the Apache License, Version 2.0 (the "License");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *  http://www.apache.org/licenses/LICENSE-2.0\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an "AS IS" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n.assignee-tag {\n  display: flex;\n  align-items: center;\n  padding: 2px 3px;\n  margin: 1px 2px;\n}\n.assignee-item .profile-image {\n  vertical-align: middle;\n}\n',""]),t.Z=s},75642:function(e,t,n){n.d(t,{K:function(){return Fe}});var a=n(70655),i=n(56256),l=n(94184),s=n.n(l),r=n(96486),o=n(67294),d=n(68432),c=n(15137),u=n(92723),m=n(56729),p=n(20615),f=n(64632),v=n(14469),g=n(31615),E=n(85087),h=n(20231),y=n(76373),b=n(93895),x=n(24671),N=n(95137),T=n(69523),k=n(57254),C=n(16165),Z=n(49409),w=n(71577),A=n(19650),S=n(94199),I=n(13013),L=n(71230),R=n(15746),F=n(50963),O=n(83663),q=n(34901),D=n(76),U=n(38780),M=n(35275),V=n(73233),B=n(63875),P=n(29228),J=n(33994),W=n(77863),z=n(24053),j=n(45102),H=n(62761),K=n(58369),_=n(59583),G=n(25131),Y=n(18927),$=n(86385),Q=n(89103),X=n(36190),ee=function(e){var t,n,a,l,s,c=e.taskThread,u=e.isTaskActionEdit,m=e.hasEditAccess,p=e.onChange,f=c.task,v=(0,d.$)().t,E=(0,r.isEqual)(null==f?void 0:f.type,g.UA.RequestDescription),h=(0,r.isEqual)(null==f?void 0:f.type,g.UA.UpdateDescription),y=(0,r.isEqual)(null==f?void 0:f.status,g.aq.Closed),b=function(){var e=null==f?void 0:f.suggestion,t=null==f?void 0:f.oldValue,n=(0,$.up)(t||"",e||"");return e||t?o.createElement(X.E,{className:"p-xs",diffArr:n}):o.createElement(i.Z.Text,{className:"text-grey-muted p-xs"},v("label.no-entity",{entity:v("label.suggestion")}))};return o.createElement("div",{"data-testid":"task-description-tabs"},o.createElement(o.Fragment,null,y?(l=null==f?void 0:f.oldValue,s=null==f?void 0:f.newValue,l||s?o.createElement(X.E,{className:"border border-main p-xs rounded-4 m-y-xss m-b-sm",diffArr:(0,$.up)(null!=l?l:"",null!=s?s:"")}):o.createElement("div",{className:"border border-main p-xs rounded-4 m-y-xss m-b-sm"},o.createElement(i.Z.Text,{className:"text-grey-muted"},v("label.no-entity",{entity:v("label.description")})))):o.createElement("div",{"data-testid":"description-task"},E&&o.createElement("div",{"data-testid":"request-description"},u&&m?o.createElement(Y.Z,{height:"208px",initialValue:null!==(t=null==f?void 0:f.suggestion)&&void 0!==t?t:"",placeHolder:v("label.add-entity",{entity:v("label.description")}),style:{marginTop:"0px"},onTextChange:p}):o.createElement("div",{className:"d-flex border border-main rounded-4 m-b-md"},b())),h&&o.createElement("div",{"data-testid":"update-description"},u&&m?o.createElement(Q.Z,{suggestion:null!==(n=null==f?void 0:f.suggestion)&&void 0!==n?n:"",value:null!==(a=null==f?void 0:f.oldValue)&&void 0!==a?a:"",onChange:p}):o.createElement("div",{className:"d-flex border border-main rounded-4 m-b-md"},b())))))},te=n(59295),ne=n(39379),ae=n(40501),ie=n(58666),le=function(e){var t=e.isTaskActionEdit,n=e.hasEditAccess,a=e.task,l=e.onChange,s=(0,d.$)().t,r=a||{},c=r.oldValue,u=r.newValue,m=r.suggestion,p=(null==a?void 0:a.type)===g.UA.RequestTag,f=(null==a?void 0:a.type)===g.UA.UpdateTag,v=(null==a?void 0:a.status)===g.aq.Closed,E=(0,o.useMemo)((function(){return c||u?o.createElement(ne._,{diffArr:(0,te.Bm)(JSON.parse(null!=c?c:"[]"),JSON.parse(null!=u?u:"[]"))}):o.createElement("div",null,o.createElement(i.Z.Text,{className:"text-grey-muted border border-main p-sm rounded-4 m-y-xss m-b-xs"},s("label.no-entity",{entity:s("label.tag-plural")})))}),[c,u]),h=(0,o.useMemo)((function(){return m||c?o.createElement(ne._,{diffArr:(0,te.Bm)(JSON.parse(null!=c?c:"[]"),JSON.parse(null!=m?m:"[]"))}):o.createElement(i.Z.Text,{className:"text-grey-muted p-xs"},s("label.no-entity",{entity:s("label.suggestion")}))}),[m,c]);return o.createElement("div",{"data-testid":"task-tags-tabs"},o.createElement(o.Fragment,null,v?E:o.createElement("div",{"data-testid":"tags-task"},p&&o.createElement("div",{"data-testid":"request-tags"},t&&n?o.createElement(ie.Z,{value:JSON.parse(null!=m?m:"[]"),onChange:l}):h),f&&o.createElement("div",{"data-testid":"update-tags"},t&&n?o.createElement(ae.X,{tags:JSON.parse(null!=c?c:"[]"),value:JSON.parse(null!=m?m:"[]"),onChange:l}):h))))},se=n(59923),re=n(93744),oe=n(31982),de=n(38333),ce=n(46321),ue=n(2998),me=n(93379),pe=n.n(me),fe=n(7795),ve=n.n(fe),ge=n(90569),Ee=n.n(ge),he=n(3565),ye=n.n(he),be=n(19216),xe=n.n(be),Ne=n(44589),Te=n.n(Ne),ke=n(88239),Ce={};Ce.styleTagTransform=Te(),Ce.setAttributes=ye(),Ce.insert=Ee().bind(null,"head"),Ce.domAPI=ve(),Ce.insertStyleElement=xe(),pe()(ke.Z,Ce),ke.Z&&ke.Z.locals&&ke.Z.locals;var Ze=function(e){var t,n,l,u,m,p=e.taskThread,f=e.owner,v=e.entityType,h=e.isForFeedTab,T=(0,a._T)(e,["taskThread","owner","entityType","isForFeedTab"]),Y=(0,c.k6)(),Q=(0,a.CR)((0,F.useForm)(),1)[0],X=(0,N.Eu)().currentUser,te=Z.Z.useWatch("assignees",Q),ne=p.task,ae=null!==(t=(0,oe.ku)(p.about))&&void 0!==t?t:"",ie=!(0,r.isUndefined)(ae)&&!(0,r.isUndefined)(v),me=(0,d.$)().t,pe=(0,a.CR)(Z.Z.useForm(),1)[0],fe=(0,E.a)().isAdminUser,ve=(0,J.$J)(),ge=ve.postFeed,Ee=ve.setActiveThread,he=(0,a.CR)((0,o.useState)($.yA[0]),2),ye=he[0],be=he[1],xe=(0,r.isEqual)(null==ne?void 0:ne.status,g.aq.Closed),Ne=(0,a.CR)((0,o.useState)(!1),2),Te=Ne[0],ke=Ne[1],Ce=(0,a.CR)((0,o.useState)(""),2),Ze=Ce[0],we=Ce[1],Ae=(0,a.CR)((0,o.useState)(!1),2),Se=Ae[0],Ie=Ae[1],Le=(0,a.CR)((0,o.useState)([]),2),Re=Le[0],Fe=Le[1],Oe=(0,o.useMemo)((function(){var e;return null!==(e=null==ne?void 0:ne.assignees.map((function(e){return{label:(0,x.C_)(e),value:e.id||"",type:e.type}})))&&void 0!==e?e:[]}),[ne]),qe=(0,o.useMemo)((function(){var e,t,n=null!==(e=re.Z.getEntityField(p.about))&&void 0!==e?e:"",a=null!==(t=re.Z.getTableColumnName(p.about))&&void 0!==t?t:"";return a?n+"/"+a:n}),[p]),De=(0,r.isEqual)(null==f?void 0:f.id,null==X?void 0:X.id),Ue=(0,r.isEqual)(p.createdBy,null==X?void 0:X.name),Me=(0,o.useCallback)((function(e){var t;return Boolean(null===(t=null==X?void 0:X.teams)||void 0===t?void 0:t.find((function(t){return e===t.id})))}),[X]),Ve=null===(n=null==ne?void 0:ne.assignees)||void 0===n?void 0:n.some((function(e){return(0,r.isEqual)(e.id,null==X?void 0:X.id)})),Be=null===(l=null==ne?void 0:ne.assignees)||void 0===l?void 0:l.some((function(e){return"team"===e.type&&Me(e.id)})),Pe=(0,$.u_)(null==ne?void 0:ne.type),Je=(0,$.DG)(null==ne?void 0:ne.type),We=(null==ne?void 0:ne.type)===_.U.RequestApproval,ze=ie&&o.createElement(i.Z.Text,{className:"font-medium text-md","data-testid":"task-title"},o.createElement(w.Z,{className:"p-r-xss text-md font-medium",type:"link",onClick:function(){Y.push({pathname:(0,$.yv)(p)})}},"#"+(null==ne?void 0:ne.id)+" "),o.createElement(i.Z.Text,null,null==ne?void 0:ne.type),o.createElement("span",{className:"m-x-xss"},me("label.for-lowercase")),!h&&o.createElement(o.Fragment,null,o.createElement("span",{className:"p-r-xss"},v),o.createElement(ue.Z,{entityFQN:ae,entityType:v},o.createElement(D.Link,{className:"break-all p-r-xss","data-testid":"entitylink",to:(0,de.Ch)(v,ae),onClick:function(e){return e.stopPropagation()}},o.createElement(i.Z.Text,{className:"text-md font-medium text-color-inherit"}," ",(0,b.AY)(ae))))),(0,r.isEmpty)(qe)?null:o.createElement("span",{className:"break-all"},qe)),je=function(e){(null==ne?void 0:ne.id)&&(0,y.xJ)(K.bq.RESOLVE,(null==ne?void 0:ne.id)+"",e).then((function(){var e,t;(0,ce.XA)(me("server.task-resolved-successfully")),null===(e=T.onAfterClose)||void 0===e||e.call(T),We&&(null===(t=T.onUpdateEntityDetails)||void 0===t||t.call(T))})).catch((function(e){return(0,ce.Eo)(e)}))},He=function(){if(We||!(0,r.isEmpty)(null==ne?void 0:ne.suggestion))if(Je){var e={newValue:(null==ne?void 0:ne.suggestion)||"[]"};je(e)}else{var t=We?"approved":null==ne?void 0:ne.suggestion;je({newValue:t})}else(0,ce.Eo)(me("message.field-text-is-required",{fieldText:me(Je?"label.tag-plural":"label.description")}))},Ke=fe||Ve||De||Boolean(Be),_e=function(e){var t;e.key===se.B.EDIT?ke(!0):He(),be(null!==(t=$.yA.find((function(t){return t.key===e.key})))&&void 0!==t?t:$.yA[0])},Ge=function(){if(We||!(0,r.isEmpty)(Ze)){var e=We?"Rejected":Ze;(0,y.xJ)(K.bq.REJECT,(null==ne?void 0:ne.id)+"",{comment:e}).then((function(){var e,t;(0,ce.XA)(me("server.task-closed-successfully")),null===(e=T.onAfterClose)||void 0===e||e.call(T),We&&(null===(t=T.onUpdateEntityDetails)||void 0===t||t.call(T))})).catch((function(e){return(0,ce.Eo)(e)}))}else(0,ce.Eo)(me("server.task-closed-without-comment"))},Ye=(0,o.useMemo)((function(){var e=Ve||Boolean(Be);return o.createElement(A.Z,{className:"m-t-sm items-end w-full","data-testid":"task-cta-buttons",size:"small"},o.createElement(S.Z,{title:e?"":me("message.only-reviewers-can-approve-or-reject")},o.createElement(w.Z,{"data-testid":"reject-task",disabled:!e,onClick:Ge},me("label.reject"))),o.createElement(S.Z,{title:e?"":me("message.only-reviewers-can-approve-or-reject")},o.createElement(w.Z,{"data-testid":"approve-task",disabled:!e,type:"primary",onClick:He},me("label.approve"))))}),[ne,He,Ve,Be]),$e=(0,o.useMemo)((function(){var e;if(xe)return null;var t=null!==(e=null==ne?void 0:ne.type)&&void 0!==e?e:"";if(We)return Ye;var n=["RequestDescription","UpdateDescription"].includes(t)?null==ne?void 0:ne.suggestion:JSON.parse((null==ne?void 0:ne.suggestion)||"[]");return o.createElement(A.Z,{className:"m-t-sm items-end w-full","data-testid":"task-cta-buttons",size:"small"},(Ue||Ke)&&o.createElement(w.Z,{onClick:Ge},me("label.close")),Ke?o.createElement(o.Fragment,null,["RequestDescription","RequestTag"].includes(t)&&(0,r.isEmpty)(n)?o.createElement(w.Z,{type:"primary",onClick:function(){return _e({key:se.B.EDIT})}},me("label.add-suggestion")):o.createElement(I.Z.Button,{"data-testid":"edit-accept-task-dropdown",icon:o.createElement(k.Z,null),menu:{items:$.yA,selectable:!0,selectedKeys:[ye.key],onClick:_e},type:"primary",onClick:function(){return ye.key===se.B.EDIT?_e({key:ye.key}):He()}},ye.label)):o.createElement(o.Fragment,null))}),[ne,He,_e,ye,xe,We,Ue,Ye]),Qe=(0,o.useMemo)((function(){var e,t,n,a;return Pe?{description:null!==(t=null!==(e=null==ne?void 0:ne.suggestion)&&void 0!==e?e:null==ne?void 0:ne.oldValue)&&void 0!==t?t:""}:{updatedTags:JSON.parse(null!==(a=null!==(n=null==ne?void 0:ne.suggestion)&&void 0!==n?n:null==ne?void 0:ne.oldValue)&&void 0!==a?a:"[]")}}),[ne,Pe]);return(0,o.useEffect)((function(){Q.setFieldValue("assignees",Oe),Fe(Oe)}),[Oe]),o.createElement(L.Z,{className:"p-y-sm p-x-md","data-testid":"task-tab",gutter:[0,24]},o.createElement(R.Z,{className:"d-flex items-center",span:24},o.createElement(C.Z,{className:"m-r-xs",component:(null==ne?void 0:ne.status)===g.aq.Open?V.ReactComponent:M.ReactComponent,style:{fontSize:"18px"}}),ze),o.createElement(R.Z,{span:24},o.createElement("div",{className:s()("d-flex justify-between",{"flex-column":Se})},o.createElement("div",{className:s()("gap-2",{"flex-center":!Se})},Se?o.createElement(Z.Z,{form:Q,layout:"vertical",onFinish:function(){return(0,a.mG)(void 0,void 0,void 0,(function(){var e,t,n,i;return(0,a.Jh)(this,(function(l){switch(l.label){case 0:e=(0,a.pi)((0,a.pi)({},p),{task:(0,a.pi)((0,a.pi)({},p.task),{assignees:te.map((function(e){return{id:e.value,type:e.type}}))})}),l.label=1;case 1:return l.trys.push([1,3,,4]),t=(0,q.qu)(p,e),[4,(0,y.sN)(p.id,t)];case 2:return n=l.sent(),Ie(!1),Ee(n),[3,4];case 3:return i=l.sent(),(0,ce.Eo)(i),[3,4];case 4:return[2]}}))}))}},o.createElement(Z.Z.Item,{"data-testid":"assignees",label:me("label.assignee-plural")+":",name:"assignees",rules:[{required:!0,message:me("message.field-text-is-required",{fieldText:me("label.assignee-plural")})}]},o.createElement(j.Z,{className:"assignees-edit-input",direction:"horizontal",onCancel:function(){Ie(!1),Q.setFieldValue("assignees",Oe)},onSave:function(){return Q.submit()}},o.createElement(G.Z,{options:Re,value:te,onChange:function(e){return Q.setFieldValue("assignees",e)},onSearch:function(e){return(0,$.Od)(e,Fe)}})))):o.createElement(o.Fragment,null,o.createElement(i.Z.Text,{className:"text-grey-muted"},me("label.assignee-plural"),":"," "),o.createElement(W.Z,{assignees:null!==(u=null==ne?void 0:ne.assignees)&&void 0!==u?u:[],className:"d-flex gap-1",profilePicType:"circle",profileWidth:"24",showUserName:!1}),!Ue&&!Ke||xe?null:o.createElement(w.Z,{className:"flex-center p-0","data-testid":"edit-assignees",icon:o.createElement(U.ReactComponent,{color:H.MJ,width:"14px"}),size:"small",type:"text",onClick:function(){return Ie(!0)}}))),o.createElement("div",{className:s()("gap-2",{"flex-center":!Se})},o.createElement(i.Z.Text,{className:"text-grey-muted"},me("label.created-by"),":"," "),o.createElement(z.V,{hasPermission:!1,owner:{name:p.createdBy,type:"user",id:""},onUpdate:r.noop})))),o.createElement(R.Z,{span:24},Pe&&o.createElement(ee,{hasEditAccess:Ke,isTaskActionEdit:!1,taskThread:p,onChange:function(e){return pe.setFieldValue("description",e)}}),Je&&o.createElement(le,{hasEditAccess:Ke,isTaskActionEdit:!1,task:ne,onChange:function(e){return pe.setFieldValue("updatedTags",e)}}),o.createElement("div",{className:"m-l-lg"},null===(m=null==p?void 0:p.posts)||void 0===m?void 0:m.map((function(e){return o.createElement(B.Z,{isPost:!0,feed:p,hidePopover:!1,key:e.id,post:e})}))),(null==ne?void 0:ne.status)===g.aq.Open&&o.createElement(P.Z,{onSave:function(e){var t;ge(e,null!==(t=null==p?void 0:p.id)&&void 0!==t?t:"").catch((function(){}))},onTextChange:we}),$e),o.createElement(O.Z,{maskClosable:!0,closable:!1,closeIcon:null,open:Te,title:me("label.edit-entity",{entity:me("label.task-lowercase")})+" #"+(null==ne?void 0:ne.id)+" "+p.message,width:768,onCancel:function(){return ke(!1)},onOk:pe.submit},o.createElement(Z.Z,{form:pe,initialValues:Qe,layout:"vertical",onFinish:function(e){var t=e.description,n=e.updatedTags;if(Je){var a={newValue:JSON.stringify(n)||"[]"};je(a)}else je({newValue:t})}},Je?o.createElement(Z.Z.Item,{"data-testid":"tags-label",label:me("label.tag-plural"),name:"updatedTags",rules:[{required:!0,message:me("message.field-text-is-required",{fieldText:me("label.tag-plural")})}],trigger:"onChange"},o.createElement(le,{isTaskActionEdit:!0,hasEditAccess:Ke,task:ne,onChange:function(e){return pe.setFieldValue("updatedTags",e)}})):o.createElement(Z.Z.Item,{"data-testid":"tags-label",label:me("label.description"),name:"description",rules:[{required:!0,message:me("message.field-text-is-required",{fieldText:me("label.description")})}],trigger:"onTextChange"},o.createElement(ee,{isTaskActionEdit:!0,hasEditAccess:Ke,taskThread:p,onChange:function(e){return pe.setFieldValue("description",e)}})))))},we=(n(36919),n(32438)),Ae=n(16768),Se=n(92265),Ie=n(47020),Le={};Le.styleTagTransform=Te(),Le.setAttributes=ye(),Le.insert=Ee().bind(null,"head"),Le.domAPI=ve(),Le.insertStyleElement=xe(),pe()(Ie.Z,Le),Ie.Z&&Ie.Z.locals&&Ie.Z.locals;var Re=n(98542),Fe=function(e){var t,n=e.fqn,l=e.owner,b=e.columns,k=e.entityType,C=e.isForFeedTab,Z=void 0===C||C,w=e.onUpdateEntityDetails,A=((0,c.k6)(),(0,d.$)().t),S=(0,N.Eu)().currentUser,I=(0,a.CR)((0,h.p)((0,a.pi)((0,a.pi)({},p.a),{root:document.querySelector("#center-container"),rootMargin:"0px 0px 2px 0px"})),2),L=I[0],R=I[1],F=(0,c.UO)().subTab,O=void 0===F?Re.o.ALL:F,q=(0,E.a)().isAdminUser,D=(0,a.CR)((0,o.useState)("open"),2),U=D[0],M=D[1],V=(0,a.CR)((0,o.useState)(0),2),B=(V[0],V[1]),W=(0,a.CR)((0,o.useState)(0),2),z=(W[0],W[1]),j=(0,J.$J)(),H=j.postFeed,K=j.selectedThread,_=j.setActiveThread,G=j.entityThread,Y=j.getFeedData,$=j.loading,Q=j.userId,X=j.entityPaging,ee=(0,o.useMemo)((function(){return k===f.py.USER}),[k]),te=(0,o.useMemo)((function(){var e,t;return null===(t=null===(e=null==K?void 0:K.about)||void 0===e?void 0:e.split(x.LV))||void 0===t?void 0:t[1]}),[K]),ne=(0,o.useMemo)((function(){return O===Re.o.TASKS}),[O]),ae=(0,o.useMemo)((function(){return O===Re.o.ALL?A("message.no-activity-feed"):O===Re.o.MENTIONS?A("message.no-mentions"):A("message.no-tasks-assigned")}),[O]);(0,o.useEffect)((function(){n&&(ee?((0,y.XG)(void 0,void 0,g.Th.Task,q?void 0:v.D.OWNER,void 0,Q).then((function(e){if(!e)throw A("server.entity-feed-fetch-error");z(e.paging.total)})),(0,y.XG)(void 0,void 0,g.Th.Conversation,q?void 0:v.D.OWNER,void 0,Q).then((function(e){if(!e)throw A("server.entity-feed-fetch-error");B(e.paging.total)}))):((0,y.Kg)((0,x.ec)(k,n),g.Th.Conversation).then((function(e){if(!e)throw A("server.entity-feed-fetch-error");B(e.totalCount)})),(0,y.Kg)((0,x.ec)(k,n),g.Th.Task).then((function(e){if(!e)throw A("server.entity-feed-fetch-error");z(e.totalCount)}))))}),[n]);var ie=(0,o.useMemo)((function(){var e=(null==S?void 0:S.isAdmin)?v.D.ALL:v.D.OWNER_OR_FOLLOWS,t=ee?e:void 0;return{threadType:"tasks"===O?g.Th.Task:g.Th.Conversation,feedFilter:"mentions"===O?v.D.MENTIONS:t}}),[O,ee,S]),le=ie.feedFilter,se=ie.threadType,re=(0,o.useCallback)((function(e){Y(le,e,se,k,n)}),[se,le,k,n,Y]);(0,o.useEffect)((function(){n&&Y(le,void 0,se,k,n)}),[le,se,n]);var oe=(0,o.useCallback)((function(e){_(e)}),[_]);(0,o.useEffect)((function(){n&&R&&X.after&&!$&&re(X.after)}),[X,$,R,n]);var de=(0,o.useMemo)((function(){return $?o.createElement(T.Z,null):null}),[$]),ce=(0,o.useMemo)((function(){return ne?G.filter((function(e){var t,n;return"open"===U?(null===(t=e.task)||void 0===t?void 0:t.status)===g.aq.Open:(null===(n=e.task)||void 0===n?void 0:n.status)===g.aq.Closed}),[]):G}),[O,G,U]),ue=(0,a.CR)((0,o.useMemo)((function(){return ne?G.reduce((function(e,t){var n;return(null===(n=t.task)||void 0===n?void 0:n.status)===g.aq.Open?e[0]=e[0]+1:e[1]=e[1]+1,e}),[0,0]):[0,0]}),[G,O]),2),me=ue[0],pe=ue[1],fe=function(e){M(e)},ve=function(){re(),fe("close")};return o.createElement("div",{className:"activity-feed-tab"},o.createElement("div",{className:"center-container",id:"center-container"},ne&&o.createElement("div",{className:"d-flex gap-4 p-sm p-x-lg activity-feed-task"},o.createElement(i.Z.Text,{className:s()("cursor-pointer p-l-xss d-flex items-center",{"font-medium":"open"===U}),onClick:function(){fe("open"),_()}}," ",o.createElement(m.ReactComponent,{className:"m-r-xss",width:14})," ",me," ",A("label.open")),o.createElement(i.Z.Text,{className:s()("cursor-pointer d-flex items-center",{"font-medium":"close"===U}),onClick:function(){fe("close"),_()}}," ",o.createElement(u.ReactComponent,{className:"m-r-xss",width:14})," ",pe," ",A("label.closed"))),o.createElement(we.Z,{hidePopover:!0,activeFeedId:null==K?void 0:K.id,emptyPlaceholderText:ae,feedList:ce,isForFeedTab:Z,isLoading:!1,showThread:!1,tab:O,onFeedClick:oe}),de,o.createElement("div",{className:"w-full","data-testid":"observer-element",id:"observer-element",ref:L,style:{height:"2px"}})),o.createElement("div",{className:" right-container"},de,K&&!$&&(O!==Re.o.TASKS?o.createElement("div",{id:"feed-panel"},o.createElement("div",{className:"feed-explore-heading"},o.createElement(Se.Z,{hideCloseIcon:!0,className:"p-x-md",entityLink:K.about,threadType:null!==(t=null==K?void 0:K.type)&&void 0!==t?t:g.Th.Conversation,onCancel:r.noop})),o.createElement(Ae.Z,{isOpenInDrawer:!0,showThread:!0,feed:K,hidePopover:!1,isForFeedTab:Z}),o.createElement(P.Z,{className:"m-md",onSave:function(e){var t;H(e,null!==(t=null==K?void 0:K.id)&&void 0!==t?t:"").catch((function(){}))}})):o.createElement("div",{id:"task-panel"},k===f.py.TABLE?o.createElement(Ze,{columns:b,entityType:f.py.TABLE,isForFeedTab:Z,owner:l,taskThread:K,onAfterClose:ve,onUpdateEntityDetails:w}):o.createElement(Ze,{entityType:ee?te:k,isForFeedTab:Z,owner:l,taskThread:K,onAfterClose:ve,onUpdateEntityDetails:w})))))}},45102:function(e,t,n){var a=n(54549),i=n(79508),l=n(19650),s=n(71577),r=n(94184),o=n.n(r),d=n(67294);t.Z=function(e){var t=e.children,n=e.onCancel,r=e.onSave,c=e.direction,u=e.className;return d.createElement(l.Z,{className:o()(u,"w-full"),"data-testid":"inline-edit-container",direction:c},t,d.createElement(l.Z,{className:"w-full justify-end","data-testid":"buttons",size:4},d.createElement(s.Z,{"data-testid":"inline-cancel-btn",icon:d.createElement(a.Z,null),size:"small",type:"primary",onClick:n}),d.createElement(s.Z,{"data-testid":"inline-save-btn",icon:d.createElement(i.Z,null),size:"small",type:"primary",onClick:r})))}},25131:function(e,t,n){n.d(t,{Z:function(){return A}});var a=n(70655),i=n(19650),l=n(56256),s=n(34041),r=n(23031),o=n(96486),d=n(67294),c=n(43443),u=n(40773),m=n(37878),p=n(55546),f=n(93379),v=n.n(f),g=n(7795),E=n.n(g),h=n(90569),y=n.n(h),b=n(3565),x=n.n(b),N=n(19216),T=n.n(N),k=n(44589),C=n.n(k),Z=n(71068),w={};w.styleTagTransform=C(),w.setAttributes=x(),w.insert=y().bind(null,"head"),w.domAPI=E(),w.insertStyleElement=T(),v()(Z.Z,w),Z.Z&&Z.Z.locals&&Z.Z.locals;var A=function(e){var t=e.value,n=void 0===t?[]:t,f=e.onSearch,v=e.onChange,g=e.options,E=(0,d.useMemo)((function(){var e=(0,o.groupBy)(g,(function(e){return e.type})),t=[];return(0,o.isUndefined)(e.team)||t.push({type:"group",label:"Teams",value:p.jc.TEAM,options:e.team.map((function(e){return(0,a.pi)((0,a.pi)({},e),{label:d.createElement(i.Z,{"data-testid":"assignee-option",key:e.value},d.createElement(c.ReactComponent,{height:16,width:16}),d.createElement(l.Z.Text,null,e.label))})}))}),(0,o.isUndefined)(e.user)||t.push({type:"group",label:"Users",value:p.jc.USER,options:e.user.map((function(e){return(0,a.pi)((0,a.pi)({},e),{label:d.createElement("div",{"data-testid":"assignee-option-"+e.label},d.createElement(u.w,{className:"assignee-item",id:e.value,name:e.label,size:m.e.small}))})}))}),t}),[g]);return d.createElement(s.Z,{showSearch:!0,className:"ant-select-custom select-assignee","data-testid":"select-assignee",defaultActiveFirstOption:!1,filterOption:!1,mode:"multiple",notFoundContent:null,options:E,placeholder:(0,r.t)("label.select-to-search"),showArrow:!1,value:n.length?n:void 0,onChange:function(e,t){var n=t.map((function(e){return{label:e["data-label"],value:e.value,type:e.type}}));v(n)},onSearch:f})}},89103:function(e,t,n){n.d(t,{Z:function(){return m}});var a=n(70655),i=n(25499),l=n(96486),s=n(67294),r=n(68432),o=n(18927),d=n(24135),c=n(86385),u=n(36190),m=function(e){var t=e.value,n=void 0===t?"":t,m=e.suggestion,p=e.placeHolder,f=e.onChange,v=(0,r.$)().t,g=i.Z.TabPane,E=(0,a.CR)((0,s.useState)(n),1)[0],h=(0,a.CR)((0,s.useState)([]),2),y=h[0],b=h[1],x=(0,a.CR)((0,s.useState)("3"),2),N=x[0],T=x[1],k=(0,s.useRef)(),C=(0,s.useCallback)((function(e){var t;if(T(e),(0,l.isEqual)(e,"2")){var n=null===(t=k.current)||void 0===t?void 0:t.getEditorContent();if(n){var a=(0,c.up)(E,n);b(a)}}else b([])}),[k]);return s.createElement(i.Z,{activeKey:N,className:"ant-tabs-description","data-testid":"tabs",size:"small",type:"card",onChange:C},s.createElement(g,{"data-testid":"current-tab",key:"1",tab:"Current"},s.createElement("div",{className:"border border-main rounded-4 p-sm m-t-sm"},E.trim()?s.createElement(d.Z,{enableSeeMoreVariant:!1,markdown:E}):s.createElement("span",{className:"text-grey-muted"},v("label.no-entity",{entity:v("label.description")})))),s.createElement(g,{"data-testid":"diff-tab",key:"2",tab:"Diff"},s.createElement(u.E,{className:"border border-main rounded-4 p-sm m-t-sm",diffArr:y})),s.createElement(g,{"data-testid":"new-tab",key:"3",tab:"New"},s.createElement(o.Z,{className:"m-t-sm",height:"208px",initialValue:m,placeHolder:null!=p?p:v("label.update-description"),ref:k,onTextChange:f})))}},36190:function(e,t,n){n.d(t,{E:function(){return o}});var a=n(94184),i=n.n(a),l=n(96486),s=n(67294),r=n(68432),o=function(e){var t=e.diffArr,n=e.className,a=(0,r.$)().t,o=t.map((function(e){return e.added?s.createElement("ins",{className:"diff-added","data-testid":"diff-added",key:(0,l.uniqueId)()},e.value):e.removed?s.createElement("del",{"data-testid":"diff-removed",key:(0,l.uniqueId)(),style:{color:"grey",textDecoration:"line-through"}},e.value):s.createElement("span",{"data-testid":"diff-normal",key:(0,l.uniqueId)()},e.value)}));return s.createElement("div",{className:i()("w-full h-max-56 overflow-y-auto",n)},s.createElement("pre",{className:"whitespace-pre-wrap m-b-0","data-testid":"diff-container"},t.length?o:s.createElement("span",{className:"text-grey-muted","data-testid":"noDiff-placeholder"},a("label.no-diff-available"))))}},39379:function(e,t,n){n.d(t,{_:function(){return d}});var a=n(60331),i=n(94184),l=n.n(i),s=n(23031),r=n(96486),o=n(67294),d=function(e){var t=e.diffArr,n=e.className,i=t.map((function(e){return e.added?o.createElement("div",{className:"d-flex flex-wrap m-y-xs","data-testid":"diff-added",key:(0,r.uniqueId)()},e.value.map((function(e){return o.createElement(a.Z,{key:(0,r.uniqueId)(),style:{background:"rgba(0, 131, 118, 0.2)",color:"#008376"}},e.tagFQN)}))):e.removed?o.createElement("div",{className:"d-flex flex-wrap m-y-xs","data-testid":"diff-removed",key:(0,r.uniqueId)()},e.value.map((function(e){return o.createElement(a.Z,{key:(0,r.uniqueId)(),style:{color:"grey",textDecoration:"line-through"}},e.tagFQN)}))):o.createElement("div",{className:"d-flex flex-wrap m-y-xs","data-testid":"diff-normal",key:(0,r.uniqueId)()},e.value.length?e.value.map((function(e){return o.createElement(a.Z,{key:(0,r.uniqueId)()},e.tagFQN)})):o.createElement("div",{className:"text-grey-muted text-center","data-testid":"noDiff-placeholder"},(0,s.t)("label.no-diff-available")))}));return o.createElement("div",{className:l()("w-full",n),"data-testid":"diff-container"},i)}},40501:function(e,t,n){n.d(t,{X:function(){return m}});var a=n(70655),i=n(25499),l=n(60331),s=n(59295),r=n(96486),o=n(67294),d=n(59923),c=n(39379),u=n(58666),m=function(e){var t=e.tags,n=e.value,m=void 0===n?[]:n,p=e.onChange,f=(0,a.CR)((0,o.useState)([]),2),v=f[0],g=f[1],E=(0,a.CR)((0,o.useState)(d.G.NEW),2),h=E[0],y=E[1];return o.createElement(i.Z,{activeKey:h,size:"small",type:"card",onChange:function(e){y(e),e===d.G.DIFF?g((0,s.Bm)(t,m)):g([])}},o.createElement(i.Z.TabPane,{"data-testid":"current-tab",key:d.G.CURRENT,tab:"Current"},o.createElement("div",{className:"d-flex flex-wrap m-y-xs","data-testid":"tags"},t.map((function(e){return o.createElement(l.Z,{key:(0,r.uniqueId)()},e.tagFQN)})))),o.createElement(i.Z.TabPane,{"data-testid":"diff-tab",key:d.G.DIFF,tab:"Diff"},o.createElement(c._,{diffArr:v})),o.createElement(i.Z.TabPane,{"data-testid":"new-tab",key:d.G.NEW,tab:"New"},o.createElement("div",{className:"m-t-xs"},o.createElement(u.Z,{value:m,onChange:p}))))}}}]);