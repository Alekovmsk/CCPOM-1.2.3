"use strict";(self.webpackChunkopen_metadata=self.webpackChunkopen_metadata||[]).push([[8722],{82507:function(e,t,n){n.d(t,{m:function(){return D}});var a=n(70655),i=n(71230),r=n(15746),s=n(12028),l=n(56256),c=n(23031),u=n(96486),o=n(80129),d=n.n(o),p=n(67294),m=n(15137),f=n(62761),v=n(22653),h=n(34530),E=n(802),y=n(16909),g=n(17888),b=n(88679),A=n(40734),C=n(46321),S=n(83716),T=n(34115),w=n(59817),Z=n(37565),D=function(e){var t=e.isDatabaseDeleted,n=(0,m.UO)().fqn,o=(0,m.k6)(),D=(0,m.TH)(),R=(0,a.CR)((0,p.useState)([]),2),P=R[0],M=R[1],k=(0,a.CR)((0,p.useState)(!0),2),N=k[0],F=k[1],x=(0,a.CR)((0,p.useState)(!1),2),B=x[0],U=x[1],I=(0,p.useMemo)((function(){return(0,A.p2)(n)}),[n]),V=(0,p.useMemo)((function(){var e=D.search;return d().parse(e.startsWith("?")?e.substring(1):e).schema}),[D.search]),_=(0,E.C)(),J=_.currentPage,G=_.handlePageChange,H=_.pageSize,q=_.handlePageSizeChange,O=_.paging,z=_.handlePagingChange,Q=_.showPagination,K=(0,p.useCallback)((function(e){return(0,a.mG)(void 0,void 0,void 0,(function(){var t,n,i,r;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:if((0,u.isEmpty)(I))return[2];a.label=1;case 1:return a.trys.push([1,3,4,5]),F(!0),[4,(0,y.M_)({databaseName:I,limit:H,after:null==e?void 0:e.after,before:null==e?void 0:e.before,include:B?h.y.Deleted:h.y.NonDeleted,fields:["owner","usageSummary"]})];case 2:return t=a.sent(),n=t.data,i=t.paging,M(n),z(i),[3,5];case 3:return r=a.sent(),(0,C.Eo)(r),[3,5];case 4:return F(!1),[7];case 5:return[2]}}))}))}),[H,I,B]),L=function(e,t){return void 0===t&&(t=f.j2),(0,a.mG)(void 0,void 0,void 0,(function(){var i,r,s,l;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:F(!0),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,(0,g.w4)({query:"(name.keyword:*"+e+"*) OR (description.keyword:*"+e+"*)",pageNumber:t,pageSize:f.IV,queryFilter:{query:{bool:{must:[{term:{"database.fullyQualifiedName":n}}]}}},searchIndex:v.W.DATABASE_SCHEMA,includeDeleted:B,trackTotalHits:!0})];case 2:return i=a.sent(),r=i.hits.hits.map((function(e){return e._source})),s=i.hits.total.value,M(r),z({total:s}),[3,5];case 3:return l=a.sent(),(0,C.Eo)(l),[3,5];case 4:return F(!1),[7];case 5:return[2]}}))}))},W=(0,p.useCallback)((function(e){U(e),G(f.j2)}),[]),Y=(0,p.useCallback)((function(e){var t,n=e.currentPage,a=e.cursorType;V?L(V,n):a&&K(((t={})[a]=O[a],t)),G(n)}),[O,K,L,V]);return(0,p.useEffect)((function(){K()}),[n,H,B,t]),p.createElement(i.Z,{gutter:[16,16]},p.createElement(r.Z,{span:12},p.createElement(w.Z,{removeMargin:!0,placeholder:(0,c.t)("label.search-for-type",{type:(0,c.t)("label.schema")}),searchValue:V,typingInterval:500,onSearch:function(e){o.push({search:d().stringify({schema:(0,u.isEmpty)(e)?void 0:e})}),e?L(e):K()}})),p.createElement(r.Z,{className:"flex items-center justify-end",span:12},p.createElement(s.Z,{checked:B,"data-testid":"show-deleted",onClick:W}),p.createElement(l.Z.Text,{className:"m-l-xs"},(0,c.t)("label.deleted"))," "),p.createElement(r.Z,{span:24},p.createElement(Z.Z,{bordered:!0,columns:b.n,"data-testid":"database-databaseSchemas",dataSource:P,loading:N,locale:{emptyText:p.createElement(S.Z,{className:"m-y-md"})},pagination:!1,rowKey:"id",size:"small"})),p.createElement(r.Z,{span:24},Q&&p.createElement(T.Z,{currentPage:J,isNumberBased:Boolean(V),pageSize:H,paging:O,pagingHandler:Y,onShowSizeChange:q})))}},18722:function(e,t,n){n.r(t);var a=n(70655),i=n(71230),r=n(15746),s=n(19650),l=n(25499),c=n(34901),u=n(96486),o=n(67674),d=n(67294),p=n(68432),m=n(15137),f=n(52046),v=n(33994),h=n(75642),E=n(19521),y=n(3460),g=n(76597),b=n(113),A=n(83716),C=n(9600),S=n(82507),T=n(33873),w=n(69523),Z=n(80646),D=n(8752),R=n(79839),P=n(39136),M=n(67167),k=n(71406),N=n(1727),F=n(73213),x=n(62761),B=n(61105),U=n(64632),I=n(34530),V=n(90058),_=n(16909),J=n(76373),G=n(93895),H=n(24671),q=n(39570),O=n(40734),z=n(38333),Q=n(73553),K=n(46321);t.default=(0,o.Pi)((0,y.w)((function(){var e,t,n,o,y=(0,p.$)().t,L=(0,v.$J)(),W=L.postFeed,Y=L.deleteFeed,j=L.updateFeed,$=(0,D.BL)().getEntityPermissionByFqn,X=(0,m.UO)(),ee=X.fqn,te=X.tab,ne=void 0===te?U.M8.SCHEMA:te,ae=(0,a.CR)((0,d.useState)(!0),2),ie=ae[0],re=ae[1],se=(0,a.CR)((0,d.useState)({}),2),le=se[0],ce=se[1],ue=(0,a.CR)((0,d.useState)(),2),oe=ue[0],de=ue[1],pe=(0,a.CR)((0,d.useState)(null!==(e=ee.split(F.o).slice(-1).pop())&&void 0!==e?e:""),2),me=pe[0],fe=pe[1],ve=(0,a.CR)((0,d.useState)(!0),2),he=ve[0],Ee=ve[1],ye=(0,a.CR)((0,d.useState)(!1),2),ge=ye[0],be=ye[1],Ae=(0,a.CR)((0,d.useState)(""),2),Ce=Ae[0],Se=Ae[1],Te=(0,a.CR)((0,d.useState)(""),2),we=Te[0],Ze=Te[1],De=(0,a.CR)((0,d.useState)(0),2),Re=De[0],Pe=De[1],Me=(0,a.CR)((0,d.useState)(0),2),ke=Me[0],Ne=Me[1],Fe=(0,a.CR)((0,d.useState)([]),2),xe=Fe[0],Be=Fe[1],Ue=(0,a.CR)((0,d.useState)(""),2),Ie=Ue[0],Ve=Ue[1],_e=(0,a.CR)((0,d.useState)(!1),2),Je=_e[0],Ge=_e[1],He=(0,m.k6)(),qe=(0,d.useRef)(!0),Oe=(0,d.useMemo)((function(){return le}),[le]),ze=Oe.version,Qe=Oe.deleted,Ke=(0,z.Zk)(null!==(t=null==le?void 0:le.tags)&&void 0!==t?t:[]),Le=(0,z.nD)(null!==(n=null==le?void 0:le.tags)&&void 0!==n?n:[]),We=(0,a.CR)((0,d.useState)(q.Bd),2),Ye=We[0],je=We[1],$e=(0,d.useMemo)((function(){return(0,O.p2)(ee)}),[ee]),Xe=function(e){Ve(e)},et=function(){(0,J.Kg)((0,H.ec)(U.py.DATABASE,$e)).then((function(e){if(!e)throw y("server.unexpected-response");Ne(e.totalCount),Be(e.counts)})).catch((function(){}))},tt=(0,d.useCallback)((function(){return(0,a.mG)(void 0,void 0,void 0,(function(){var e,t;return(0,a.Jh)(this,(function(n){switch(n.label){case 0:if((0,u.isEmpty)(ee))return[2];n.label=1;case 1:return n.trys.push([1,3,4,5]),re(!0),[4,(0,_.M_)({databaseName:$e,limit:0})];case 2:return e=n.sent().paging,Pe(e.total),[3,5];case 3:return t=n.sent(),(0,K.Eo)(t),[3,5];case 4:return re(!1),[7];case 5:return[2]}}))}))}),[ee]),nt=function(){Ee(!0),(0,_.o6)(ee,["owner","tags","domain","votes"],I.y.All).then((function(e){if(e){var t=e.description,n=e.id,a=e.name,i=e.serviceType;ce(e),Se(null!=t?t:""),Ze(null!=n?n:""),fe(a),de(i)}})).catch((function(){})).finally((function(){re(!1),Ee(!1)}))},at=function(){be(!1)},it=function(e){var t=[];return le&&(t=(0,c.qu)(le,e)),(0,_.SI)(we,t)},rt=function(e){return(0,a.mG)(void 0,void 0,void 0,(function(){var t,n,i;return(0,a.Jh)(this,(function(r){switch(r.label){case 0:if(Ce===e||!le)return[3,6];t=(0,a.pi)((0,a.pi)({},le),{description:e}),r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,it(t)];case 2:if(!(n=r.sent()))throw y("server.unexpected-response");return ce(n),Se(e),et(),[3,5];case 3:return i=r.sent(),(0,K.Eo)(i),[3,5];case 4:return be(!1),[7];case 5:return[3,7];case 6:be(!1),r.label=7;case 7:return[2]}}))}))},st=function(){be(!0)},lt=function(e,t){return(0,a.mG)(void 0,void 0,void 0,(function(){var n,i;return(0,a.Jh)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,it(e)];case 1:return n=r.sent(),ce((function(){var e;return"tags"===t?(0,a.pi)((0,a.pi)({},n),{tags:(0,G.ch)(null!==(e=n.tags)&&void 0!==e?e:[])}):n})),et(),[3,3];case 2:return i=r.sent(),(0,K.Eo)(i,y("server.entity-updating-error",{entity:y("label.database")})),[3,3];case 3:return[2]}}))}))},ct=(0,d.useCallback)((function(e){return(0,a.mG)(void 0,void 0,void 0,(function(){var t;return(0,a.Jh)(this,(function(n){switch(n.label){case 0:return t=(0,a.pi)((0,a.pi)({},le),{owner:e?(0,a.pi)((0,a.pi)({},null==le?void 0:le.owner),e):void 0}),[4,lt(t)];case 1:return n.sent(),[2]}}))}))}),[le,null==le?void 0:le.owner,lt]);(0,d.useEffect)((function(){et()}),[]),(0,d.useEffect)((function(){!qe.current&&f.Z.inPageSearchText&&He.push((0,x.rg)({search:f.Z.inPageSearchText,extraParameters:{facetFilter:{serviceType:[oe],"database.name.keyword":[me]}}}))}),[f.Z.inPageSearchText]),(0,d.useEffect)((function(){(Ye.ViewAll||Ye.ViewBasic)&&(nt(),tt())}),[Ye,ee]),(0,d.useEffect)((function(){(0,a.mG)(void 0,void 0,void 0,(function(){var e;return(0,a.Jh)(this,(function(t){switch(t.label){case 0:re(!0),t.label=1;case 1:return t.trys.push([1,3,4,5]),[4,$(R.A.DATABASE,ee)];case 2:return e=t.sent(),je(e),[3,5];case 3:return t.sent(),[3,5];case 4:return re(!1),[7];case 5:return[2]}}))}))}),[ee]),(0,d.useEffect)((function(){qe.current=!1,f.Z.inPageSearchText=""}),[]);var ut=(0,d.useCallback)((function(e){var t,n=(0,Q.Jf)(null!==(t=null==le?void 0:le.tags)&&void 0!==t?t:[],e),i=(0,a.pi)((0,a.pi)({},le),{tags:n});return lt(i)}),[lt,le,Ke]),ot=function(e){return(0,a.mG)(void 0,void 0,void 0,(function(){var t,n;return(0,a.Jh)(this,(function(i){switch(i.label){case 0:return e?(t=(0,a.ev)((0,a.ev)([],(0,a.CR)(Ke?[Ke]:[])),(0,a.CR)(e)),n=(0,a.pi)((0,a.pi)({},le),{tags:t}),[4,lt(n,"tags")]):[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))},dt=function(e){return(0,a.mG)(void 0,void 0,void 0,(function(){var t,n;return(0,a.Jh)(this,(function(i){switch(i.label){case 0:return e?(t=(null==Le?void 0:Le.filter((function(t){return e.map((function(e){return e.tagFQN})).includes(null==t?void 0:t.tagFQN)})))||[],n=(0,Q.eY)(e.filter((function(e){return!(null==t?void 0:t.map((function(e){return e.tagFQN})).includes(e.tagFQN))}))),[4,ot((0,a.ev)((0,a.ev)([],(0,a.CR)(t)),(0,a.CR)(n)))]):[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))},pt=function(e){ce((function(t){return t?(0,a.pi)((0,a.pi)((0,a.pi)({},t),{deleted:!(null==t?void 0:t.deleted)}),e?{version:e}:{}):t}))},mt=(0,d.useCallback)((function(){return(0,a.mG)(void 0,void 0,void 0,(function(){var e,t;return(0,a.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,(0,_.W2)(we)];case 1:return e=n.sent().version,(0,K.XA)(y("message.restore-entities-success",{entity:y("label.database")}),2e3),pt(e),[3,3];case 2:return t=n.sent(),(0,K.Eo)(t,y("message.restore-entities-error",{entity:y("label.database")})),[3,3];case 3:return[2]}}))}))}),[we]),ft=(0,d.useCallback)((function(){ze&&He.push((0,x.dj)(U.py.DATABASE,ee,(0,u.toString)(ze),U.M8.SCHEMA))}),[ze,ee]),vt=(0,d.useMemo)((function(){return{editTagsPermission:(Ye.EditTags||Ye.EditAll)&&!le.deleted,editDescriptionPermission:(Ye.EditDescription||Ye.EditAll)&&!le.deleted,editCustomAttributePermission:(Ye.EditAll||Ye.EditCustomFields)&&!le.deleted,viewAllPermission:Ye.ViewAll}}),[Ye,le]),ht=vt.editTagsPermission,Et=vt.editDescriptionPermission,yt=vt.editCustomAttributePermission,gt=vt.viewAllPermission,bt=(0,d.useCallback)((function(e,t){return e?pt(t):He.push("/")}),[]),At=(0,d.useCallback)((function(e){var t=e;ce((function(e){return(0,a.pi)((0,a.pi)({},null!=e?e:t),{version:t.version})}))}),[]),Ct=(0,d.useMemo)((function(){var e,t;return[{label:d.createElement(M.Z,{count:Re,id:U.M8.SCHEMA,isActive:ne===U.M8.SCHEMA,name:y("label.schema-plural")}),key:U.M8.SCHEMA,children:d.createElement(i.Z,{gutter:[0,16],wrap:!1},d.createElement(r.Z,{className:"p-t-sm m-x-lg",flex:"auto"},d.createElement(i.Z,{gutter:[16,16]},d.createElement(r.Z,{"data-testid":"description-container",span:24},d.createElement(b.Z,{description:Ce,entityFqn:$e,entityName:(0,H.C_)(le),entityType:U.py.DATABASE,hasEditAccess:Et,isEdit:ge,showActions:!le.deleted,onCancel:at,onDescriptionEdit:st,onDescriptionUpdate:rt,onThreadLinkSelect:Xe})),d.createElement(r.Z,{span:24},d.createElement(S.m,{isDatabaseDeleted:Qe})))),d.createElement(r.Z,{className:"entity-tag-right-panel-container","data-testid":"entity-right-panel",flex:"320px"},d.createElement(s.Z,{className:"w-full",direction:"vertical",size:"large"},d.createElement(T.Z,{activeDomain:null==le?void 0:le.domain,dataProducts:null!==(e=null==le?void 0:le.dataProducts)&&void 0!==e?e:[],hasPermission:!1}),d.createElement(k.Z,{displayType:N.F.READ_MORE,entityFqn:$e,entityType:U.py.DATABASE,permission:ht,selectedTags:Le,tagType:V.c6.Classification,onSelectionChange:dt,onThreadLinkSelect:Xe}),d.createElement(k.Z,{displayType:N.F.READ_MORE,entityFqn:$e,entityType:U.py.DATABASE,permission:ht,selectedTags:Le,tagType:V.c6.Glossary,onSelectionChange:dt,onThreadLinkSelect:Xe}))))},{label:d.createElement(M.Z,{count:ke,id:U.M8.ACTIVITY_FEED,isActive:ne===U.M8.ACTIVITY_FEED,name:y("label.activity-feed-plural")}),key:U.M8.ACTIVITY_FEED,children:d.createElement(h.K,{entityType:U.py.DATABASE,fqn:null!==(t=null==le?void 0:le.fullyQualifiedName)&&void 0!==t?t:"",onFeedUpdate:et,onUpdateEntityDetails:nt})},{label:d.createElement(M.Z,{id:U.M8.CUSTOM_PROPERTIES,name:y("label.custom-property-plural")}),key:U.M8.CUSTOM_PROPERTIES,children:d.createElement(g.t,{entityType:U.py.DATABASE,handleExtensionUpdate:lt,hasEditAccess:yt,hasPermission:gt,isVersionView:!1})}]}),[Le,ge,le,Ce,me,xe,$e,ne,Ye,Re,ke,ht,Et,yt,gt,Qe]);return ie||he?d.createElement(w.Z,null):Ye.ViewAll||Ye.ViewBasic?d.createElement(Z.Z,{className:"bg-white",pageTitle:y("label.entity-detail-plural",{entity:(0,H.C_)(le)})},(0,u.isEmpty)(le)?d.createElement(A.Z,{className:"m-0"},(0,G.mW)(U.py.DATABASE,$e)):d.createElement(i.Z,{gutter:[0,12]},d.createElement(r.Z,{className:"p-x-lg",span:24},d.createElement(C.U$,{isRecursiveDelete:!0,afterDeleteAction:bt,afterDomainUpdateAction:At,dataAsset:le,entityType:U.py.DATABASE,permissions:Ye,onDisplayNameUpdate:function(e){return(0,a.mG)(void 0,void 0,void 0,(function(){var t;return(0,a.Jh)(this,(function(n){return(0,u.isUndefined)(le)?[2]:(t=(0,a.pi)((0,a.pi)({},le),{displayName:e.displayName}),[2,lt(t)])}))}))},onOwnerUpdate:ct,onProfilerSettingUpdate:function(){return Ge(!0)},onRestoreDataAsset:mt,onTierUpdate:ut,onUpdateVote:function(e,t){return(0,a.mG)(void 0,void 0,void 0,(function(){var n,i;return(0,a.Jh)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),[4,(0,_.X8)(t,e)];case 1:return a.sent(),[4,(0,_.o6)(ee,["owner","tags","votes"],I.y.All)];case 2:return n=a.sent(),ce(n),[3,4];case 3:return i=a.sent(),(0,K.Eo)(i),[3,4];case 4:return[2]}}))}))},onVersionClick:ft})),d.createElement(r.Z,{span:24},d.createElement(l.Z,{activeKey:null!=ne?ne:U.M8.SCHEMA,className:"entity-details-page-tabs","data-testid":"tabs",items:Ct,onChange:function(e){e!==ne&&He.push({pathname:(0,x.aY)($e,e)})}})),Ie?d.createElement(E.Z,{createThread:function(e){(0,J.Kl)(e).then((function(e){e?et():(0,K.Eo)(y("server.unexpected-response"))})).catch((function(e){(0,K.Eo)(e,y("server.create-entity-error",{entity:y("label.conversation-lowercase")}))}))},deletePostHandler:Y,open:Boolean(Ie),postFeedHandler:W,threadLink:Ie,updateThreadHandler:j,onCancel:function(){Ve("")}}):null,Je&&d.createElement(P.Z,{entityId:null!==(o=le.id)&&void 0!==o?o:"",entityType:U.py.DATABASE,visible:Je,onVisibilityChange:function(e){return Ge(e)}}))):d.createElement(A.Z,{type:B.Wx.PERMISSION})})))}}]);