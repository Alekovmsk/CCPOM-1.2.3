"use strict";(self.webpackChunkopen_metadata=self.webpackChunkopen_metadata||[]).push([[6771],{52011:function(e,t,n){var i;n.d(t,{i:function(){return i}}),function(e){e.ON_DEMAND="on_demand",e.LIVE="live",e.SCHEDULE="schedule"}(i||(i={}))},6771:function(e,t,n){n.r(t);var i=n(70655),r=n(96486),a=n(67294),l=n(68432),o=n(15137),s=n(7067),c=n(83716),u=n(79686),f=n(86879),d=n(26387),p=n(69523),g=n(62761),m=n(78666),h=n(31968),v=n(28517),E=n(5302),w=n(19894),y=n(97354),C=n(99166),S=n(93895),b=n(50156),H=n(75838),D=n(46321);t.default=function(){var e,t=(0,l.$)().t,n=(0,w.w)().fetchAirflowStatus,k=(0,o.UO)(),z=k.ingestionFQN,R=k.ingestionType,T=k.fqn,P=k.serviceCategory,x=(0,o.k6)(),I=(0,i.CR)((0,a.useState)(),2),N=I[0],L=I[1],A=(0,i.CR)((0,a.useState)({}),2),Z=A[0],U=A[1],M=(0,i.CR)((0,a.useState)(1),2),_=M[0],O=M[1],K=(0,i.CR)((0,a.useState)(!0),2),W=K[0],B=K[1],F=(0,i.CR)((0,a.useState)(""),2),G=F[0],Y=F[1],Q=(0,i.CR)((0,a.useState)(0),2),V=Q[0],$=Q[1],q=(0,i.CR)((0,a.useState)(!1),2),J=q[0],j=q[1],X=(0,i.CR)((0,a.useState)(!1),2),ee=X[0],te=X[1],ne=(0,i.CR)((0,a.useState)(v.g.UPDATING),2),ie=ne[0],re=ne[1],ae=(0,i.CR)((0,a.useState)(!1),2),le=ae[0],oe=ae[1],se=(0,i.CR)((0,a.useState)([]),2),ce=se[0],ue=se[1],fe=(0,i.CR)((0,a.useState)(""),2),de=fe[0],pe=fe[1],ge=(0,a.useMemo)((function(){return R===E.Hz.DataInsight||R===E.Hz.ElasticSearchReindex}),[R]),me=function(){return new Promise((function(e){j(!0),$(g.lB),re(v.g.DEPLOYING),(0,y.aw)(Z.id).then((function(){te(!0),oe(!1),$(g.$M),re(v.g.DEPLOYED)})).catch((function(e){oe(!0),re(v.g.DEPLOYING_ERROR),(0,D.Eo)(e,t("server.deploy-entity-error",{entity:t("label.ingestion-workflow")}))})).finally((function(){return e()}))}))},he=function(){x.push((0,g.LE)(T,P,"ingestions"))},ve=ge?function(){x.push((0,b.mK)(R))}:he;(0,a.useEffect)((function(){var e=(0,b.rh)(ge,R,P,T,m.Rw.EDIT,N);ue(e)}),[P,R,N,ge]);var Ee=a.createElement("div",{className:"max-width-md w-9/10 service-form-container"},a.createElement(d.Z,{titleLinks:ce}),a.createElement("div",{className:"m-t-md"},a.createElement(s.Z,{activeIngestionStep:_,data:Z,handleCancelClick:ve,handleViewServiceClick:ve,heading:(0,b.QB)(R,m.Rw.EDIT),ingestionAction:ie,ingestionProgress:V,isIngestionCreated:J,isIngestionDeployed:ee,pipelineType:R,serviceCategory:P,serviceData:N,setActiveIngestionStep:function(e){return O(e)},showDeployButton:le,status:h.Y.EDIT,onFocus:function(e){(0,r.isEmpty)(e)||setTimeout((function(){pe(e)}),50)},onIngestionDeploy:me,onSuccessSave:he,onUpdateIngestion:function(e){Z.deployed||$(g.aN);var n={airflowConfig:e.airflowConfig,description:e.description,displayName:e.displayName,loggerLevel:e.loggerLevel,name:e.name,owner:e.owner,pipelineType:e.pipelineType,service:e.service,sourceConfig:e.sourceConfig};return new Promise((function(e,i){return(0,y.tr)(n).then((function(n){if(!n)throw t("server.entity-updating-error",{entity:t("label.ingestion-workflow-lowercase")});me(),e()})).catch((function(e){(0,D.Eo)(e,t("server.entity-updating-error",{entity:t("label.ingestion-workflow-lowercase")})),i()}))}))}}))),we=a.createElement(f.Z,{isWorkflow:!0,activeField:de,serviceName:null!==(e=null==N?void 0:N.serviceType)&&void 0!==e?e:"",serviceType:(0,H.rP)(P),workflowType:R});return(0,a.useEffect)((function(){n().finally((function(){var e;e=[new Promise((function(e,n){(0,C.dO)(P,T).then((function(n){n?(L(n),e()):(0,D.Eo)(t("server.entity-fetch-error",{entity:t("label.service-detail-lowercase-plural")}))})).catch((function(e){var i;if(404===(null===(i=e.response)||void 0===i?void 0:i.status))Y((0,S.mW)(P,T));else{var r=t("server.entity-fetch-error",{entity:t("label.service-detail-lowercase-plural")});(0,D.Eo)(e,r),Y(r)}n()}))})),new Promise((function(e,n){(0,y.ne)(z,["pipelineStatuses"]).then((function(n){if(!n)throw t("server.unexpected-error");U(n),e()})).catch((function(e){var i;if(404===(null===(i=e.response)||void 0===i?void 0:i.status))Y((0,S.mW)("Ingestion",z));else{var r=t("server.entity-fetch-error",{entity:t("label.ingestion-workflow")});(0,D.Eo)(e,r),Y(r)}n()}))}))],Promise.allSettled(e).finally((function(){return B(!1)}))}))}),[P,T]),W?a.createElement(p.Z,null):G?a.createElement(c.Z,null,G):a.createElement(u.Z,{firstPanel:{children:Ee,minWidth:700,flex:.7},pageTitle:t("label.edit-entity",{entity:t("label.ingestion")}),secondPanel:{children:we,className:"service-doc-panel",minWidth:60,overlay:{displayThreshold:200,header:t("label.setup-guide"),rotation:"counter-clockwise"}}})}},50156:function(e,t,n){n.d(t,{Hl:function(){return z},Kz:function(){return b},QB:function(){return y},mK:function(){return C},nH:function(){return H},rh:function(){return S},vf:function(){return k},z4:function(){return D}});var i=n(70655),r=n(56256),a=n(23031),l=n(96486),o=n(67294),s=n(83716),c=n(62761),u=n(92693),f=n(96162),d=n(78666),p=n(61105),g=n(52011),m=n(55726),h=n(93895),v=n(96840),E=n(87078),w=n(75838),y=function(e,t){var n=(0,a.t)("label."+d.Pm[e]);return t===d.Rw.ADD?(0,a.t)("label.add-workflow-ingestion",{workflow:n}):(0,a.t)("label.edit-workflow-ingestion",{workflow:n})},C=function(e){switch(e){case m.Hz.DataInsight:return(0,v.si)(f.CZ.OPEN_METADATA,f.lx.DATA_INSIGHT);case m.Hz.ElasticSearchReindex:default:return(0,v.Ec)(f.CZ.OPEN_METADATA,f.lx.SEARCH,g.i.SCHEDULE)}},S=function(e,t,n,i,r,a){var o=[];return e?o.push({name:(0,l.startCase)(t),url:C(t),activeTitle:!0}):o.push.apply(o,[{name:(0,l.startCase)(n),url:(0,v.si)(f.CZ.SERVICES,(0,w.tJ)(n))},{name:(null==a?void 0:a.name)||"",url:(0,c.LE)(i,n,"ingestions"),imgSrc:E.Z.getServiceTypeLogo((null==a?void 0:a.serviceType)||""),activeTitle:!0}]),o.push({name:y(t,r),url:"",activeTitle:!0}),o},b=function(e){var t,n=[],i=null===(t=null==e?void 0:e.connection)||void 0===t?void 0:t.config;return i?(i.supportsMetadataExtraction&&n.push(m.Hz.Metadata),i.supportsUsageExtraction&&n.push(m.Hz.Usage),i.supportsLineageExtraction&&n.push(m.Hz.Lineage),i.supportsProfiler&&n.push(m.Hz.Profiler),i.supportsDBTExtraction&&n.push(m.Hz.Dbt),i.supportsDataInsightExtraction&&n.push(m.Hz.DataInsight),i.supportsElasticSearchReindexingExtraction&&n.push(m.Hz.ElasticSearchReindex)):n=[m.Hz.Metadata,m.Hz.Usage,m.Hz.Lineage,m.Hz.Profiler,m.Hz.Dbt],n},H=function(e,t,n,r){var a=(0,l.isUndefined)(r)?e:[r];return t||n.length>0?a.reduce((function(e,t){return t===m.Hz.Usage&&n.find((function(e){return e.pipelineType===t}))?e:(0,i.ev)((0,i.ev)([],(0,i.CR)(e)),[t])}),[]):[m.Hz.Metadata,m.Hz.Usage,m.Hz.Lineage,m.Hz.Profiler,m.Hz.Dbt]},D=function(e,t,n){return e&&0===t?o.createElement(s.Z,{className:"p-y-lg",type:p.Wx.CUSTOM},function(e){switch(e){case m.Hz.DataInsight:return o.createElement(o.Fragment,null,o.createElement(r.Z.Paragraph,{className:"w-max-500"},o.createElement(h.u1,{i18nKey:"message.data-insight-pipeline-description",renderElement:o.createElement("a",{href:u.RK,rel:"noreferrer",style:{color:"#1890ff"},target:"_blank"}),values:{link:(0,a.t)("label.data-insight-ingestion")}})));case m.Hz.ElasticSearchReindex:return o.createElement(o.Fragment,null,o.createElement(r.Z.Paragraph,{className:"w-max-500"},o.createElement(h.u1,{i18nKey:"message.elastic-search-re-index-pipeline-description",renderElement:o.createElement("a",{href:u.Db,rel:"noreferrer",style:{color:"#1890ff"},target:"_blank"}),values:{link:(0,a.t)("label.search-index-ingestion")}})));default:return o.createElement(r.Z.Paragraph,{className:"w-max-500"},o.createElement(h.u1,{i18nKey:"message.no-ingestion-description",renderElement:o.createElement("a",{href:u.tf,rel:"noreferrer",style:{color:"#1890ff"},target:"_blank"}),values:{link:(0,a.t)("label.metadata-ingestion")}}))}}(n)):null},k=function(e,t){return e.map((function(e){var n;return(n={label:(0,a.t)("label.add-workflow-ingestion",{workflow:(0,a.t)("label."+d.Pm[e])}),key:e,disabled:e===m.Hz.DataInsight&&t})["data-testid"]="list-item",n}))},z=function(e,t){return e?(0,a.t)("label.add-entity",{entity:(0,a.t)("label.ingestion-lowercase")}):t===m.Hz.ElasticSearchReindex?(0,a.t)("label.deploy"):(0,a.t)("label.add-workflow-ingestion",{workflow:(0,l.startCase)(t||(0,a.t)("label."+m.Hz.Metadata))})}}}]);