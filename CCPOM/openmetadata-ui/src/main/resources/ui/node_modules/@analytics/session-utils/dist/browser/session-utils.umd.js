!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e||self).utilSessions={})}(this,function(e){var n="undefined",t="object";"undefined"==typeof process||process;var o="undefined"!=typeof window;function r(e,n){return n.charAt(0)[e]()+n.slice(1)}"undefined"!=typeof Deno&&Deno,o&&"nodejs"===window.name||"undefined"!=typeof navigator&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom"));var i=r.bind(null,"toUpperCase"),s=r.bind(null,"toLowerCase");function u(e,n){void 0===n&&(n=!0);var t=function(e){return d(e)?i("null"):"object"==typeof e?function(e){return c(e.constructor)?e.constructor.name:null}(e):Object.prototype.toString.call(e).slice(8,-1)}(e);return n?s(t):t}function a(e,n){return typeof n===e}var c=a.bind(null,"function"),f=a.bind(null,"string");function d(e){return null===e}function l(e,n){if("object"!=typeof n||d(n))return!1;if(n instanceof e)return!0;var t=u(new e(""));if(function(e){return e instanceof Error||f(e.message)&&e.constructor&&function(e){return"number"===u(e)&&!isNaN(e)}(e.constructor.stackTraceLimit)}(n))for(;n;){if(u(n)===t)return!0;n=Object.getPrototypeOf(n)}return!1}function p(e,n){var t=e instanceof Element||e instanceof HTMLDocument;return t&&n?function(e,n){return void 0===n&&(n=""),e&&e.nodeName===n.toUpperCase()}(e,n):t}function v(e){var n=[].slice.call(arguments,1);return function(){return e.apply(void 0,[].slice.call(arguments).concat(n))}}function x(){for(var e="",n=0,t=4294967295*Math.random()|0;n++<36;){var o="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx"[n-1],r=15&t;e+="-"==o||"4"==o?o:("x"==o?r:3&r|8).toString(16),t=n%8==0?4294967295*Math.random()|0:t>>4}return e}a.bind(null,"undefined"),a.bind(null,"boolean"),a.bind(null,"symbol"),l.bind(null,TypeError),l.bind(null,SyntaxError),v(p,"form"),v(p,"button"),v(p,"input"),v(p,"select");var b="__global__",g=typeof self===t&&self.self===self&&self||typeof global===t&&global.global===global&&global||void 0;function m(e){return g[b][e]}function y(e,n){return g[b][e]=n}function S(e){delete g[b][e]}function w(e,n,t){var o;try{if(_(e)){var r=window[e];o=r[n].bind(r)}}catch(e){}return o||t}g[b]||(g[b]={});var h={};function _(e){if(typeof h[e]!==n)return h[e];try{var t=window[e];t.setItem(n,n),t.removeItem(n)}catch(n){return h[e]=!1}return h[e]=!0}_.bind(null,"sessionStorage");var j=w("sessionStorage","getItem",m),D=w("sessionStorage","setItem",y);w("sessionStorage","removeItem",S);var T=function(){if(void 0!==T)return T;var e="cookiecookie";try{A(e,e),T=-1!==document.cookie.indexOf(e),O(e)}catch(e){T=!1}return T}(),I=A,N=A;function O(e){return T?A(e,"",-1):S(e)}function A(e,n,t,o,r,i){if("undefined"!=typeof window){var s=arguments.length>1;return!1===T&&(s?y(e,n):m(e)),s?document.cookie=e+"="+encodeURIComponent(n)+(t?"; expires="+new Date(+new Date+1e3*t).toUTCString()+(o?"; path="+o:"")+(r?"; domain="+r:"")+(i?"; secure":""):""):decodeURIComponent((("; "+document.cookie).split("; "+e+"=")[1]||"").split(";")[0])}}var k="__",C="session",U="page",E=["id","createdAt","created"];function M(e){var n=e?new Date(e):new Date;return[n.toISOString(),n.getTime()]}function L(){var e=M(),n=e[0],t=e[1];return{id:x(),created:t,createdAt:n}}function P(e,n){for(var t={session:[j,D],page:[m,y]}[e],o=t[0],r=t[1],i=L(),s=!1,u={},a=0;a<E.length;a++){var c=E[a],f=k+e+k+C+k+c,d=o(f);s=n||!d;var l=d&&!n?d:r(f,i[c]),p="created"!==c?l:Number(l);u[c]=p}return J(u,s)}function J(e,n){var t=Date.now();return e.elapsed=t-e.created,e.expires&&(e.remaining=Math.abs(e.expires-t)),e.isNew=n,e}function R(e,n){void 0===e&&(e=30);var t=I("__session"),o=t?JSON.parse(t):H(e);return n?o:J(o,!t)}function H(e,n,t){void 0===e&&(e=30);var o=t?R(e,!0):L(),r=60*e,i=o.created;if(t){var s=M(),u=s[0],a=s[1];o.modified=a,o.modifiedAt=u,i=a}var c=M(i+1e3*r),f=c[0];return o.expires=c[1],o.expiresAt=f,n&&(o=Object.assign(o,n)),N("__session",JSON.stringify(o),r),J(o,!t)}var q=P.bind(null,C),z=P.bind(null,C,!0),B=P.bind(null,U),F=P.bind(null,U,!0);e.extendSession=function(e,n){return void 0===e&&(e=30),H(e||1,n,!0)},e.getPageSession=B,e.getSession=R,e.getTabSession=q,e.removeSession=function(){return O("__session")},e.sessionData=L,e.setPageSession=F,e.setSession=H,e.setTabSession=z});
//# sourceMappingURL=session-utils.umd.js.map
