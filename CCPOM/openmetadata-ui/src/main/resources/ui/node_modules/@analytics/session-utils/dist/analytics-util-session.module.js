import{uuid as e}from"analytics-utils";import{getSessionItem as r,setSessionItem as i}from"@analytics/session-storage-utils";import{getCookie as n,setCookie as t,removeCookie as s}from"@analytics/cookie-utils";import{get as a,set as o}from"@analytics/global-storage-utils";var u=["id","createdAt","created"];function c(e){var r=e?new Date(e):new Date;return[r.toISOString(),r.getTime()]}function d(){var r=c(),i=r[0],n=r[1];return{id:e(),created:n,createdAt:i}}function l(e,n){for(var t={session:[r,i],page:[a,o]}[e],s=t[0],c=t[1],l=d(),v=!1,p={},m=0;m<u.length;m++){var g=u[m],_="__"+e+"__session__"+g,b=s(_);v=n||!b;var x=b&&!n?b:c(_,l[g]),y="created"!==g?x:Number(x);p[g]=y}return f(p,v)}function f(e,r){var i=Date.now();return e.elapsed=i-e.created,e.expires&&(e.remaining=Math.abs(e.expires-i)),e.isNew=r,e}function v(e,r){void 0===e&&(e=30);var i=n("__session"),t=i?JSON.parse(i):p(e);return r?t:f(t,!i)}function p(e,r,i){void 0===e&&(e=30);var n=i?v(e,!0):d(),s=60*e,a=n.created;if(i){var o=c(),u=o[0],l=o[1];n.modified=l,n.modifiedAt=u,a=l}var p=c(a+1e3*s),m=p[0];return n.expires=p[1],n.expiresAt=m,r&&(n=Object.assign(n,r)),t("__session",JSON.stringify(n),s),f(n,!i)}var m=function(e,r){return void 0===e&&(e=30),p(e||1,r,!0)},g=function(){return s("__session")},_=l.bind(null,"session"),b=l.bind(null,"session",!0),x=l.bind(null,"page"),y=l.bind(null,"page",!0);export{m as extendSession,x as getPageSession,v as getSession,_ as getTabSession,g as removeSession,d as sessionData,y as setPageSession,p as setSession,b as setTabSession};
//# sourceMappingURL=analytics-util-session.module.js.map
