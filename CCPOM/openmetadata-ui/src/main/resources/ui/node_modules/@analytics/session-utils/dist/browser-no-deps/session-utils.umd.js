!function(e,s){"object"==typeof exports&&"undefined"!=typeof module?s(exports,require("analytics-utils"),require("@analytics/session-storage-utils"),require("@analytics/cookie-utils"),require("@analytics/global-storage-utils")):"function"==typeof define&&define.amd?define(["exports","analytics-utils","@analytics/session-storage-utils","@analytics/cookie-utils","@analytics/global-storage-utils"],s):s((e||self).utilSessions={},e.analyticsUtils,e.sessionStorageUtils,e.cookieUtils,e.globalStorageUtils)}(this,function(e,s,i,t,n){var o="__",a="session",r="page",l=["id","createdAt","created"];function u(e){var s=e?new Date(e):new Date;return[s.toISOString(),s.getTime()]}function c(){var e=u(),i=e[0],t=e[1];return{id:s.uuid(),created:t,createdAt:i}}function d(e,s){for(var t={session:[i.getSessionItem,i.setSessionItem],page:[n.get,n.set]}[e],r=t[0],u=t[1],d=c(),f=!1,v={},S=0;S<l.length;S++){var b=l[S],p=o+e+o+a+o+b,y=r(p);f=s||!y;var m=y&&!s?y:u(p,d[b]),x="created"!==b?m:Number(m);v[b]=x}return g(v,f)}function g(e,s){var i=Date.now();return e.elapsed=i-e.created,e.expires&&(e.remaining=Math.abs(e.expires-i)),e.isNew=s,e}function f(e,s){void 0===e&&(e=30);var i=t.getCookie("__session"),n=i?JSON.parse(i):v(e);return s?n:g(n,!i)}function v(e,s,i){void 0===e&&(e=30);var n=i?f(e,!0):c(),o=60*e,a=n.created;if(i){var r=u(),l=r[0],d=r[1];n.modified=d,n.modifiedAt=l,a=d}var v=u(a+1e3*o),S=v[0];return n.expires=v[1],n.expiresAt=S,s&&(n=Object.assign(n,s)),t.setCookie("__session",JSON.stringify(n),o),g(n,!i)}var S=d.bind(null,a),b=d.bind(null,a,!0),p=d.bind(null,r),y=d.bind(null,r,!0);e.extendSession=function(e,s){return void 0===e&&(e=30),v(e||1,s,!0)},e.getPageSession=p,e.getSession=f,e.getTabSession=S,e.removeSession=function(){return t.removeCookie("__session")},e.sessionData=c,e.setPageSession=y,e.setSession=v,e.setTabSession=b});
//# sourceMappingURL=session-utils.umd.js.map
