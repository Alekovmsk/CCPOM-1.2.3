import{uuid as e}from"analytics-utils";import{getSessionItem as t,setSessionItem as n}from"@analytics/session-storage-utils";import{getCookie as s,setCookie as i,removeCookie as o}from"@analytics/cookie-utils";import{get as r,set as c}from"@analytics/global-storage-utils";const a=["id","createdAt","created"];function l(e){const t=e?new Date(e):new Date;return[t.toISOString(),t.getTime()]}function u(){const[t,n]=l();return{id:e(),created:n,createdAt:t}}function d(e,s){const i={session:[t,n],page:[r,c]},[o,l]=i[e],d=u();let p=!1,m={};for(let t=0;t<a.length;t++){const n=a[t],i="__"+e+"__session__"+n,r=o(i);p=s||!r;const c=r&&!s?r:l(i,d[n]),u="created"!==n?c:Number(c);m[n]=u}return f(m,p)}function f(e,t){const n=Date.now();return e.elapsed=n-e.created,e.expires&&(e.remaining=Math.abs(e.expires-n)),e.isNew=t,e}function p(e=30,t){const n=s("__session"),i=n?JSON.parse(n):m(e);return t?i:f(i,!n)}function m(e=30,t,n){let s=n?p(e,!0):u();const o=60*e;let r=s.created;if(n){const[e,t]=l();s.modified=t,s.modifiedAt=e,r=t}const[c,a]=l(r+1e3*o);return s.expires=a,s.expiresAt=c,t&&(s=Object.assign(s,t)),i("__session",JSON.stringify(s),o),f(s,!n)}const g=(e=30,t)=>m(e||1,t,!0),_=()=>o("__session"),b=d.bind(null,"session"),x=d.bind(null,"session",!0),y=d.bind(null,"page"),w=d.bind(null,"page",!0);export{g as extendSession,y as getPageSession,p as getSession,b as getTabSession,_ as removeSession,u as sessionData,w as setPageSession,m as setSession,x as setTabSession};
//# sourceMappingURL=analytics-util-session.modern.js.map
