"use strict";(self.webpackChunkopen_metadata=self.webpackChunkopen_metadata||[]).push([[9202],{71068:function(e,t,n){var a=n(8081),i=n.n(a),s=n(23645),l=n.n(s)()(i());l.push([e.id,'/*\n *  Copyright 2022 Collate.\n *  Licensed under the Apache License, Version 2.0 (the "License");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *  http://www.apache.org/licenses/LICENSE-2.0\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an "AS IS" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n.assignee-tag {\n  display: flex;\n  align-items: center;\n  padding: 2px 3px;\n  margin: 1px 2px;\n}\n.assignee-item .profile-image {\n  vertical-align: middle;\n}\n',""]),t.Z=l},41953:function(e,t,n){var a=n(8081),i=n.n(a),s=n(23645),l=n.n(s)()(i());l.push([e.id,'/*\n *  Copyright 2023 Collate.\n *  Licensed under the Apache License, Version 2.0 (the "License");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *  http://www.apache.org/licenses/LICENSE-2.0\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an "AS IS" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n.request-tags .ant-select-custom,\n.request-description .ant-select-custom {\n  margin: 0;\n}\n.request-description .ant-tabs-description {\n  margin-top: 0;\n}\n.task-data {\n  width: unset;\n}\n',""]),t.Z=l},42105:function(e,t,n){var a=n(93379),i=n.n(a),s=n(7795),l=n.n(s),r=n(90569),c=n.n(r),o=n(3565),d=n.n(o),u=n(19216),m=n.n(u),p=n(44589),f=n.n(p),h=n(41953),g={};g.styleTagTransform=f(),g.setAttributes=d(),g.insert=c().bind(null,"head"),g.domAPI=l(),g.insertStyleElement=m(),i()(h.Z,g),h.Z&&h.Z.locals&&h.Z.locals},39202:function(e,t,n){n.r(t);var a=n(70655),i=n(56256),s=n(49409),l=n(4107),r=n(19650),c=n(71577),o=n(50963),d=n(96486),u=n(67294),m=n(68432),p=n(15137),f=n(98542),h=n(95137),g=n(79686),b=n(26387),y=n(95969),v=n(69523),E=n(73213),w=n(58369),S=n(16139),Z=n(64632),C=n(59583),T=n(76373),N=n(93895),I=n(24671),k=n(40734),x=n(86385),A=n(46321),L=n(25131),R=n(89103);n(42105),t.default=function(){var e,t=(0,m.$)().t,n=(0,h.Eu)().currentUser,q=(0,p.TH)(),O=(0,p.k6)(),U=(0,a.CR)((0,o.useForm)(),1)[0],D=(0,p.UO)(),M=D.entityType,P=D.fqn,V=new URLSearchParams(q.search),F=V.get("field"),B=V.get("value"),W=(0,a.CR)((0,u.useState)({}),2),Y=W[0],H=W[1],K=(0,a.CR)((0,u.useState)([]),2),_=K[0],j=K[1],z=(0,a.CR)((0,u.useState)([]),2),X=z[0],$=z[1],G=(0,a.CR)((0,u.useState)(""),2),J=G[0],Q=G[1],ee=(0,u.useMemo)((function(){var e;return null!==(e=null==B?void 0:B.replaceAll(S.Xt,""))&&void 0!==e?e:""}),[B]),te=(0,u.useMemo)((function(){return(0,k.p2)(P)}),[P]),ne=(0,u.useMemo)((function(){return(0,x.wP)({value:B,entityType:M,entityData:Y,field:F,startMessage:"Update description"})}),[B,M,F,Y]),ae=(0,u.useMemo)((function(){var e=ee.split(E.o).slice(-1);return(0,x.dY)(e[0],(0,x.eB)(M,Y),M)}),[F,Y,M]),ie=function(){return(0,d.isEmpty)(ae)||(0,d.isUndefined)(ae)?Y.description||"":ae.description||""},se=function(){return F&&B?""+F+I.LV+B+I.LV+"description":w.Sn.DESCRIPTION};return(0,u.useEffect)((function(){(0,x.Dy)(M,P,H)}),[P,M]),(0,u.useEffect)((function(){var e=Y.owner,t=[];e&&(t=[{label:(0,I.C_)(e),value:e.id||"",type:e.type}],$(t),j(t)),U.setFieldsValue({title:ne.trimEnd(),assignees:t,description:ie()})}),[Y]),(0,u.useEffect)((function(){Q(ie())}),[Y,ae]),(0,d.isEmpty)(Y)?u.createElement(v.Z,null):u.createElement(g.Z,{firstPanel:{minWidth:700,flex:.6,children:u.createElement("div",{className:"max-width-md w-9/10 m-x-auto m-y-md d-grid gap-4"},u.createElement(b.Z,{titleLinks:(0,a.ev)((0,a.ev)([],(0,a.CR)((0,x.rM)(Y,M))),[{name:t("label.create-entity",{entity:t("label.task")}),activeTitle:!0,url:""}])}),u.createElement("div",{className:"m-t-0 request-description",key:"update-description"},u.createElement(i.Z.Paragraph,{className:"text-base","data-testid":"form-title"},t("label.create-entity",{entity:t("label.task")})),u.createElement(s.Z,{form:U,layout:"vertical",onFinish:function(e){var a={from:null==n?void 0:n.name,message:e.title||ne,about:(0,I.ec)(M,te,se()),taskDetails:{assignees:X.map((function(e){return{id:e.value,type:e.type}})),suggestion:e.description,type:C.U.UpdateDescription,oldValue:J},type:C.T.Task};(0,T.Kl)(a).then((function(){(0,A.XA)(t("server.create-entity-success",{entity:t("label.task")})),O.push((0,N.X3)(M,te,Z.M8.ACTIVITY_FEED,f.o.TASKS))})).catch((function(e){return(0,A.Eo)(e)}))}},u.createElement(s.Z.Item,{"data-testid":"title",label:t("label.title")+":",name:"title"},u.createElement(l.Z,{disabled:!0,placeholder:t("label.task-entity",{entity:t("label.title")})})),u.createElement(s.Z.Item,{"data-testid":"assignees",label:t("label.assignee-plural")+":",name:"assignees",rules:[{required:!0,message:t("message.field-text-is-required",{fieldText:t("label.assignee-plural")})}]},u.createElement(L.Z,{options:_,value:X,onChange:$,onSearch:function(e){(0,x.Od)(e,j)}})),J&&u.createElement(s.Z.Item,{"data-testid":"description-tabs",label:t("label.description")+":",name:"description",rules:[{required:!0,message:t("message.field-text-is-required",{fieldText:t("label.description")})}]},u.createElement(R.Z,{suggestion:J,value:J})),u.createElement(s.Z.Item,null,u.createElement(r.Z,{className:"w-full justify-end","data-testid":"cta-buttons",size:16},u.createElement(c.Z,{type:"link",onClick:function(){return O.goBack()}},t("label.back")),u.createElement(c.Z,{htmlType:"submit",type:"primary"},t("label.submit")))))))},pageTitle:t("label.task"),secondPanel:{minWidth:60,flex:.4,children:u.createElement(y.Z,{hideBreadcrumbs:!0,showTags:!0,id:null!==(e=Y.id)&&void 0!==e?e:"",source:(0,a.pi)((0,a.pi)({},Y),{entityType:M})})}})}},25131:function(e,t,n){n.d(t,{Z:function(){return k}});var a=n(70655),i=n(19650),s=n(56256),l=n(34041),r=n(23031),c=n(96486),o=n(67294),d=n(43443),u=n(40773),m=n(37878),p=n(55546),f=n(93379),h=n.n(f),g=n(7795),b=n.n(g),y=n(90569),v=n.n(y),E=n(3565),w=n.n(E),S=n(19216),Z=n.n(S),C=n(44589),T=n.n(C),N=n(71068),I={};I.styleTagTransform=T(),I.setAttributes=w(),I.insert=v().bind(null,"head"),I.domAPI=b(),I.insertStyleElement=Z(),h()(N.Z,I),N.Z&&N.Z.locals&&N.Z.locals;var k=function(e){var t=e.value,n=void 0===t?[]:t,f=e.onSearch,h=e.onChange,g=e.options,b=(0,o.useMemo)((function(){var e=(0,c.groupBy)(g,(function(e){return e.type})),t=[];return(0,c.isUndefined)(e.team)||t.push({type:"group",label:"Teams",value:p.jc.TEAM,options:e.team.map((function(e){return(0,a.pi)((0,a.pi)({},e),{label:o.createElement(i.Z,{"data-testid":"assignee-option",key:e.value},o.createElement(d.ReactComponent,{height:16,width:16}),o.createElement(s.Z.Text,null,e.label))})}))}),(0,c.isUndefined)(e.user)||t.push({type:"group",label:"Users",value:p.jc.USER,options:e.user.map((function(e){return(0,a.pi)((0,a.pi)({},e),{label:o.createElement("div",{"data-testid":"assignee-option-"+e.label},o.createElement(u.w,{className:"assignee-item",id:e.value,name:e.label,size:m.e.small}))})}))}),t}),[g]);return o.createElement(l.Z,{showSearch:!0,className:"ant-select-custom select-assignee","data-testid":"select-assignee",defaultActiveFirstOption:!1,filterOption:!1,mode:"multiple",notFoundContent:null,options:b,placeholder:(0,r.t)("label.select-to-search"),showArrow:!1,value:n.length?n:void 0,onChange:function(e,t){var n=t.map((function(e){return{label:e["data-label"],value:e.value,type:e.type}}));h(n)},onSearch:f})}},89103:function(e,t,n){n.d(t,{Z:function(){return m}});var a=n(70655),i=n(25499),s=n(96486),l=n(67294),r=n(68432),c=n(18927),o=n(24135),d=n(86385),u=n(36190),m=function(e){var t=e.value,n=void 0===t?"":t,m=e.suggestion,p=e.placeHolder,f=e.onChange,h=(0,r.$)().t,g=i.Z.TabPane,b=(0,a.CR)((0,l.useState)(n),1)[0],y=(0,a.CR)((0,l.useState)([]),2),v=y[0],E=y[1],w=(0,a.CR)((0,l.useState)("3"),2),S=w[0],Z=w[1],C=(0,l.useRef)(),T=(0,l.useCallback)((function(e){var t;if(Z(e),(0,s.isEqual)(e,"2")){var n=null===(t=C.current)||void 0===t?void 0:t.getEditorContent();if(n){var a=(0,d.up)(b,n);E(a)}}else E([])}),[C]);return l.createElement(i.Z,{activeKey:S,className:"ant-tabs-description","data-testid":"tabs",size:"small",type:"card",onChange:T},l.createElement(g,{"data-testid":"current-tab",key:"1",tab:"Current"},l.createElement("div",{className:"border border-main rounded-4 p-sm m-t-sm"},b.trim()?l.createElement(o.Z,{enableSeeMoreVariant:!1,markdown:b}):l.createElement("span",{className:"text-grey-muted"},h("label.no-entity",{entity:h("label.description")})))),l.createElement(g,{"data-testid":"diff-tab",key:"2",tab:"Diff"},l.createElement(u.E,{className:"border border-main rounded-4 p-sm m-t-sm",diffArr:v})),l.createElement(g,{"data-testid":"new-tab",key:"3",tab:"New"},l.createElement(c.Z,{className:"m-t-sm",height:"208px",initialValue:m,placeHolder:null!=p?p:h("label.update-description"),ref:C,onTextChange:f})))}},36190:function(e,t,n){n.d(t,{E:function(){return c}});var a=n(94184),i=n.n(a),s=n(96486),l=n(67294),r=n(68432),c=function(e){var t=e.diffArr,n=e.className,a=(0,r.$)().t,c=t.map((function(e){return e.added?l.createElement("ins",{className:"diff-added","data-testid":"diff-added",key:(0,s.uniqueId)()},e.value):e.removed?l.createElement("del",{"data-testid":"diff-removed",key:(0,s.uniqueId)(),style:{color:"grey",textDecoration:"line-through"}},e.value):l.createElement("span",{"data-testid":"diff-normal",key:(0,s.uniqueId)()},e.value)}));return l.createElement("div",{className:i()("w-full h-max-56 overflow-y-auto",n)},l.createElement("pre",{className:"whitespace-pre-wrap m-b-0","data-testid":"diff-container"},t.length?c:l.createElement("span",{className:"text-grey-muted","data-testid":"noDiff-placeholder"},a("label.no-diff-available"))))}}}]);