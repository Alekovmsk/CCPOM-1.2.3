"use strict";(self.webpackChunkopen_metadata=self.webpackChunkopen_metadata||[]).push([[3910],{37967:function(e,t,n){var i=n(8081),r=n.n(i),a=n(23645),o=n.n(a)()(r());o.push([e.id,'/*\n *  Copyright 2022 Collate.\n *  Licensed under the Apache License, Version 2.0 (the "License");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *  http://www.apache.org/licenses/LICENSE-2.0\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an "AS IS" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n.roles-list-container .ant-btn {\n  border-radius: 4px;\n}\n.roles-list-table .ant-table-row .ant-table-cell:first-child,\n.roles-list-table .ant-table-thead .ant-table-cell:first-child {\n  padding-left: 16px;\n}\n',""]),t.Z=o},13910:function(e,t,n){n.r(t),n.d(t,{default:function(){return $}});var i=n(70655),r=n(19650),a=n(94199),o=n(55241),l=n(60331),s=n(71577),c=n(71230),u=n(15746),d=n(96486),f=n(67294),m=n(68432),p=n(15137),h=n(76),v=n(8645),g=n(78410),b=n(83716),y=n(34115),E=n(24135),w=n(37565),Z=n(84065),C=n(8752),k=n(79839),N=n(62761),I=n(52114),S=n(43104),L=n(61105),x=n(64632),_=n(72819),A=n(802),O=n(80897),R=n(24671),D=n(39570),G=n(96840),J=n(46321),P=n(93379),T=n.n(P),z=n(7795),Y=n.n(z),j=n(90569),q=n.n(j),H=n(3565),M=n.n(H),U=n(19216),Q=n.n(U),W=n(44589),F=n.n(W),K=n(37967),V={};V.styleTagTransform=F(),V.setAttributes=M(),V.insert=q().bind(null,"head"),V.domAPI=Y(),V.insertStyleElement=Q(),T()(K.Z,V),K.Z&&K.Z.locals&&K.Z.locals;var $=function(){var e=(0,p.k6)(),t=(0,m.$)().t,n=(0,i.CR)((0,f.useState)([]),2),P=n[0],T=n[1],z=(0,i.CR)((0,f.useState)(!1),2),Y=z[0],j=z[1],q=(0,i.CR)((0,f.useState)(),2),H=q[0],M=q[1],U=(0,A.C)(N.Ou),Q=U.currentPage,W=U.pageSize,F=U.paging,K=U.handlePageChange,V=U.handlePageSizeChange,$=U.handlePagingChange,B=U.showPagination,X=(0,C.BL)().permissions,ee=(0,f.useMemo)((function(){return!(0,d.isEmpty)(X)&&(0,D.P_)(_.OX.Create,k.A.ROLE,X)}),[X]),te=(0,f.useMemo)((function(){return!(0,d.isEmpty)(X)&&(null===D.NE||void 0===D.NE?void 0:D.NE.hasViewPermissions(k.A.POLICY,X))}),[X]),ne=(0,f.useMemo)((function(){return!(0,d.isEmpty)(X)&&(0,D.P_)(_.OX.Delete,k.A.ROLE,X)}),[X]),ie=(0,f.useMemo)((function(){return[{title:t("label.name"),dataIndex:"name",width:"200px",key:"name",render:function(e,t){var n;return f.createElement(h.Link,{className:"link-hover","data-testid":"role-name",to:(0,G.Uy)(encodeURIComponent(null!==(n=t.fullyQualifiedName)&&void 0!==n?n:""))},(0,R.C_)(t))}},{title:t("label.description"),dataIndex:"description",key:"description",render:function(e,t){return f.createElement(E.Z,{markdown:(null==t?void 0:t.description)||""})}},{title:t("label.policy-plural"),dataIndex:"policies",width:"250px",key:"policies",render:function(e,t){var n,i,s,c=null!==(i=null===(n=t.policies)||void 0===n?void 0:n.length)&&void 0!==i?i:0,u=c>D.YD;return(null===(s=t.policies)||void 0===s?void 0:s.length)?f.createElement(r.Z,{wrap:!0,"data-testid":"policy-link",size:4},t.policies.slice(0,D.YD).map((function(e){return te?f.createElement(h.Link,{key:(0,d.uniqueId)(),to:(0,G.Hr)(e.fullyQualifiedName||"")},(0,R.C_)(e)):f.createElement(a.Z,{key:(0,d.uniqueId)(),title:I._D},(0,R.C_)(e))})),u&&f.createElement(o.Z,{className:"cursor-pointer",content:f.createElement(r.Z,{wrap:!0,size:4},t.policies.slice(D.YD).map((function(e){return te?f.createElement(h.Link,{key:(0,d.uniqueId)(),to:(0,G.Hr)(e.fullyQualifiedName||"")},(0,R.C_)(e)):f.createElement(a.Z,{key:(0,d.uniqueId)(),title:I._D},(0,R.C_)(e))}))),overlayClassName:"w-40 text-center",trigger:"click"},f.createElement(l.Z,{className:"m-l-xss","data-testid":"plus-more-count"},"+"+(c-D.YD)+" more"))):"-- "}},{title:t("label.action-plural"),dataIndex:"actions",width:"80px",align:"center",key:"actions",render:function(e,n){return f.createElement(a.Z,{placement:"left",title:!ne&&I.oH},f.createElement(s.Z,{"data-testid":"delete-action-"+(0,R.C_)(n),disabled:!ne,icon:f.createElement(v.ReactComponent,{name:t("label.delete"),width:"16px"}),type:"text",onClick:function(){return M(n)}}))}}]}),[]),re=function(e){return(0,i.mG)(void 0,void 0,void 0,(function(){var t,n;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:j(!0),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,(0,O.F3)("policies",null==e?void 0:e.after,null==e?void 0:e.before,void 0,W)];case 2:return t=i.sent(),T(t.data||[]),$(t.paging),[3,5];case 3:return n=i.sent(),(0,J.Eo)(n),[3,5];case 4:return j(!1),[7];case 5:return[2]}}))}))},ae=(0,f.useCallback)((function(){re()}),[re]),oe=function(){e.push(N.dt.ADD_ROLE)};return(0,f.useEffect)((function(){re()}),[W]),f.createElement(c.Z,{className:"roles-list-container","data-testid":"roles-list-container",gutter:[16,16]},f.createElement(u.Z,{span:24},f.createElement(r.Z,{className:"w-full justify-between"},f.createElement(Z.Z,{data:S.j.ROLES}),ee&&f.createElement(s.Z,{"data-testid":"add-role",type:"primary",onClick:oe},t("label.add-entity",{entity:t("label.role")})))),f.createElement(u.Z,{span:24},f.createElement(w.Z,{bordered:!0,className:"roles-list-table",columns:ie,"data-testid":"roles-list-table",dataSource:P,loading:Y,locale:{emptyText:f.createElement(b.Z,{heading:t("label.role"),permission:ee,type:L.Wx.CREATE,onClick:oe})},pagination:!1,rowKey:"name",size:"small"}),H&&f.createElement(g.Z,{afterDeleteAction:ae,allowSoftDelete:!1,deleteMessage:t("message.are-you-sure-delete-entity",{entity:(0,R.C_)(H)}),entityId:H.id,entityName:(0,R.C_)(H),entityType:x.py.ROLE,visible:!(0,d.isUndefined)(H),onCancel:function(){return M(void 0)}})),f.createElement(u.Z,{span:24},B&&f.createElement(y.Z,{currentPage:Q,pageSize:W,paging:F,pagingHandler:function(e){var t,n=e.currentPage,i=e.cursorType;K(n),i&&F&&re(((t={})[i]=F[i],t.total=F.total,t))},onShowSizeChange:V})))}},80897:function(e,t,n){n.d(t,{$j:function(){return m},F3:function(){return o},Ko:function(){return l},QW:function(){return h},_d:function(){return u},cN:function(){return p},dV:function(){return v},n5:function(){return s},sZ:function(){return f},u$:function(){return d},u7:function(){return c}});var i=n(70655),r=n(2598),a={headers:{"Content-type":"application/json-patch+json"}},o=function(e,t,n,a,o){return void 0===a&&(a=!1),void 0===o&&(o=10),(0,i.mG)(void 0,void 0,void 0,(function(){var l;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return l={default:a,limit:o,fields:e,after:t,before:n},[4,r.Z.get("/roles",{params:l})];case 1:return[2,i.sent().data]}}))}))},l=function(e,t,n,a){return void 0===a&&(a=10),(0,i.mG)(void 0,void 0,void 0,(function(){var o;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return o={limit:a,fields:e,after:t,before:n},[4,r.Z.get("/policies",{params:o})];case 1:return[2,i.sent().data]}}))}))},s=function(e,t){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return[4,r.Z.get("/roles/name/"+e,{params:{fields:t}})];case 1:return[2,n.sent().data]}}))}))},c=function(e,t){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return[4,r.Z.get("/policies/name/"+e,{params:{fields:t}})];case 1:return[2,n.sent().data]}}))}))},u=function(e){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,r.Z.post("/roles",e)];case 1:return[2,t.sent().data]}}))}))},d=function(e){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,r.Z.post("/policies",e)];case 1:return[2,t.sent().data]}}))}))},f=function(e,t){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return[4,r.Z.patch("/roles/"+t,e,a)];case 1:return[2,n.sent().data]}}))}))},m=function(e,t){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return[4,r.Z.patch("/policies/"+t,e,a)];case 1:return[2,n.sent().data]}}))}))},p=function(){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(e){switch(e.label){case 0:return[4,r.Z.get("/policies/resources")];case 1:return[2,e.sent().data]}}))}))},h=function(){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(e){switch(e.label){case 0:return[4,r.Z.get("/policies/functions")];case 1:return[2,e.sent().data]}}))}))},v=function(e){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,r.Z.get("/policies/validation/condition/"+e)];case 1:return[2,t.sent()]}}))}))}}}]);