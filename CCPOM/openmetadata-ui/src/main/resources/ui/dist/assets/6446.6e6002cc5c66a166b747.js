"use strict";(self.webpackChunkopen_metadata=self.webpackChunkopen_metadata||[]).push([[6446],{71068:function(e,t,n){var a=n(8081),i=n.n(a),l=n(23645),s=n.n(l)()(i());s.push([e.id,'/*\n *  Copyright 2022 Collate.\n *  Licensed under the Apache License, Version 2.0 (the "License");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *  http://www.apache.org/licenses/LICENSE-2.0\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an "AS IS" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n.assignee-tag {\n  display: flex;\n  align-items: center;\n  padding: 2px 3px;\n  margin: 1px 2px;\n}\n.assignee-item .profile-image {\n  vertical-align: middle;\n}\n',""]),t.Z=s},41953:function(e,t,n){var a=n(8081),i=n.n(a),l=n(23645),s=n.n(l)()(i());s.push([e.id,'/*\n *  Copyright 2023 Collate.\n *  Licensed under the Apache License, Version 2.0 (the "License");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *  http://www.apache.org/licenses/LICENSE-2.0\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an "AS IS" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n.request-tags .ant-select-custom,\n.request-description .ant-select-custom {\n  margin: 0;\n}\n.request-description .ant-tabs-description {\n  margin-top: 0;\n}\n.task-data {\n  width: unset;\n}\n',""]),t.Z=s},42105:function(e,t,n){var a=n(93379),i=n.n(a),l=n(7795),s=n.n(l),r=n(90569),u=n.n(r),c=n(3565),d=n.n(c),o=n(19216),m=n.n(o),p=n(44589),f=n.n(p),g=n(41953),h={};h.styleTagTransform=f(),h.setAttributes=d(),h.insert=u().bind(null,"head"),h.domAPI=s(),h.insertStyleElement=m(),i()(g.Z,h),g.Z&&g.Z.locals&&g.Z.locals},56446:function(e,t,n){n.r(t);var a=n(70655),i=n(56256),l=n(49409),s=n(4107),r=n(19650),u=n(71577),c=n(50963),d=n(96486),o=n(67294),m=n(68432),p=n(15137),f=n(98542),g=n(95137),h=n(79686),y=n(26387),v=n(95969),b=n(69523),E=n(73213),S=n(58369),T=n(16139),Z=n(64632),w=n(59583),N=n(31615),x=n(76373),C=n(93895),I=n(24671),k=n(40734),A=n(86385),L=n(46321),R=n(25131),q=n(40501);n(42105),t.default=function(){var e,t=(0,m.$)().t,n=(0,p.TH)(),F=(0,p.k6)(),O=(0,a.CR)((0,c.useForm)(),1)[0],U=(0,g.Eu)().currentUser,D=(0,p.UO)(),P=D.entityType,M=D.fqn,W=new URLSearchParams(n.search),B=W.get("field"),V=W.get("value"),G=(0,a.CR)((0,o.useState)({}),2),Y=G[0],_=G[1],K=(0,a.CR)((0,o.useState)([]),2),X=K[0],Q=K[1],j=(0,a.CR)((0,o.useState)([]),2),z=j[0],H=j[1],J=(0,a.CR)((0,o.useState)([]),2),$=J[0],ee=J[1],te=(0,a.CR)((0,o.useState)([]),2),ne=te[0],ae=te[1],ie=(0,a.CR)((0,o.useState)([]),2),le=ie[0],se=ie[1],re=(0,o.useMemo)((function(){var e;return null!==(e=null==V?void 0:V.replaceAll(T.Xt,""))&&void 0!==e?e:""}),[V]),ue=(0,o.useMemo)((function(){return(0,A.wP)({value:V,entityType:P,entityData:Y,field:B,startMessage:"Update tags"})}),[V,P,B,Y]),ce=(0,o.useMemo)((function(){return(0,k.p2)(M)}),[M]),de=(0,o.useMemo)((function(){var e=re.split(E.o).slice(-1);return(0,A.dY)(e[0],(0,A.eB)(P,Y),P,X)}),[B,Y,X,P]),oe=function(){var e,t;return(0,d.isEmpty)(de)||(0,d.isUndefined)(de)?null!==(t=Y.tags)&&void 0!==t?t:[]:null!==(e=de.tags)&&void 0!==e?e:[]},me=function(){return B&&V?""+B+I.LV+V+I.LV+"tags":S.Sn.TAGS};return(0,o.useEffect)((function(){(0,A.Dy)(P,M,_,Q)}),[M,P]),(0,o.useEffect)((function(){var e=Y.owner,t=[];e&&(t=[{label:(0,I.C_)(e),value:e.id||"",type:e.type}],ee(t),H(t)),O.setFieldsValue({title:ue.trimEnd(),updatedTags:oe(),assignees:t})}),[Y,de]),(0,o.useEffect)((function(){ae(oe()),se(oe())}),[Y,de]),(0,d.isEmpty)(Y)?o.createElement(b.Z,null):o.createElement(h.Z,{firstPanel:{minWidth:700,flex:.6,children:o.createElement("div",{className:"max-width-md w-9/10 m-x-auto m-y-md d-grid gap-4"},o.createElement(y.Z,{titleLinks:(0,a.ev)((0,a.ev)([],(0,a.CR)((0,A.rM)(Y,P))),[{name:t("label.create-entity",{entity:t("label.task")}),activeTitle:!0,url:""}])}),o.createElement("div",{className:"m-t-0 request-tags",key:"update-tags"},o.createElement(i.Z.Paragraph,{className:"text-base","data-testid":"form-title"},t("label.create-entity",{entity:t("label.task")})),o.createElement(l.Z,{form:O,layout:"vertical",onFinish:function(e){var n={from:null==U?void 0:U.name,message:e.title||ue,about:(0,I.ec)(P,ce,me()),taskDetails:{assignees:$.map((function(e){return{id:e.value,type:e.type}})),suggestion:JSON.stringify(le),type:w.U.UpdateTag,oldValue:JSON.stringify(ne)},type:N.Th.Task};(0,x.Kl)(n).then((function(){(0,L.XA)(t("server.create-entity-success",{entity:t("label.task")})),F.push((0,C.X3)(P,ce,Z.M8.ACTIVITY_FEED,f.o.TASKS))})).catch((function(e){return(0,L.Eo)(e)}))}},o.createElement(l.Z.Item,{"data-testid":"title",label:t("label.title")+":",name:"title"},o.createElement(s.Z,{disabled:!0,placeholder:t("label.task-entity",{entity:t("label.title")})})),o.createElement(l.Z.Item,{"data-testid":"assignees",label:t("label.assignee-plural")+":",name:"assignees",rules:[{required:!0,message:t("message.field-text-is-required",{fieldText:t("label.assignee-plural")})}]},o.createElement(R.Z,{options:z,value:$,onChange:ee,onSearch:function(e){(0,A.Od)(e,H)}})),ne.length?o.createElement(l.Z.Item,{"data-testid":"tags-label",label:t("label.update-entity",{entity:t("label.tag-plural")}),name:"updatedTags",rules:[{required:!0,message:t("message.field-text-is-required",{fieldText:t("label.tag-plural")})}]},o.createElement(q.X,{tags:ne,value:le,onChange:se})):null,o.createElement(l.Z.Item,null,o.createElement(r.Z,{className:"w-full justify-end","data-testid":"cta-buttons",size:16},o.createElement(u.Z,{type:"link",onClick:function(){return F.goBack()}},t("label.back")),o.createElement(u.Z,{"data-testid":"submit-test",htmlType:"submit",type:"primary"},t("label.submit")))))))},pageTitle:t("label.task"),secondPanel:{minWidth:60,flex:.4,children:o.createElement(v.Z,{hideBreadcrumbs:!0,showTags:!0,id:null!==(e=Y.id)&&void 0!==e?e:"",source:(0,a.pi)((0,a.pi)({},Y),{entityType:P})})}})}},25131:function(e,t,n){n.d(t,{Z:function(){return I}});var a=n(70655),i=n(19650),l=n(56256),s=n(34041),r=n(23031),u=n(96486),c=n(67294),d=n(43443),o=n(40773),m=n(37878),p=n(55546),f=n(93379),g=n.n(f),h=n(7795),y=n.n(h),v=n(90569),b=n.n(v),E=n(3565),S=n.n(E),T=n(19216),Z=n.n(T),w=n(44589),N=n.n(w),x=n(71068),C={};C.styleTagTransform=N(),C.setAttributes=S(),C.insert=b().bind(null,"head"),C.domAPI=y(),C.insertStyleElement=Z(),g()(x.Z,C),x.Z&&x.Z.locals&&x.Z.locals;var I=function(e){var t=e.value,n=void 0===t?[]:t,f=e.onSearch,g=e.onChange,h=e.options,y=(0,c.useMemo)((function(){var e=(0,u.groupBy)(h,(function(e){return e.type})),t=[];return(0,u.isUndefined)(e.team)||t.push({type:"group",label:"Teams",value:p.jc.TEAM,options:e.team.map((function(e){return(0,a.pi)((0,a.pi)({},e),{label:c.createElement(i.Z,{"data-testid":"assignee-option",key:e.value},c.createElement(d.ReactComponent,{height:16,width:16}),c.createElement(l.Z.Text,null,e.label))})}))}),(0,u.isUndefined)(e.user)||t.push({type:"group",label:"Users",value:p.jc.USER,options:e.user.map((function(e){return(0,a.pi)((0,a.pi)({},e),{label:c.createElement("div",{"data-testid":"assignee-option-"+e.label},c.createElement(o.w,{className:"assignee-item",id:e.value,name:e.label,size:m.e.small}))})}))}),t}),[h]);return c.createElement(s.Z,{showSearch:!0,className:"ant-select-custom select-assignee","data-testid":"select-assignee",defaultActiveFirstOption:!1,filterOption:!1,mode:"multiple",notFoundContent:null,options:y,placeholder:(0,r.t)("label.select-to-search"),showArrow:!1,value:n.length?n:void 0,onChange:function(e,t){var n=t.map((function(e){return{label:e["data-label"],value:e.value,type:e.type}}));g(n)},onSearch:f})}},39379:function(e,t,n){n.d(t,{_:function(){return c}});var a=n(60331),i=n(94184),l=n.n(i),s=n(23031),r=n(96486),u=n(67294),c=function(e){var t=e.diffArr,n=e.className,i=t.map((function(e){return e.added?u.createElement("div",{className:"d-flex flex-wrap m-y-xs","data-testid":"diff-added",key:(0,r.uniqueId)()},e.value.map((function(e){return u.createElement(a.Z,{key:(0,r.uniqueId)(),style:{background:"rgba(0, 131, 118, 0.2)",color:"#008376"}},e.tagFQN)}))):e.removed?u.createElement("div",{className:"d-flex flex-wrap m-y-xs","data-testid":"diff-removed",key:(0,r.uniqueId)()},e.value.map((function(e){return u.createElement(a.Z,{key:(0,r.uniqueId)(),style:{color:"grey",textDecoration:"line-through"}},e.tagFQN)}))):u.createElement("div",{className:"d-flex flex-wrap m-y-xs","data-testid":"diff-normal",key:(0,r.uniqueId)()},e.value.length?e.value.map((function(e){return u.createElement(a.Z,{key:(0,r.uniqueId)()},e.tagFQN)})):u.createElement("div",{className:"text-grey-muted text-center","data-testid":"noDiff-placeholder"},(0,s.t)("label.no-diff-available")))}));return u.createElement("div",{className:l()("w-full",n),"data-testid":"diff-container"},i)}},40501:function(e,t,n){n.d(t,{X:function(){return m}});var a=n(70655),i=n(25499),l=n(60331),s=n(59295),r=n(96486),u=n(67294),c=n(59923),d=n(39379),o=n(58666),m=function(e){var t=e.tags,n=e.value,m=void 0===n?[]:n,p=e.onChange,f=(0,a.CR)((0,u.useState)([]),2),g=f[0],h=f[1],y=(0,a.CR)((0,u.useState)(c.G.NEW),2),v=y[0],b=y[1];return u.createElement(i.Z,{activeKey:v,size:"small",type:"card",onChange:function(e){b(e),e===c.G.DIFF?h((0,s.Bm)(t,m)):h([])}},u.createElement(i.Z.TabPane,{"data-testid":"current-tab",key:c.G.CURRENT,tab:"Current"},u.createElement("div",{className:"d-flex flex-wrap m-y-xs","data-testid":"tags"},t.map((function(e){return u.createElement(l.Z,{key:(0,r.uniqueId)()},e.tagFQN)})))),u.createElement(i.Z.TabPane,{"data-testid":"diff-tab",key:c.G.DIFF,tab:"Diff"},u.createElement(d._,{diffArr:g})),u.createElement(i.Z.TabPane,{"data-testid":"new-tab",key:c.G.NEW,tab:"New"},u.createElement("div",{className:"m-t-xs"},u.createElement(o.Z,{value:m,onChange:p}))))}}}]);