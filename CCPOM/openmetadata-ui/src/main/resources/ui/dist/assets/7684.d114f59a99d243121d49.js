"use strict";(self.webpackChunkopen_metadata=self.webpackChunkopen_metadata||[]).push([[7684],{85303:function(e,t,n){var i,r;n.d(t,{O:function(){return r},Q:function(){return i}}),function(e){e.Allow="allow",e.Deny="deny"}(i||(i={})),function(e){e.All="All",e.Create="Create",e.Delete="Delete",e.EditAll="EditAll",e.EditCustomFields="EditCustomFields",e.EditDataProfile="EditDataProfile",e.EditDescription="EditDescription",e.EditDisplayName="EditDisplayName",e.EditKnowledgePanel="EditKnowledgePanel",e.EditLifeCycle="EditLifeCycle",e.EditLineage="EditLineage",e.EditOwner="EditOwner",e.EditPage="EditPage",e.EditPolicy="EditPolicy",e.EditQueries="EditQueries",e.EditReviewers="EditReviewers",e.EditRole="EditRole",e.EditSampleData="EditSampleData",e.EditStatus="EditStatus",e.EditTags="EditTags",e.EditTeams="EditTeams",e.EditTests="EditTests",e.EditTier="EditTier",e.EditUsage="EditUsage",e.EditUsers="EditUsers",e.ViewAll="ViewAll",e.ViewBasic="ViewBasic",e.ViewDataProfile="ViewDataProfile",e.ViewQueries="ViewQueries",e.ViewSampleData="ViewSampleData",e.ViewTests="ViewTests",e.ViewUsage="ViewUsage"}(r||(r={}))},87684:function(e,t,n){var i=n(70655),r=n(34041),a=n(49409),l=n(4107),u=n(54680),o=n(49288),s=n(96486),c=n(67294),d=n(68432),f=n(18927),m=n(16139),v=n(85303),p=n(80897),h=n(39570),E=n(40734),b=n(46321),w=r.Z.Option;t.Z=function(e){var t=e.ruleData,n=e.setRuleData,g=(0,d.$)().t,C=(0,i.CR)((0,c.useState)([]),2),y=C[0],Z=C[1],D=(0,i.CR)((0,c.useState)([]),2),S=D[0],V=D[1],R=(0,i.CR)((0,c.useState)([]),2),A=R[0],k=R[1],G=(0,i.CR)((0,c.useState)(""),2),J=G[0],T=G[1],N=(0,i.CR)((0,c.useState)(!1),2),P=N[0],Q=N[1],x=(0,i.CR)((0,c.useState)(!1),2),q=x[0],O=x[1],H=(0,c.useMemo)((function(){return[{title:"All",value:"All",key:"all",children:y.filter((function(e){return!h.mH.includes(e.name||"")})).map((function(e){return{title:(0,s.startCase)(e.name),value:e.name,key:e.name}}))}]}),[y]),I=(0,c.useMemo)((function(){var e=y.filter((function(e){var n;return h.mH.includes(e.name||"")?h.mH.some((function(e){var n;return null===(n=t.resources)||void 0===n?void 0:n.includes(e)})):null===(n=t.resources)||void 0===n?void 0:n.includes(e.name||"")})),n=e.reduce((function(e,t){return(0,s.uniq)((0,i.ev)((0,i.ev)([],(0,i.CR)(e)),(0,i.CR)(t.operations||[])))}),[]).filter((function(e){return e!==v.O.All}));return[{title:"All",value:v.O.All,key:"All",children:n.map((function(e){return{title:e,value:e,key:e}}))}]}),[t.resources,y]),U=function(e){return e.reduce((function(e,t){var n=(t.examples||[]).map((function(e){return{label:e,value:e}}));return(0,s.uniqBy)((0,i.ev)((0,i.ev)([],(0,i.CR)(e)),(0,i.CR)(n)),"value")}),[])};return(0,c.useEffect)((function(){(0,i.mG)(void 0,void 0,void 0,(function(){var e,t;return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,(0,p.cN)()];case 1:return e=n.sent(),Z(e.data||[]),[3,3];case 2:return t=n.sent(),(0,b.Eo)(t),[3,3];case 3:return[2]}}))})),(0,i.mG)(void 0,void 0,void 0,(function(){var e,t;return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,(0,p.QW)()];case 1:return e=n.sent(),V(e.data||[]),[3,3];case 2:return t=n.sent(),(0,b.Eo)(t),[3,3];case 3:return[2]}}))}))}),[]),(0,c.useEffect)((function(){k(U(S))}),[S]),c.createElement(c.Fragment,null,c.createElement(a.Z.Item,{label:g("label.rule-name")+":",name:"ruleName",rules:[{required:!0,max:128,min:1,message:""+g("message.entity-size-in-between",{entity:""+g("label.name"),max:"128",min:"1"})},{pattern:m.$Q,message:g("message.entity-name-validation")}]},c.createElement(l.Z,{"data-testid":"rule-name",placeholder:g("label.rule-name"),type:"text",value:t.name,onChange:function(e){return n((function(t){return(0,i.pi)((0,i.pi)({},t),{name:e.target.value})}))}})),c.createElement(a.Z.Item,{label:g("label.description"),name:"ruleDescription"},c.createElement(f.Z,{height:"200px",initialValue:t.description||"",placeHolder:g("message.write-your-description"),style:{margin:0},onTextChange:function(e){return n((function(t){return(0,i.pi)((0,i.pi)({},t),{description:e})}))}})),c.createElement(a.Z.Item,{label:g("label.resource-plural")+":",name:"resources",rules:[{required:!0,message:g("label.field-required-plural",{field:g("label.resource-plural")})}]},c.createElement(u.Z,{treeCheckable:!0,autoClearSearchValue:!1,className:"w-full","data-testid":"resources",placeholder:g("label.select-field",{field:g("label.resource-plural")}),showCheckedStrategy:u.Z.SHOW_PARENT,treeData:H,onChange:function(e){n((function(t){return(0,i.pi)((0,i.pi)({},t),{resources:e})}))}})),c.createElement(a.Z.Item,{label:g("label.operation-plural")+":",name:"operations",rules:[{required:!0,message:g("label.field-required-plural",{field:g("label.operation-plural")})}]},c.createElement(u.Z,{treeCheckable:!0,autoClearSearchValue:!1,className:"w-full","data-testid":"operations",placeholder:g("label.select-field",{field:g("label.operation-plural")}),showCheckedStrategy:u.Z.SHOW_PARENT,treeData:I,onChange:function(e){n((function(t){return(0,i.pi)((0,i.pi)({},t),{operations:e})}))}})),c.createElement(a.Z.Item,{label:g("label.effect")+":",name:"ruleEffect",rules:[{required:!0,message:g("label.field-required",{field:g("label.effect")})}]},c.createElement(r.Z,{"data-testid":"effect",placeholder:g("label.select-field",{field:g("label.rule-effect")}),value:t.effect,onChange:function(e){return n((function(t){return(0,i.pi)((0,i.pi)({},t),{effect:e})}))}},c.createElement(w,{key:v.Q.Allow},(0,s.capitalize)(v.Q.Allow)),c.createElement(w,{key:v.Q.Deny},(0,s.capitalize)(v.Q.Deny)))),c.createElement(a.Z.Item,{label:g("label.condition")+":",name:"condition"},c.createElement(c.Fragment,null,c.createElement(o.Z,{"data-testid":"condition",options:A,placeholder:"Condition",value:t.condition,onChange:function(e){var t;n((function(t){return(0,i.pi)((0,i.pi)({},t),{condition:e})})),!e&&T(""),t=e,(0,i.mG)(void 0,void 0,void 0,(function(){var e,n,r;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:if(e=g("message.field-text-is-invalid",{fieldText:g("label.condition")}),!t)return[3,5];Q(!0),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,(0,p.dV)(t)];case 2:return n=i.sent(),[200,204].includes(n.status)?(T(""),O(!0)):T(e),[3,5];case 3:return r=i.sent(),T((0,E.HR)(r,e)),O(!1),[3,5];case 4:return Q(!1),[7];case 5:return[2]}}))}))},onSearch:function(e){k(e?function(t){return t.filter((function(t){return t.value.includes(e)}))}:U(S))}}),J&&c.createElement("div",{className:"m-t-xss","data-testid":"condition-error",role:"alert"},"❌ "+g("label.invalid-condition")+" : "+J),P&&c.createElement("div",{className:"m-t-xss",role:"alert"},g("label.validating-condition")),q&&!P&&!J&&c.createElement("div",{className:"m-t-xss","data-testid":"condition-success",role:"alert"},"✅ "+g("label.valid-condition")))))}},80897:function(e,t,n){n.d(t,{$j:function(){return m},F3:function(){return l},Ko:function(){return u},QW:function(){return p},_d:function(){return c},cN:function(){return v},dV:function(){return h},n5:function(){return o},sZ:function(){return f},u$:function(){return d},u7:function(){return s}});var i=n(70655),r=n(2598),a={headers:{"Content-type":"application/json-patch+json"}},l=function(e,t,n,a,l){return void 0===a&&(a=!1),void 0===l&&(l=10),(0,i.mG)(void 0,void 0,void 0,(function(){var u;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return u={default:a,limit:l,fields:e,after:t,before:n},[4,r.Z.get("/roles",{params:u})];case 1:return[2,i.sent().data]}}))}))},u=function(e,t,n,a){return void 0===a&&(a=10),(0,i.mG)(void 0,void 0,void 0,(function(){var l;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return l={limit:a,fields:e,after:t,before:n},[4,r.Z.get("/policies",{params:l})];case 1:return[2,i.sent().data]}}))}))},o=function(e,t){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return[4,r.Z.get("/roles/name/"+e,{params:{fields:t}})];case 1:return[2,n.sent().data]}}))}))},s=function(e,t){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return[4,r.Z.get("/policies/name/"+e,{params:{fields:t}})];case 1:return[2,n.sent().data]}}))}))},c=function(e){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,r.Z.post("/roles",e)];case 1:return[2,t.sent().data]}}))}))},d=function(e){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,r.Z.post("/policies",e)];case 1:return[2,t.sent().data]}}))}))},f=function(e,t){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return[4,r.Z.patch("/roles/"+t,e,a)];case 1:return[2,n.sent().data]}}))}))},m=function(e,t){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return[4,r.Z.patch("/policies/"+t,e,a)];case 1:return[2,n.sent().data]}}))}))},v=function(){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(e){switch(e.label){case 0:return[4,r.Z.get("/policies/resources")];case 1:return[2,e.sent().data]}}))}))},p=function(){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(e){switch(e.label){case 0:return[4,r.Z.get("/policies/functions")];case 1:return[2,e.sent().data]}}))}))},h=function(e){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,r.Z.get("/policies/validation/condition/"+e)];case 1:return[2,t.sent()]}}))}))}}}]);