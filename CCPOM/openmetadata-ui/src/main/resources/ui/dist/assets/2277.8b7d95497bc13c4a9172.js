"use strict";(self.webpackChunkopen_metadata=self.webpackChunkopen_metadata||[]).push([[2277],{71068:function(e,t,n){var a=n(8081),i=n.n(a),s=n(23645),l=n.n(s)()(i());l.push([e.id,'/*\n *  Copyright 2022 Collate.\n *  Licensed under the Apache License, Version 2.0 (the "License");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *  http://www.apache.org/licenses/LICENSE-2.0\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an "AS IS" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n.assignee-tag {\n  display: flex;\n  align-items: center;\n  padding: 2px 3px;\n  margin: 1px 2px;\n}\n.assignee-item .profile-image {\n  vertical-align: middle;\n}\n',""]),t.Z=l},41953:function(e,t,n){var a=n(8081),i=n.n(a),s=n(23645),l=n.n(s)()(i());l.push([e.id,'/*\n *  Copyright 2023 Collate.\n *  Licensed under the Apache License, Version 2.0 (the "License");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *  http://www.apache.org/licenses/LICENSE-2.0\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an "AS IS" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n.request-tags .ant-select-custom,\n.request-description .ant-select-custom {\n  margin: 0;\n}\n.request-description .ant-tabs-description {\n  margin-top: 0;\n}\n.task-data {\n  width: unset;\n}\n',""]),t.Z=l},42105:function(e,t,n){var a=n(93379),i=n.n(a),s=n(7795),l=n.n(s),r=n(90569),u=n.n(r),o=n(3565),c=n.n(o),d=n(19216),m=n.n(d),p=n(44589),g=n.n(p),h=n(41953),f={};f.styleTagTransform=g(),f.setAttributes=c(),f.insert=u().bind(null,"head"),f.domAPI=l(),f.insertStyleElement=m(),i()(h.Z,f),h.Z&&h.Z.locals&&h.Z.locals},62277:function(e,t,n){n.r(t);var a=n(70655),i=n(56256),s=n(49409),l=n(4107),r=n(19650),u=n(71577),o=n(50963),c=n(96486),d=n(67294),m=n(68432),p=n(15137),g=n(98542),h=n(95137),f=n(79686),y=n(26387),b=n(95969),v=n(69523),E=n(58369),T=n(64632),S=n(59583),Z=n(31615),w=n(76373),C=n(93895),x=n(24671),I=n(40734),A=n(86385),L=n(46321),k=n(25131),N=n(58666);n(42105),t.default=function(){var e,t=(0,m.$)().t,n=(0,h.Eu)().currentUser,R=(0,p.TH)(),O=(0,p.k6)(),q=(0,a.CR)((0,o.useForm)(),1)[0],U=(0,p.UO)(),D=U.entityType,F=U.fqn,V=new URLSearchParams(R.search),M=V.get("field"),P=V.get("value"),W=(0,a.CR)((0,d.useState)({}),2),B=W[0],Y=W[1],K=(0,a.CR)((0,d.useState)([]),2),_=K[0],j=K[1],H=(0,a.CR)((0,d.useState)([]),2),z=H[0],X=H[1],G=(0,a.CR)((0,d.useState)([]),1)[0],J=(0,d.useMemo)((function(){return(0,A.wP)({value:P,entityType:D,entityData:B,field:M,startMessage:"Request tags"})}),[P,D,M,B]),$=(0,d.useMemo)((function(){return(0,I.p2)(F)}),[D]),Q=function(){return M&&P?""+M+x.LV+P+x.LV+"tags":E.Sn.TAGS};return(0,d.useEffect)((function(){(0,A.Dy)(D,F,Y)}),[F,D]),(0,d.useEffect)((function(){var e=B.owner,t=[];e&&(t=[{label:(0,x.C_)(e),value:e.id||"",type:e.type}],X(t),j((function(e){return(0,a.ev)((0,a.ev)([],(0,a.CR)(t)),(0,a.CR)(e))}))),q.setFieldsValue({title:J.trimEnd(),assignees:t})}),[B]),(0,c.isEmpty)(B)?d.createElement(v.Z,null):d.createElement(f.Z,{firstPanel:{minWidth:700,flex:.6,children:d.createElement("div",{className:"max-width-md w-9/10 m-x-auto m-y-md d-grid gap-4"},d.createElement(y.Z,{titleLinks:(0,a.ev)((0,a.ev)([],(0,a.CR)((0,A.rM)(B,D))),[{name:t("label.create-entity",{entity:t("label.task")}),activeTitle:!0,url:""}])}),d.createElement("div",{className:"m-t-0 request-tags",key:"request-tags"},d.createElement(i.Z.Paragraph,{className:"text-base","data-testid":"form-title"},t("label.create-entity",{entity:t("label.task")})),d.createElement(s.Z,{form:q,initialValues:{suggestTags:[]},layout:"vertical",onFinish:function(e){var a={from:null==n?void 0:n.name,message:e.title||J,about:(0,x.ec)(D,$,Q()),taskDetails:{assignees:z.map((function(e){return{id:e.value,type:e.type}})),suggestion:JSON.stringify(e.suggestTags),type:S.U.RequestTag,oldValue:"[]"},type:Z.Th.Task};console.log("dataxxdxdxdxdxdxd"),console.log(a),(0,w.Kl)(a).then((function(){(0,L.XA)(t("server.create-entity-success",{entity:t("label.task")})),O.push((0,C.X3)(D,$,T.M8.ACTIVITY_FEED,g.o.TASKS))})).catch((function(e){return(0,L.Eo)(e)}))}},d.createElement(s.Z.Item,{"data-testid":"title",label:t("label.task-entity",{entity:t("label.title")})+":",name:"title"},d.createElement(l.Z,{disabled:!0,placeholder:""+t("label.task-entity",{entity:t("label.title")})})),d.createElement(s.Z.Item,{"data-testid":"assignees",label:t("label.assignee-plural")+":",name:"assignees",rules:[{required:!0,message:t("message.field-text-is-required",{fieldText:t("label.assignee-plural")})}]},d.createElement(k.Z,{options:_,value:z,onChange:X,onSearch:function(e){(0,A.Od)(e,j)}})),d.createElement(s.Z.Item,{"data-testid":"tags-label",label:t("label.suggest-entity",{entity:t("label.tag-plural")})+":",name:"suggestTags"},d.createElement(N.Z,null)),d.createElement(s.Z.Item,null,d.createElement(r.Z,{className:"w-full justify-end","data-testid":"cta-buttons",size:16},d.createElement(u.Z,{type:"link",onClick:function(){return O.goBack()}},t("label.back")),d.createElement(u.Z,{"data-testid":"submit-tag-request",htmlType:"submit",type:"primary"},t(G?"label.suggest":"label.submit")))))))},pageTitle:t("label.task"),secondPanel:{minWidth:60,flex:.4,children:d.createElement(b.Z,{hideBreadcrumbs:!0,showTags:!0,id:null!==(e=B.id)&&void 0!==e?e:"",source:(0,a.pi)((0,a.pi)({},B),{entityType:D})})}})}},25131:function(e,t,n){n.d(t,{Z:function(){return A}});var a=n(70655),i=n(19650),s=n(56256),l=n(34041),r=n(23031),u=n(96486),o=n(67294),c=n(43443),d=n(40773),m=n(37878),p=n(55546),g=n(93379),h=n.n(g),f=n(7795),y=n.n(f),b=n(90569),v=n.n(b),E=n(3565),T=n.n(E),S=n(19216),Z=n.n(S),w=n(44589),C=n.n(w),x=n(71068),I={};I.styleTagTransform=C(),I.setAttributes=T(),I.insert=v().bind(null,"head"),I.domAPI=y(),I.insertStyleElement=Z(),h()(x.Z,I),x.Z&&x.Z.locals&&x.Z.locals;var A=function(e){var t=e.value,n=void 0===t?[]:t,g=e.onSearch,h=e.onChange,f=e.options,y=(0,o.useMemo)((function(){var e=(0,u.groupBy)(f,(function(e){return e.type})),t=[];return(0,u.isUndefined)(e.team)||t.push({type:"group",label:"Teams",value:p.jc.TEAM,options:e.team.map((function(e){return(0,a.pi)((0,a.pi)({},e),{label:o.createElement(i.Z,{"data-testid":"assignee-option",key:e.value},o.createElement(c.ReactComponent,{height:16,width:16}),o.createElement(s.Z.Text,null,e.label))})}))}),(0,u.isUndefined)(e.user)||t.push({type:"group",label:"Users",value:p.jc.USER,options:e.user.map((function(e){return(0,a.pi)((0,a.pi)({},e),{label:o.createElement("div",{"data-testid":"assignee-option-"+e.label},o.createElement(d.w,{className:"assignee-item",id:e.value,name:e.label,size:m.e.small}))})}))}),t}),[f]);return o.createElement(l.Z,{showSearch:!0,className:"ant-select-custom select-assignee","data-testid":"select-assignee",defaultActiveFirstOption:!1,filterOption:!1,mode:"multiple",notFoundContent:null,options:y,placeholder:(0,r.t)("label.select-to-search"),showArrow:!1,value:n.length?n:void 0,onChange:function(e,t){var n=t.map((function(e){return{label:e["data-label"],value:e.value,type:e.type}}));h(n)},onSearch:g})}}}]);